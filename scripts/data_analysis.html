<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content=" Marcelo Araya-Salas, PhD &amp; Gloriana Chaverri, PhD ">
<meta name="dcterms.date" content="2025-03-24">

<title>Statistical analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="data_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="data_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="data_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="data_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="data_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="data_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="data_analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="data_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="data_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="data_analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="data_analysis_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="data_analysis_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="qmd.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#flight-coordination" id="toc-flight-coordination" class="nav-link active" data-scroll-target="#flight-coordination"><span class="header-section-number">1</span> Flight coordination</a>
  <ul>
  <li><a href="#descriptive-stats" id="toc-descriptive-stats" class="nav-link" data-scroll-target="#descriptive-stats"><span class="header-section-number">1.1</span> Descriptive stats</a></li>
  <li><a href="#compute-pairwise-distances-for-natural-and-artificial-groups" id="toc-compute-pairwise-distances-for-natural-and-artificial-groups" class="nav-link" data-scroll-target="#compute-pairwise-distances-for-natural-and-artificial-groups"><span class="header-section-number">1.2</span> Compute pairwise distances for natural and artificial groups</a></li>
  <li><a href="#generate-simulated-group-flight-trajectories" id="toc-generate-simulated-group-flight-trajectories" class="nav-link" data-scroll-target="#generate-simulated-group-flight-trajectories"><span class="header-section-number">1.3</span> Generate simulated group flight trajectories</a></li>
  <li><a href="#describe-data" id="toc-describe-data" class="nav-link" data-scroll-target="#describe-data"><span class="header-section-number">1.4</span> Describe data</a></li>
  <li><a href="#plot-raw-data" id="toc-plot-raw-data" class="nav-link" data-scroll-target="#plot-raw-data"><span class="header-section-number">1.5</span> Plot raw data</a>
  <ul>
  <li><a href="#reduce-dimensionality" id="toc-reduce-dimensionality" class="nav-link" data-scroll-target="#reduce-dimensionality"><span class="header-section-number">1.5.1</span> Reduce dimensionality</a></li>
  </ul></li>
  <li><a href="#generate-simulated-group-flight-trajectories-1" id="toc-generate-simulated-group-flight-trajectories-1" class="nav-link" data-scroll-target="#generate-simulated-group-flight-trajectories-1"><span class="header-section-number">1.6</span> Generate simulated group flight trajectories</a>
  <ul>
  <li><a href="#raw-distances" id="toc-raw-distances" class="nav-link" data-scroll-target="#raw-distances"><span class="header-section-number">1.6.1</span> Raw distances</a></li>
  </ul></li>
  <li><a href="#regression-model" id="toc-regression-model" class="nav-link" data-scroll-target="#regression-model"><span class="header-section-number">1.7</span> Regression model</a>
  <ul>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">1.7.1</span> Results</a>
  <ul class="collapse">
  <li><a href="#model-performance-vs-null-model" id="toc-model-performance-vs-null-model" class="nav-link" data-scroll-target="#model-performance-vs-null-model"><span class="header-section-number">1.7.1.1</span> Model performance vs null model</a></li>
  <li><a href="#model-fit" id="toc-model-fit" class="nav-link" data-scroll-target="#model-fit"><span class="header-section-number">1.7.1.2</span> Model fit</a></li>
  <li><a href="#contrasts" id="toc-contrasts" class="nav-link" data-scroll-target="#contrasts"><span class="header-section-number">1.7.1.3</span> Contrasts</a></li>
  <li><a href="#posterior-predictive-checks" id="toc-posterior-predictive-checks" class="nav-link" data-scroll-target="#posterior-predictive-checks"><span class="header-section-number">1.7.1.4</span> Posterior predictive checks</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#roost-entry-coordination" id="toc-roost-entry-coordination" class="nav-link" data-scroll-target="#roost-entry-coordination"><span class="header-section-number">2</span> Roost entry coordination</a>
  <ul>
  <li><a href="#data-description" id="toc-data-description" class="nav-link" data-scroll-target="#data-description"><span class="header-section-number">2.1</span> Data description</a></li>
  <li><a href="#estimating-roost-entry-time-lapse" id="toc-estimating-roost-entry-time-lapse" class="nav-link" data-scroll-target="#estimating-roost-entry-time-lapse"><span class="header-section-number">2.2</span> Estimating roost entry time lapse</a></li>
  <li><a href="#simulating-entry-time-lapse-data" id="toc-simulating-entry-time-lapse-data" class="nav-link" data-scroll-target="#simulating-entry-time-lapse-data"><span class="header-section-number">2.3</span> Simulating entry time lapse data</a></li>
  <li><a href="#plot-raw-data-1" id="toc-plot-raw-data-1" class="nav-link" data-scroll-target="#plot-raw-data-1"><span class="header-section-number">2.4</span> Plot raw data</a></li>
  <li><a href="#regression-model-1" id="toc-regression-model-1" class="nav-link" data-scroll-target="#regression-model-1"><span class="header-section-number">2.5</span> Regression model</a>
  <ul>
  <li><a href="#results-1" id="toc-results-1" class="nav-link" data-scroll-target="#results-1"><span class="header-section-number">2.5.1</span> Results</a>
  <ul class="collapse">
  <li><a href="#model-performance-vs-null-model-1" id="toc-model-performance-vs-null-model-1" class="nav-link" data-scroll-target="#model-performance-vs-null-model-1"><span class="header-section-number">2.5.1.1</span> Model performance vs null model</a></li>
  <li><a href="#model-fit-1" id="toc-model-fit-1" class="nav-link" data-scroll-target="#model-fit-1"><span class="header-section-number">2.5.1.2</span> Model fit</a></li>
  <li><a href="#contrasts-1" id="toc-contrasts-1" class="nav-link" data-scroll-target="#contrasts-1"><span class="header-section-number">2.5.1.3</span> Contrasts</a></li>
  <li><a href="#posterior-predictive-checks-1" id="toc-posterior-predictive-checks-1" class="nav-link" data-scroll-target="#posterior-predictive-checks-1"><span class="header-section-number">2.5.1.4</span> Posterior predictive checks</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#calling-behavior" id="toc-calling-behavior" class="nav-link" data-scroll-target="#calling-behavior"><span class="header-section-number">3</span> Calling behavior</a>
  <ul>
  <li><a href="#read-data" id="toc-read-data" class="nav-link" data-scroll-target="#read-data"><span class="header-section-number">3.1</span> Read data</a></li>
  <li><a href="#call-rate" id="toc-call-rate" class="nav-link" data-scroll-target="#call-rate"><span class="header-section-number">3.2</span> Call rate</a>
  <ul>
  <li><a href="#individual-in-solo-flight-vs-overall-group-flight" id="toc-individual-in-solo-flight-vs-overall-group-flight" class="nav-link" data-scroll-target="#individual-in-solo-flight-vs-overall-group-flight"><span class="header-section-number">3.2.1</span> Individual in solo flight vs overall group flight</a>
  <ul class="collapse">
  <li><a href="#plot-raw-data-2" id="toc-plot-raw-data-2" class="nav-link" data-scroll-target="#plot-raw-data-2"><span class="header-section-number">3.2.1.1</span> Plot raw data</a></li>
  <li><a href="#regression-model-2" id="toc-regression-model-2" class="nav-link" data-scroll-target="#regression-model-2"><span class="header-section-number">3.2.1.2</span> Regression model</a></li>
  <li><a href="#results-2" id="toc-results-2" class="nav-link" data-scroll-target="#results-2"><span class="header-section-number">3.2.1.3</span> Results</a>
  <ul class="collapse">
  <li><a href="#model-performance-vs-null-model-2" id="toc-model-performance-vs-null-model-2" class="nav-link" data-scroll-target="#model-performance-vs-null-model-2"><span class="header-section-number">3.2.1.3.1</span> Model performance vs null model</a></li>
  <li><a href="#model-fit-2" id="toc-model-fit-2" class="nav-link" data-scroll-target="#model-fit-2"><span class="header-section-number">3.2.1.3.2</span> Model fit</a></li>
  <li><a href="#contrasts-2" id="toc-contrasts-2" class="nav-link" data-scroll-target="#contrasts-2"><span class="header-section-number">3.2.1.3.3</span> Contrasts</a></li>
  <li><a href="#posterior-predictive-checks-2" id="toc-posterior-predictive-checks-2" class="nav-link" data-scroll-target="#posterior-predictive-checks-2"><span class="header-section-number">3.2.1.3.4</span> Posterior predictive checks</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#individual-in-solo-flight-vs-individuals-in-group-flight" id="toc-individual-in-solo-flight-vs-individuals-in-group-flight" class="nav-link" data-scroll-target="#individual-in-solo-flight-vs-individuals-in-group-flight"><span class="header-section-number">3.2.2</span> Individual in solo flight vs individuals in group flight</a>
  <ul class="collapse">
  <li><a href="#plot-raw-data-3" id="toc-plot-raw-data-3" class="nav-link" data-scroll-target="#plot-raw-data-3"><span class="header-section-number">3.2.2.1</span> Plot raw data</a></li>
  <li><a href="#regression-model-3" id="toc-regression-model-3" class="nav-link" data-scroll-target="#regression-model-3"><span class="header-section-number">3.2.2.2</span> Regression model</a>
  <ul class="collapse">
  <li><a href="#results-3" id="toc-results-3" class="nav-link" data-scroll-target="#results-3"><span class="header-section-number">3.2.2.2.1</span> Results</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#individual-consistency-in-call-rate-across-flight-types" id="toc-individual-consistency-in-call-rate-across-flight-types" class="nav-link" data-scroll-target="#individual-consistency-in-call-rate-across-flight-types"><span class="header-section-number">3.2.3</span> Individual consistency in call rate across flight types</a>
  <ul class="collapse">
  <li><a href="#plot-raw-data-4" id="toc-plot-raw-data-4" class="nav-link" data-scroll-target="#plot-raw-data-4"><span class="header-section-number">3.2.3.1</span> Plot raw data</a></li>
  <li><a href="#regression-model-4" id="toc-regression-model-4" class="nav-link" data-scroll-target="#regression-model-4"><span class="header-section-number">3.2.3.2</span> Regression model</a>
  <ul class="collapse">
  <li><a href="#results-4" id="toc-results-4" class="nav-link" data-scroll-target="#results-4"><span class="header-section-number">3.2.3.2.1</span> Results</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#simulated-group-calling" id="toc-simulated-group-calling" class="nav-link" data-scroll-target="#simulated-group-calling"><span class="header-section-number">3.3</span> Simulated group calling</a>
  <ul>
  <li><a href="#results-5" id="toc-results-5" class="nav-link" data-scroll-target="#results-5"><span class="header-section-number">3.3.1</span> Results</a>
  <ul class="collapse">
  <li><a href="#model-performance-vs-null-model-5" id="toc-model-performance-vs-null-model-5" class="nav-link" data-scroll-target="#model-performance-vs-null-model-5"><span class="header-section-number">3.3.1.1</span> Model performance vs null model</a></li>
  <li><a href="#model-fit-5" id="toc-model-fit-5" class="nav-link" data-scroll-target="#model-fit-5"><span class="header-section-number">3.3.1.2</span> Model fit</a></li>
  <li><a href="#contrasts-4" id="toc-contrasts-4" class="nav-link" data-scroll-target="#contrasts-4"><span class="header-section-number">3.3.1.3</span> Contrasts</a></li>
  <li><a href="#posterior-predictive-checks-5" id="toc-posterior-predictive-checks-5" class="nav-link" data-scroll-target="#posterior-predictive-checks-5"><span class="header-section-number">3.3.1.4</span> Posterior predictive checks</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#gap-duration" id="toc-gap-duration" class="nav-link" data-scroll-target="#gap-duration"><span class="header-section-number">3.4</span> Gap duration</a>
  <ul>
  <li><a href="#gap-variation-of-individual-in-solo-flight-vs-overall-group-flight" id="toc-gap-variation-of-individual-in-solo-flight-vs-overall-group-flight" class="nav-link" data-scroll-target="#gap-variation-of-individual-in-solo-flight-vs-overall-group-flight"><span class="header-section-number">3.4.1</span> Gap variation of individual in solo flight vs overall group flight</a>
  <ul class="collapse">
  <li><a href="#plot-raw-data-5" id="toc-plot-raw-data-5" class="nav-link" data-scroll-target="#plot-raw-data-5"><span class="header-section-number">3.4.1.1</span> Plot raw data</a></li>
  <li><a href="#regression-model-5" id="toc-regression-model-5" class="nav-link" data-scroll-target="#regression-model-5"><span class="header-section-number">3.4.1.2</span> Regression model</a>
  <ul class="collapse">
  <li><a href="#results-6" id="toc-results-6" class="nav-link" data-scroll-target="#results-6"><span class="header-section-number">3.4.1.2.1</span> Results</a></li>
  <li><a href="#contrasts-5" id="toc-contrasts-5" class="nav-link" data-scroll-target="#contrasts-5"><span class="header-section-number">3.4.1.2.2</span> Contrasts</a></li>
  <li><a href="#posterior-predictive-checks-6" id="toc-posterior-predictive-checks-6" class="nav-link" data-scroll-target="#posterior-predictive-checks-6"><span class="header-section-number">3.4.1.2.3</span> Posterior predictive checks</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#individual-in-solo-flight-vs-individuals-in-group-flight-1" id="toc-individual-in-solo-flight-vs-individuals-in-group-flight-1" class="nav-link" data-scroll-target="#individual-in-solo-flight-vs-individuals-in-group-flight-1"><span class="header-section-number">3.4.2</span> Individual in solo flight vs individuals in group flight</a>
  <ul class="collapse">
  <li><a href="#plot-raw-data-6" id="toc-plot-raw-data-6" class="nav-link" data-scroll-target="#plot-raw-data-6"><span class="header-section-number">3.4.2.1</span> Plot raw data</a></li>
  <li><a href="#regression-model-6" id="toc-regression-model-6" class="nav-link" data-scroll-target="#regression-model-6"><span class="header-section-number">3.4.2.2</span> Regression model</a>
  <ul class="collapse">
  <li><a href="#results-7" id="toc-results-7" class="nav-link" data-scroll-target="#results-7"><span class="header-section-number">3.4.2.2.1</span> Results</a></li>
  <li><a href="#model-performance-vs-null-model-7" id="toc-model-performance-vs-null-model-7" class="nav-link" data-scroll-target="#model-performance-vs-null-model-7"><span class="header-section-number">3.4.2.2.2</span> Model performance vs null model</a></li>
  <li><a href="#model-fit-7" id="toc-model-fit-7" class="nav-link" data-scroll-target="#model-fit-7"><span class="header-section-number">3.4.2.2.3</span> Model fit</a></li>
  <li><a href="#contrasts-6" id="toc-contrasts-6" class="nav-link" data-scroll-target="#contrasts-6"><span class="header-section-number">3.4.2.2.4</span> Contrasts</a></li>
  <li><a href="#posterior-predictive-checks-7" id="toc-posterior-predictive-checks-7" class="nav-link" data-scroll-target="#posterior-predictive-checks-7"><span class="header-section-number">3.4.2.2.5</span> Posterior predictive checks</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#group-calling-sequence-predictability" id="toc-group-calling-sequence-predictability" class="nav-link" data-scroll-target="#group-calling-sequence-predictability"><span class="header-section-number">3.5</span> Group calling sequence predictability</a>
  <ul>
  <li><a href="#plot-raw-data-7" id="toc-plot-raw-data-7" class="nav-link" data-scroll-target="#plot-raw-data-7"><span class="header-section-number">3.5.1</span> Plot raw data</a></li>
  <li><a href="#regression-model-7" id="toc-regression-model-7" class="nav-link" data-scroll-target="#regression-model-7"><span class="header-section-number">3.5.2</span> Regression model</a>
  <ul class="collapse">
  <li><a href="#results-8" id="toc-results-8" class="nav-link" data-scroll-target="#results-8"><span class="header-section-number">3.5.2.1</span> Results</a>
  <ul class="collapse">
  <li><a href="#model-performance-vs-null-model-8" id="toc-model-performance-vs-null-model-8" class="nav-link" data-scroll-target="#model-performance-vs-null-model-8"><span class="header-section-number">3.5.2.1.1</span> Model performance vs null model</a></li>
  <li><a href="#model-fit-8" id="toc-model-fit-8" class="nav-link" data-scroll-target="#model-fit-8"><span class="header-section-number">3.5.2.1.2</span> Model fit</a></li>
  <li><a href="#posterior-predictive-checks-8" id="toc-posterior-predictive-checks-8" class="nav-link" data-scroll-target="#posterior-predictive-checks-8"><span class="header-section-number">3.5.2.1.3</span> Posterior predictive checks</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  <li><a href="#number-of-calling-individuals-per-experiment" id="toc-number-of-calling-individuals-per-experiment" class="nav-link" data-scroll-target="#number-of-calling-individuals-per-experiment"><span class="header-section-number">3.6</span> Number of calling individuals per experiment</a>
  <ul>
  <li><a href="#plot-raw-data-8" id="toc-plot-raw-data-8" class="nav-link" data-scroll-target="#plot-raw-data-8"><span class="header-section-number">3.6.1</span> Plot raw data</a></li>
  <li><a href="#regression-model-8" id="toc-regression-model-8" class="nav-link" data-scroll-target="#regression-model-8"><span class="header-section-number">3.6.2</span> Regression model</a>
  <ul class="collapse">
  <li><a href="#results-9" id="toc-results-9" class="nav-link" data-scroll-target="#results-9"><span class="header-section-number">3.6.2.1</span> Results</a>
  <ul class="collapse">
  <li><a href="#model-performance-vs-null-model-9" id="toc-model-performance-vs-null-model-9" class="nav-link" data-scroll-target="#model-performance-vs-null-model-9"><span class="header-section-number">3.6.2.1.1</span> Model performance vs null model</a></li>
  <li><a href="#model-fit-9" id="toc-model-fit-9" class="nav-link" data-scroll-target="#model-fit-9"><span class="header-section-number">3.6.2.1.2</span> Model fit</a></li>
  <li><a href="#posterior-predictive-checks-9" id="toc-posterior-predictive-checks-9" class="nav-link" data-scroll-target="#posterior-predictive-checks-9"><span class="header-section-number">3.6.2.1.3</span> Posterior predictive checks</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Statistical analysis</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Behavioral coordination in Spixâ€™s disk-winged bats</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p></p><center><br>
<font size="4"><a href="https://marce10.github.io/">Marcelo Araya-Salas, PhD</a> &amp; <a href="https://www.batcr.com/">Gloriana Chaverri, PhD</a></font><br>
</center> <p></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 24, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Source code and data found at <a href="https://github.com/maRce10/flight_coordination_in_Thyroptera">https://github.com/maRce10/flight_coordination_in_Thyroptera</a></p>
<section id="to-do" class="level1 unnumbered unlisted alert alert-warning">
<h1 class="unnumbered unlisted">To do</h1>
<ul>
<li>Make sure all estimates are using median and MAP</li>
<li>Can we back-transform response variables to use intuitive units in the results???</li>
<li>Make sure all models run for the same number of iterations and number of chains</li>
</ul>
</section>
<!-- skyblue box -->
<section id="purpose" class="level1 unnumbered unlisted alert alert-info">
<h1 class="unnumbered unlisted">Purpose</h1>
<ul>
<li>Generate simulated data</li>
<li>Run statistical analyses</li>
</ul>
</section>
<section id="load-packages-and-configure-global-settings" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="load-packages-and-configure-global-settings">Load packages and configure global settings</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr is require for creating html/pdf/word reports formatR is</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># used for soft-wrapping code</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install/ load packages</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>sketchy<span class="sc">::</span><span class="fu">load_packages</span>(<span class="at">packages =</span> <span class="fu">c</span>(<span class="st">"viridis"</span>, <span class="st">"ggplot2"</span>, <span class="st">"knitr"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"readxl"</span>, <span class="st">"pbapply"</span>, <span class="st">"brms"</span>, <span class="st">"kableExtra"</span>, <span class="st">"ggridges"</span>, <span class="st">"tidybayes"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"brmsish"</span>, <span class="st">"bayestestR"</span>, <span class="st">"cowplot"</span>, <span class="at">bioconductor =</span> <span class="st">"multtest"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"metap"</span>, <span class="st">"ggsignif"</span>, <span class="st">"extrafont"</span>))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/Dropbox/R_package_testing/brmsish/R/helpers.R"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/Dropbox/R_package_testing/brmsish/R/draw_extended_summary.R"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"~/Dropbox/R_package_testing/brmsish/R/extended_summary.R"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">fig.width =</span> <span class="dv">12</span>, <span class="at">fig.height =</span> <span class="dv">8</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">24</span>))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>fill_color <span class="ot">&lt;-</span> viridis<span class="sc">::</span><span class="fu">mako</span>(<span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)[<span class="dv">7</span>]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>graph_cols <span class="ot">&lt;-</span> <span class="fu">mako</span>(<span class="dv">4</span>, <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end =</span> <span class="fl">0.8</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>graph_cols_transp <span class="ot">&lt;-</span> <span class="fu">mako</span>(<span class="dv">4</span>, <span class="at">begin =</span> <span class="dv">0</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(graph_cols_transp) <span class="ot">&lt;-</span> <span class="fu">names</span>(graph_cols) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"solo"</span>, <span class="st">"natural"</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artificial"</span>, <span class="st">"simulated"</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">brms.backend =</span> <span class="st">"cmdstanr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="custom-functions" class="level2 unnumbered unlisted">
<h2 class="unnumbered unlisted anchored" data-anchor-id="custom-functions">Custom functions</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient of variation</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cv <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">mean</span>(x) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to measure the euclidean distance in 3D space between bats in a group flight trajectory</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>pairwise_dist <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># keep only 3D coordinates data</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  xyz <span class="ot">&lt;-</span> X[, <span class="fu">grep</span>(<span class="st">"^x|^y|^z"</span>, <span class="fu">names</span>(X))]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove empty columns</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  xyz <span class="ot">&lt;-</span> xyz[, <span class="fu">sapply</span>(xyz, <span class="cf">function</span>(x)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">is.na</span>(x))) <span class="sc">&lt;</span> <span class="dv">10</span>]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set to long format</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  lng_xyz  <span class="ot">&lt;-</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">stack</span>(xyz[, <span class="fu">grep</span>(<span class="st">"^x"</span>, <span class="fu">names</span>(xyz))])[, <span class="dv">1</span>],</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="fu">stack</span>(xyz[, <span class="fu">grep</span>(<span class="st">"^y"</span>, <span class="fu">names</span>(xyz))])[, <span class="dv">1</span>],</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">z =</span> <span class="fu">stack</span>(xyz[, <span class="fu">grep</span>(<span class="st">"^z"</span>, <span class="fu">names</span>(xyz))]))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(lng_xyz)[<span class="fu">names</span>(lng_xyz) <span class="sc">==</span>  <span class="st">"z.values"</span>] <span class="ot">&lt;-</span> <span class="st">"z"</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  lng_xyz<span class="sc">$</span>ind <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"z_"</span>, <span class="st">""</span>, lng_xyz<span class="sc">$</span>z.ind)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  lng_xyz<span class="sc">$</span>z.ind <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lng_xyz$frame &lt;- X$frame</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  lng_xyz<span class="sc">$</span>frame <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mean distance among all bats</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  obs_dists <span class="ot">&lt;-</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(<span class="fu">unique</span>(lng_xyz<span class="sc">$</span>frame), <span class="cf">function</span>(x)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(<span class="fu">dist</span>(lng_xyz[lng_xyz<span class="sc">$</span>frame <span class="sc">==</span> x, <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>)])))</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> X<span class="sc">$</span>group[<span class="dv">1</span>],</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">group.size =</span> <span class="fu">length</span>(<span class="fu">unique</span>(lng_xyz<span class="sc">$</span>ind)),</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">distance =</span> obs_dists,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> X<span class="sc">$</span>type[<span class="dv">1</span>],</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">frame =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add group size as factor</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>group.size.factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(out<span class="sc">$</span>group.size, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="co"># function to create simulated data getting one individual trajectory from diferent groups for a total of individual equals to group_sizes[x]</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>sim_group_traj <span class="ot">&lt;-</span> <span class="cf">function</span>(group_sizes, seed, <span class="at">trajectories =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  trajs <span class="ot">&lt;-</span> indiv_traj_list</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># randomize so each iteration is a different</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  trajs <span class="ot">&lt;-</span> <span class="fu">sample</span>(trajs)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  dists_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  group_num <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  used_trajs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (e <span class="cf">in</span> <span class="fu">seq_along</span>(group_sizes)) {</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    i <span class="ot">&lt;-</span> group_sizes[e]</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    sample_traj_indx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="sc">!</span><span class="fu">duplicated</span>(<span class="fu">names</span>(trajs)))[<span class="dv">1</span><span class="sc">:</span>i]</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(group_num <span class="sc">+</span> seed)</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    sample_trajs <span class="ot">&lt;-</span> trajs[sample_traj_indx]</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="co"># force all to have the same number of frames</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>    min_frames <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">sapply</span>(sample_trajs, nrow))</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>    sample_trajs <span class="ot">&lt;-</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lapply</span>(sample_trajs, <span class="cf">function</span>(x)</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>        x[<span class="dv">1</span><span class="sc">:</span>min_frames, ])</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>    sample_traj_df <span class="ot">&lt;-</span> <span class="fu">do_call</span>(cbind, sample_trajs)</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(sample_traj_df) <span class="ot">&lt;-</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>), <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>i, <span class="dv">3</span>), <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>    sample_traj_df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"sim"</span>, group_num, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    sample_traj_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"simulated"</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    dist_df <span class="ot">&lt;-</span> <span class="fu">pairwise_dist</span>(sample_traj_df)</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    dist_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"simulated"</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add to output list</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>    dists_list[[<span class="fu">length</span>(dists_list) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> dist_df</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove sampled trajectories from trajs based on indices so idnviduals are only used once</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>    trajs <span class="ot">&lt;-</span> trajs[<span class="sc">-</span>sample_traj_indx]</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>    group_num <span class="ot">&lt;-</span> group_num <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(sample_trajs) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"sim"</span>, e, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_trajs), <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>    used_trajs <span class="ot">&lt;-</span> <span class="fu">c</span>(used_trajs, sample_trajs)</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>  dists_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, dists_list)</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>trajectories)</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(dists_df) <span class="cf">else</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(used_trajs)</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a><span class="co"># function to simulate group calling from solo calling vectors</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>sim_group_call <span class="ot">&lt;-</span> <span class="cf">function</span>(group_sizes, seed) {</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>  indv_calls <span class="ot">&lt;-</span> <span class="fu">split</span>(time_calls_indiv, <span class="fu">list</span>(time_calls_indiv<span class="sc">$</span>year.audio))</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>  <span class="co"># randomize so each iteration is a different</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>  indv_calls <span class="ot">&lt;-</span> <span class="fu">sample</span>(indv_calls)</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dists_list &lt;- list()</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group_num &lt;- 1</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># used_calls &lt;- list()</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>  sim_call_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(group_sizes), <span class="cf">function</span>(i) {</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>    e <span class="ot">&lt;-</span> group_sizes[i]</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># set.seed(e + seed)</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>    sampled_calls <span class="ot">&lt;-</span> indv_calls[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(indv_calls), e)]</span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>    clms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"start"</span>, <span class="st">"end"</span>, <span class="st">"indiv"</span>, <span class="st">"year.audio"</span>)</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>    sampled_calls <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sampled_calls, <span class="cf">function</span>(x) x[, clms])</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>    sample_calls_df <span class="ot">&lt;-</span> <span class="fu">do_call</span>(rbind, sampled_calls)</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>    sample_calls_df<span class="sc">$</span>sound.files <span class="ot">&lt;-</span> <span class="fu">paste</span>(i, e, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    sample_calls_df<span class="sc">$</span>year.audio</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>    sample_calls_df<span class="sc">$</span>group.size <span class="ot">&lt;-</span> e</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(sample_calls_df)</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>  sim_call_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, sim_call_list)</span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(sim_call_df)</span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate contrasts based on a brms draws object</span></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate contrasts based on posterior draws and plot the posterior distributions</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>draws_contrasts <span class="ot">&lt;-</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(draws,</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>           predictor_name,</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>           basal_level,</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill_color =</span> <span class="st">"blue"</span>,</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>           <span class="at">beta.prefix =</span> <span class="st">"^b_"</span>) {</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the model coefficients</span></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>    coef_names <span class="ot">&lt;-</span> <span class="fu">colnames</span>(draws)</span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>    intercept_name <span class="ot">&lt;-</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grep</span>(<span class="st">"^b_Intercept$"</span>, coef_names, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>    group_names <span class="ot">&lt;-</span></span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grep</span>(<span class="fu">paste0</span>(beta.prefix, predictor_name), coef_names, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine the levels of the categorical predictor</span></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>    levels <span class="ot">&lt;-</span></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>      <span class="fu">c</span>(basal_level, <span class="fu">sub</span>(<span class="fu">paste0</span>(beta.prefix, predictor_name), <span class="st">""</span>, group_names))</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate EMMs for each level</span></span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>    group_values <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>    group_values[[<span class="dv">1</span>]] <span class="ot">&lt;-</span> draws[[intercept_name]]</span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(group_names)) {</span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>      group_values[[i <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>        draws[[intercept_name]] <span class="sc">+</span> draws[[group_names[i]]]</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute pairwise contrasts</span></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>    contrast_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>    contrast_names <span class="ot">&lt;-</span></span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>      <span class="fu">combn</span>(levels, <span class="dv">2</span>, <span class="cf">function</span>(x)</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste</span>(x[<span class="dv">2</span>], <span class="st">"-"</span>, x[<span class="dv">1</span>]))</span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(contrast_names)) {</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>      contrast_list[[i]] <span class="ot">&lt;-</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>        group_values[[<span class="fu">which</span>(levels <span class="sc">==</span> <span class="fu">strsplit</span>(contrast_names[i], <span class="st">" - "</span>)[[<span class="dv">1</span>]][<span class="dv">2</span>])]] <span class="sc">-</span></span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>        group_values[[<span class="fu">which</span>(levels <span class="sc">==</span> <span class="fu">strsplit</span>(contrast_names[i], <span class="st">" - "</span>)[[<span class="dv">1</span>]][<span class="dv">1</span>])]]</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(contrast_list) <span class="ot">&lt;-</span> contrast_names</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Function to summarize contrasts</span></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>    summarize_contrast <span class="ot">&lt;-</span> <span class="cf">function</span>(contrast) {</span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>      mean_contrast <span class="ot">&lt;-</span> <span class="fu">mean</span>(contrast)</span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>      lower_contrast <span class="ot">&lt;-</span> <span class="fu">quantile</span>(contrast, <span class="fl">0.025</span>)</span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>      upper_contrast <span class="ot">&lt;-</span> <span class="fu">quantile</span>(contrast, <span class="fl">0.975</span>)</span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">c</span>(</span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a>        <span class="at">mean =</span> mean_contrast,</span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> lower_contrast,</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> upper_contrast</span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Summarize each contrast</span></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>    summary_contrasts <span class="ot">&lt;-</span></span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sapply</span>(contrast_list, summarize_contrast, <span class="at">simplify =</span> <span class="st">"array"</span>)</span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert summary to a data frame for plotting</span></span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>    contrast_summary_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>      <span class="at">Contrast =</span> <span class="fu">rep</span>(<span class="fu">names</span>(contrast_list), <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>      <span class="at">Statistic =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"Lower"</span>, <span class="st">"Upper"</span>), <span class="at">times =</span> <span class="fu">length</span>(contrast_list)),</span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>      <span class="at">Value =</span> <span class="fu">as.vector</span>(summary_contrasts)</span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>    <span class="co"># flip summary</span></span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>    summary_contrasts <span class="ot">&lt;-</span> <span class="fu">t</span>(summary_contrasts)</span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(summary_contrasts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"est"</span>, <span class="st">"l-95% CI"</span>, <span class="st">"u-95% CI"</span>)</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>    summary_contrasts <span class="ot">&lt;-</span> <span class="fu">html_format_coef_table</span>(<span class="fu">as.data.frame</span>(summary_contrasts), <span class="at">fill =</span> fill_color,  <span class="at">highlight =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the posterior distributions of contrasts</span></span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>    contrast_df <span class="ot">&lt;-</span></span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>      <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="fu">names</span>(contrast_list), <span class="cf">function</span>(name) {</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="at">Contrast =</span> name, <span class="at">Value =</span> contrast_list[[name]])</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>      }))</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(contrast_df, <span class="fu">aes</span>(<span class="at">x =</span> Value)) <span class="sc">+</span></span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> fill_color,</span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> fill_color) <span class="sc">+</span></span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span> Contrast, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_blank</span>()</span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">plot =</span> p,</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>                    <span class="at">contrasts =</span> summary_contrasts)</span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(results)</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a><span class="co"># to create several posterior predictive check plots out of a brms fit</span></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>custom_ppc <span class="ot">&lt;-</span> <span class="cf">function</span>(fit, <span class="at">group =</span> <span class="cn">NULL</span>, <span class="at">ndraws =</span> <span class="dv">30</span>) {</span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>  by_group  <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(group)){</span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> </span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span></span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>    <span class="cn">FALSE</span></span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (by_group)</span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>    by_group  <span class="ot">&lt;-</span>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">names</span>(fit<span class="sc">$</span>data) <span class="sc">==</span> group)){</span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span></span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>    <span class="cn">FALSE</span></span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (by_group)</span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a>    by_group <span class="ot">&lt;-</span></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">is.character</span>(fit<span class="sc">$</span>data[, group]) <span class="sc">|</span></span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a>          <span class="fu">is.factor</span>(fit<span class="sc">$</span>data[, group])){</span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span></span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span></span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>    <span class="cn">FALSE</span></span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (by_group) {</span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>    ppc_dens <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(fit,</span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ndraws =</span> ndraws,</span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">'dens_overlay_grouped'</span>,</span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a>                         <span class="at">group =</span> group)</span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>    pp_mean <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(</span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>      fit,</span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"stat_grouped"</span>,</span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a>      <span class="at">stat =</span> <span class="st">"mean"</span>,</span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> group,</span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>      <span class="at">ndraws =</span> ndraws</span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a>    )  <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a>    pp_scat <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(fit,</span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">"scatter_avg"</span>,</span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># group = group,</span></span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ndraws =</span> ndraws)</span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a>    ppc_dens <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(fit,</span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ndraws =</span> ndraws,</span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">'dens_overlay'</span>)</span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>    pp_mean <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(fit,</span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">"stat"</span>,</span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>                        <span class="at">stat =</span> <span class="st">"mean"</span>,</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ndraws =</span> ndraws) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>    pp_scat <span class="ot">&lt;-</span>  <span class="fu">pp_check</span>(fit,</span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">"scatter_avg"</span>,</span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ndraws =</span> ndraws)</span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a>  pp_stat2 <span class="ot">&lt;-</span> <span class="fu">pp_check</span>(fit, <span class="at">type =</span> <span class="st">"stat_2d"</span>, <span class="at">ndraws =</span> ndraws)</span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>  pp_plot_list <span class="ot">&lt;-</span></span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(ppc_dens, pp_mean, pp_scat,  pp_stat2)</span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a>  pp_plot_list[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)] <span class="ot">&lt;-</span></span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lapply</span>(pp_plot_list[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)], <span class="cf">function</span>(x)</span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a>      x  <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>(</span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a>        <span class="at">begin =</span> <span class="fl">0.3</span>,</span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>        <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a>        <span class="at">option =</span> <span class="st">"mako"</span>,</span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>(</span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a>        <span class="at">begin =</span> <span class="fl">0.3</span>,</span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a>        <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>        <span class="at">option =</span> <span class="st">"mako"</span></span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span> <span class="fu">theme_classic</span>())</span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a>  ppc_plot <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="at">plotlist =</span> pp_plot_list, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(ppc_plot)</span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a><span class="do">## caller sequence features</span></span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate entropy</span></span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a>entropy <span class="ot">&lt;-</span> <span class="cf">function</span>(sequence) {</span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a>  freq <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">strsplit</span>(sequence, <span class="cn">NULL</span>)[[<span class="dv">1</span>]])  <span class="co"># Frequency of each letter</span></span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> freq <span class="sc">/</span> <span class="fu">sum</span>(freq)  <span class="co"># Probability of each letter</span></span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a>  entropy_value <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sum</span>(prob <span class="sc">*</span> <span class="fu">log2</span>(prob))  <span class="co"># Shannon entropy</span></span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(entropy_value)</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate normalized entropy</span></span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a>normalized_entropy <span class="ot">&lt;-</span> <span class="cf">function</span>(sequence) {</span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a>  H <span class="ot">&lt;-</span> <span class="fu">entropy</span>(sequence)</span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a>  unique_elements <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(<span class="fu">strsplit</span>(sequence, <span class="cn">NULL</span>)[[<span class="dv">1</span>]]))</span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a>  max_entropy <span class="ot">&lt;-</span> <span class="fu">log2</span>(unique_elements)</span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a>  H_norm <span class="ot">&lt;-</span> H <span class="sc">/</span> max_entropy</span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(H_norm)</span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate entropy of a probability distribution</span></span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a>entropy2 <span class="ot">&lt;-</span> <span class="cf">function</span>(probs) {</span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a>  non_zero_probs <span class="ot">&lt;-</span> probs[probs <span class="sc">&gt;</span> <span class="dv">0</span>]  <span class="co"># Ignore zero probabilities</span></span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a>  H <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">sum</span>(non_zero_probs <span class="sc">*</span> <span class="fu">log2</span>(non_zero_probs))</span>
<span id="cb2-341"><a href="#cb2-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(H)</span>
<span id="cb2-342"><a href="#cb2-342" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-343"><a href="#cb2-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-344"><a href="#cb2-344" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create a Markov model and calculate average entropy</span></span>
<span id="cb2-345"><a href="#cb2-345" aria-hidden="true" tabindex="-1"></a>markov_entropy <span class="ot">&lt;-</span> <span class="cf">function</span>(sequence, <span class="at">normalize =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-346"><a href="#cb2-346" aria-hidden="true" tabindex="-1"></a>  states <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(sequence, <span class="cn">NULL</span>)[[<span class="dv">1</span>]]</span>
<span id="cb2-347"><a href="#cb2-347" aria-hidden="true" tabindex="-1"></a>  transitions <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">head</span>(states, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">tail</span>(states, <span class="sc">-</span><span class="dv">1</span>))  <span class="co"># Transition counts</span></span>
<span id="cb2-348"><a href="#cb2-348" aria-hidden="true" tabindex="-1"></a>  transition_probs <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(transitions, <span class="dv">1</span>)  <span class="co"># Row-wise probabilities</span></span>
<span id="cb2-349"><a href="#cb2-349" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-350"><a href="#cb2-350" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate entropy for each row (state) in the transition matrix</span></span>
<span id="cb2-351"><a href="#cb2-351" aria-hidden="true" tabindex="-1"></a>  state_entropies <span class="ot">&lt;-</span> <span class="fu">apply</span>(transition_probs, <span class="dv">1</span>, entropy2)</span>
<span id="cb2-352"><a href="#cb2-352" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-353"><a href="#cb2-353" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Average entropy across all states</span></span>
<span id="cb2-354"><a href="#cb2-354" aria-hidden="true" tabindex="-1"></a>  avg_entropy <span class="ot">&lt;-</span> <span class="fu">mean</span>(state_entropies, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-355"><a href="#cb2-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-356"><a href="#cb2-356" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (normalize) avg_entropy <span class="ot">&lt;-</span> avg_entropy <span class="sc">/</span> <span class="fu">log2</span>(<span class="fu">length</span>(<span class="fu">unique</span>(states)))</span>
<span id="cb2-357"><a href="#cb2-357" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-358"><a href="#cb2-358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(avg_entropy)</span>
<span id="cb2-359"><a href="#cb2-359" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="flight-coordination" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Flight coordination</h1>
<section id="descriptive-stats" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="descriptive-stats"><span class="header-section-number">1.1</span> Descriptive stats</h2>
<p>Read data:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>group_traj <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/raw/flight_trajectories_by_group.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Number of trails: 34</p>
<p>Group sizes:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get number of individuals per group</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n_per_group <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">unique</span>(group_traj<span class="sc">$</span>group), <span class="at">USE.NAMES =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) {</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get those for that group</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        X <span class="ot">&lt;-</span> group_traj[group_traj<span class="sc">$</span>group <span class="sc">==</span> x, ]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># count number of individuals (No NAs)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        n_indiv <span class="ot">&lt;-</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">sapply</span>(X, anyNA)) <span class="sc">-</span> <span class="dv">3</span>)<span class="sc">/</span><span class="dv">3</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(n_indiv)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(n_per_group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>n_per_group
2 3 4 5 6 
7 8 7 8 4 </code></pre>
</div>
</div>
</section>
<section id="compute-pairwise-distances-for-natural-and-artificial-groups" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="compute-pairwise-distances-for-natural-and-artificial-groups"><span class="header-section-number">1.2</span> Compute pairwise distances for natural and artificial groups</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pairwise_dists_list <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">split</span>(group_traj, group_traj<span class="sc">$</span>group),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    pairwise_dist, <span class="at">simplify =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>pairwise_dists <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, pairwise_dists_list)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># remove those with unlikely distance</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>pairwise_dists <span class="ot">&lt;-</span> pairwise_dists[pairwise_dists<span class="sc">$</span>distance <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> pairwise_dists<span class="sc">$</span>distance <span class="sc">&lt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="generate-simulated-group-flight-trajectories" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="generate-simulated-group-flight-trajectories"><span class="header-section-number">1.3</span> Generate simulated group flight trajectories</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## split into single individual trajectories split in a list</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>split_group_traj <span class="ot">&lt;-</span> <span class="fu">split</span>(group_traj, group_traj<span class="sc">$</span>group)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get single individual trajectores</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>indiv_traj_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_group_traj, <span class="cf">function</span>(x) {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[, <span class="fu">sapply</span>(x, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x))) <span class="sc">&lt;</span> <span class="dv">10</span>]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get number of individuals</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">suppressWarnings</span>(indv_num <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">na.omit</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">".*?([0-9]+).*"</span>,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, <span class="fu">names</span>(x))))))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    indiv_trajs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(indv_num, <span class="cf">function</span>(y) x[, <span class="fu">grep</span>(y, <span class="fu">names</span>(x))])</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(indiv_trajs)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>indiv_traj_list <span class="ot">&lt;-</span> <span class="fu">unlist</span>(indiv_traj_list, <span class="at">recursive =</span> <span class="cn">FALSE</span>, <span class="at">use.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co"># remove last character of the list names so all have the</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># original group name</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(indiv_traj_list) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">".$"</span>, <span class="st">""</span>, <span class="fu">names</span>(indiv_traj_list))</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># mean number of individuals per group size in original data</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>mean_n_indiv <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">mean</span>(<span class="fu">table</span>(n_per_group)))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>group_sizes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">names</span>(<span class="fu">table</span>(n_per_group)))</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>group_sizes <span class="ot">&lt;-</span> <span class="fu">rep</span>(group_sizes, <span class="at">each =</span> mean_n_indiv)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>sim_dists <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="cf">function</span>(x) <span class="fu">sim_group_traj</span>(group_sizes,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> x))</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>sim_trajs_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="cf">function</span>(x) <span class="fu">sim_group_traj</span>(group_sizes,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> x, <span class="at">trajectories =</span> <span class="cn">TRUE</span>))</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co"># remove those with unlikely distance</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>sim_dists <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sim_dists, <span class="cf">function</span>(x) {</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[x<span class="sc">$</span>distance <span class="sc">&gt;</span> <span class="fl">0.1</span> <span class="sc">&amp;</span> x<span class="sc">$</span>distance <span class="sc">&lt;</span> <span class="fl">7.81</span>, ]</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="describe-data" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="describe-data"><span class="header-section-number">1.4</span> Describe data</h2>
<p>Mean distance between individuals in a group flight:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sim_dists_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, sim_dists)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mean distance by group type</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, sim_dists_df, mean)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, sim_dists_df, sd)<span class="sc">$</span>distance</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># mean distance by group type</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>agg2 <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, pairwise_dists, mean)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>agg2<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, pairwise_dists, sd)<span class="sc">$</span>distance</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(agg, agg2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simulated</td>
<td style="text-align: right;">2.050082</td>
<td style="text-align: right;">0.5696759</td>
</tr>
<tr class="even">
<td style="text-align: left;">artificial</td>
<td style="text-align: right;">2.005765</td>
<td style="text-align: right;">0.6803455</td>
</tr>
<tr class="odd">
<td style="text-align: left;">natural</td>
<td style="text-align: right;">1.670052</td>
<td style="text-align: right;">0.7256127</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Closest distance between individuals in a group flight:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sim_dists_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, sim_dists)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mean distance by group type</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>agg_min <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type <span class="sc">+</span> group, sim_dists_df, min)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, agg_min, mean)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, agg_min, sd)<span class="sc">$</span>distance</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># mean distance by group type</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>agg_min2 <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type <span class="sc">+</span> group, pairwise_dists, min)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>agg2 <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, agg_min2, mean)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>agg2<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, agg_min2, sd)<span class="sc">$</span>distance</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(agg, agg2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: right;">distance</th>
<th style="text-align: right;">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">simulated</td>
<td style="text-align: right;">0.6592624</td>
<td style="text-align: right;">0.3312211</td>
</tr>
<tr class="even">
<td style="text-align: left;">artificial</td>
<td style="text-align: right;">0.9213170</td>
<td style="text-align: right;">0.5873041</td>
</tr>
<tr class="odd">
<td style="text-align: left;">natural</td>
<td style="text-align: right;">0.7190676</td>
<td style="text-align: right;">0.3595199</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="plot-raw-data" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="plot-raw-data"><span class="header-section-number">1.5</span> Plot raw data</h2>
<section id="reduce-dimensionality" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="reduce-dimensionality"><span class="header-section-number">1.5.1</span> Reduce dimensionality</h3>
</section>
</section>
<section id="generate-simulated-group-flight-trajectories-1" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="generate-simulated-group-flight-trajectories-1"><span class="header-section-number">1.6</span> Generate simulated group flight trajectories</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">## split into single individual trajectories</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># split in a list</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>split_group_traj <span class="ot">&lt;-</span> <span class="fu">split</span>(group_traj, group_traj<span class="sc">$</span>group)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pca fun</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>fun1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">prcomp</span>(x, <span class="at">center =</span> <span class="cn">FALSE</span>, <span class="at">scale. =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>x[,<span class="dv">1</span>]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># horizontal plane fun</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fun1 &lt;- function(x) x[,3]</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>indiv_traj_pc1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(indiv_traj_list, fun1)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>pca_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(<span class="fu">names</span>(indiv_traj_pc1)), <span class="cf">function</span>(x){</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  pca_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(indiv_traj_pc1[<span class="fu">names</span>(indiv_traj_pc1) <span class="sc">==</span> x])</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(pca_df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ind"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(pca_df))</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  stacked_pca_df <span class="ot">&lt;-</span> <span class="fu">stack</span>(pca_df)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  stacked_pca_df<span class="sc">$</span>frame <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pca_df)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  stacked_pca_df<span class="sc">$</span>group <span class="ot">&lt;-</span> x </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  stacked_pca_df<span class="sc">$</span>group.size <span class="ot">&lt;-</span> <span class="fu">ncol</span>(pca_df)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(stacked_pca_df)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>pca_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, pca_list)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co"># for simulated data</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>sim_traj_pc1 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sim_trajs_list[[<span class="dv">1</span>]], <span class="cf">function</span>(x) x[,<span class="dv">3</span>])</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="co"># pca_sim_list &lt;- lapply(unique, function(x){</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>pca_sim_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">paste</span>(<span class="st">"sim"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="st">""</span>, <span class="at">sep =</span> <span class="st">"-"</span>), <span class="cf">function</span>(x){</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  pca_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sim_traj_pc1[<span class="fu">grep</span>(<span class="at">pattern =</span> x, <span class="fu">names</span>(sim_traj_pc1))])</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(pca_df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ind"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(pca_df))</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>  stacked_pca_df <span class="ot">&lt;-</span> <span class="fu">stack</span>(pca_df)</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  stacked_pca_df<span class="sc">$</span>frame <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(pca_df)</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  stacked_pca_df<span class="sc">$</span>group <span class="ot">&lt;-</span> x </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>  stacked_pca_df<span class="sc">$</span>group.size <span class="ot">&lt;-</span> <span class="fu">ncol</span>(pca_df)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(stacked_pca_df)</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>pca_sim_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, pca_sim_list)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>pca_sim_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"simulated"</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>pca_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">sapply</span>(pca_df<span class="sc">$</span>group, <span class="cf">function</span>(x) pairwise_dists<span class="sc">$</span>type[group_traj<span class="sc">$</span>group <span class="sc">==</span> x][<span class="dv">1</span>])</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co">#bind</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>pca_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pca_df, pca_sim_df)</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co"># order groups by type</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>pca_df<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(pca_df<span class="sc">$</span>group, <span class="at">levels =</span> <span class="fu">unique</span>(pca_df<span class="sc">$</span>group[<span class="fu">order</span>(pca_df<span class="sc">$</span>type)]))</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>pca_df <span class="ot">&lt;-</span> pca_df[<span class="fu">complete.cases</span>(pca_df), ]</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>pca_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(pca_df<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"natural"</span>, <span class="st">"artificial"</span>, <span class="st">"simulated"</span>))</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a><span class="co"># table(pca_df$type, pca_df$group.size)</span></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="co">#get 3 names of group for each type level</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>selected_groups <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(pca_df<span class="sc">$</span>type), <span class="cf">function</span>(x) {</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(pca_df<span class="sc">$</span>group[pca_df<span class="sc">$</span>type <span class="sc">==</span> x <span class="sc">&amp;</span> pca_df<span class="sc">$</span>group.size <span class="sc">==</span> <span class="dv">4</span>])[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>pca_df <span class="ot">&lt;-</span> pca_df[pca_df<span class="sc">$</span>frame <span class="sc">&lt;</span> <span class="dv">26</span>, ]</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pca_df[pca_df<span class="sc">$</span>group <span class="sc">%in%</span> <span class="fu">unlist</span>(selected_groups), ], <span class="fu">aes</span>(<span class="at">x =</span> frame, <span class="at">y =</span> values, <span class="at">group =</span> ind, <span class="at">color =</span> type)) <span class="sc">+</span> </span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point() + </span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">span =</span> <span class="fl">0.3</span>) <span class="sc">+</span> </span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme(legend.position = "none") + </span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Frame"</span>, <span class="at">y =</span> <span class="st">"Horizontal plane</span><span class="sc">\n</span><span class="st">position (m)"</span>) <span class="sc">+</span></span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ylim(c = c(-3, 3)) +</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>( <span class="at">dir =</span> <span class="st">"v"</span>,</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>        type<span class="sc">~</span> group, <span class="co">#scales = "free_y",</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<section id="raw-distances" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="raw-distances"><span class="header-section-number">1.6.1</span> Raw distances</h3>
<p>All group sizes combined:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add original data to simulated data and calculate proximity</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>nat_sim_dist_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sim_dists, <span class="cf">function</span>(x) {</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbind</span>(x, pairwise_dists))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># remove distances above 10 m</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>nat_sim_dist_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(nat_sim_dist_list, <span class="cf">function</span>(x) {</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[x<span class="sc">$</span>distance <span class="sc">&lt;</span> <span class="dv">10</span>, ]</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span>type <span class="ot">&lt;-</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">factor</span>(x<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"natural"</span>, <span class="st">"artificial"</span>, <span class="st">"simulated"</span>))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>dat_all <span class="ot">&lt;-</span> dat <span class="ot">&lt;-</span> nat_sim_dist_list[[<span class="dv">1</span>]]</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>dat_all<span class="sc">$</span>group.size <span class="ot">&lt;-</span> <span class="st">"All sizes"</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dat, dat_all)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>group.size.factor <span class="ot">&lt;-</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(dat<span class="sc">$</span>group.size, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="st">"All sizes"</span>))</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>n_grps <span class="ot">&lt;-</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(group <span class="sc">~</span> group.size.factor <span class="sc">+</span> type, dat, <span class="cf">function</span>(x)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>frames <span class="ot">&lt;-</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(group <span class="sc">~</span> group.size.factor <span class="sc">+</span> type, dat, <span class="cf">function</span>(x)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(x))<span class="sc">$</span>group</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>indivs <span class="ot">&lt;-</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  n_grps<span class="sc">$</span>group <span class="sc">*</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(n_grps<span class="sc">$</span>group.size.factor))</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>group.size.factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(n_grps<span class="sc">$</span>group.size.factor)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>distance <span class="ot">&lt;-</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ifelse</span>(n_grps<span class="sc">$</span>group.size.factor <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>,<span class="sc">-</span><span class="fl">1.2</span>,<span class="sc">-</span><span class="fl">0.9</span>)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>distance[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.8</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>indivs[n_grps<span class="sc">$</span>group.size.factor <span class="sc">==</span> <span class="st">"All sizes"</span>] <span class="ot">&lt;-</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(indivs <span class="sc">~</span> type, n_grps, sum)<span class="sc">$</span>indivs</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>n.labels <span class="ot">&lt;-</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(n_grps<span class="sc">$</span>group, <span class="st">" / "</span>, n_grps<span class="sc">$</span>indivs, <span class="st">" / "</span>, n_grps<span class="sc">$</span>frames)</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>n.labels[<span class="dv">1</span>] <span class="ot">&lt;-</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>  <span class="st">" n = 3 groups /</span><span class="sc">\n</span><span class="st"> 6 individuals /</span><span class="sc">\n</span><span class="st"> 149 frames"</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>n.labels[<span class="dv">6</span>] <span class="ot">&lt;-</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>  <span class="st">" n = 18 groups /</span><span class="sc">\n</span><span class="st"> 74 individuals /</span><span class="sc">\n</span><span class="st"> 888 frames"</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>distance[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.3</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>distance[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">17</span>)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.4</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span> <span class="fu">unique</span>(nat_sim_dist_list[[<span class="dv">1</span>]]<span class="sc">$</span>group.size)</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"Group size = "</span>, <span class="fu">rep</span>(<span class="st">""</span>, <span class="dv">5</span>)), custom_labels)</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(custom_labels) <span class="ot">&lt;-</span> <span class="fu">unique</span>(nat_sim_dist_list[[<span class="dv">1</span>]]<span class="sc">$</span>group.size)</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span> <span class="fu">unique</span>(dat<span class="sc">$</span>group.size)</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"Group size = "</span>, <span class="fu">rep</span>(<span class="st">""</span>, <span class="dv">5</span>)), custom_labels)</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(custom_labels) <span class="ot">&lt;-</span> <span class="fu">unique</span>(dat<span class="sc">$</span>group.size)</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a><span class="co"># mean distance by group type</span></span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>agg_gp <span class="ot">&lt;-</span></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(distance <span class="sc">~</span> type <span class="sc">+</span> group <span class="sc">+</span> group.size.factor, dat, mean)</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>agg_gp<span class="sc">$</span>group.size.factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(agg_gp<span class="sc">$</span>group.size.factor)</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>gg_all <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat[dat<span class="sc">$</span>group.size <span class="sc">==</span> <span class="st">"All sizes"</span>, ],</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> distance,</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> type,</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>                   <span class="at">color =</span> type,</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> type</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>                 )) <span class="sc">+</span></span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_position =</span> <span class="fu">c</span>(<span class="fl">4.35</span>, <span class="fl">4.75</span>),</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation =</span> <span class="fu">c</span>(<span class="st">'beta:0.32~ (0.19 - 0.45)'</span>, <span class="st">'beta:0.36~ (0.24 - 0.47)'</span>), </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">tip_length =</span> <span class="fl">0.02</span>,</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">textsize =</span> <span class="dv">3</span>,</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.2</span></span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">adjustcolor</span>(<span class="st">"orange"</span>, <span class="at">alpha.f =</span> <span class="fl">0.1</span>),</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_gp[<span class="sc">!</span>agg_gp<span class="sc">$</span>group.size <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,],</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> type),</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">adjustcolor</span>(<span class="st">"orange"</span>, <span class="at">alpha.f =</span> <span class="fl">0.6</span>),</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">1</span>,</span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># color = fill_color,</span></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># draw jitter on the left</span></span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>    <span class="co"># control range of jitter</span></span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add some transparency</span></span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_viridis_d(option = "G",</span></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                      end = 0.8,</span></span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                      alpha = 0.6) +</span></span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> graph_cols[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> graph_cols_transp[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_gp[agg_gp<span class="sc">$</span>group.size <span class="sc">!=</span> <span class="st">"All sizes"</span>, ],</span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> type),</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"orange"</span>,</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a>    <span class="co"># draw jitter on the left</span></span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>    <span class="co"># control range of jitter</span></span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add some transparency</span></span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">4.8</span>)) <span class="sc">+</span></span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a>    <span class="st">"natural"</span> <span class="ot">=</span> <span class="st">"Natural"</span>,</span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artificial"</span> <span class="ot">=</span> <span class="st">"Artificial"</span>,</span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a>    <span class="st">"simulated"</span> <span class="ot">=</span> <span class="st">"Simulated"</span></span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Distance (m)"</span>) <span class="sc">+</span></span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> group.size,</span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group.size =</span> <span class="fu">c</span>(<span class="st">"All sizes"</span> <span class="ot">=</span> <span class="st">"All group sizes"</span>))) <span class="sc">+</span></span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">lineheight =</span> <span class="fl">0.8</span>,</span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> n_grps[<span class="sc">!</span>n_grps<span class="sc">$</span>group.size.factor <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>, ],</span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> type, <span class="at">label =</span> n.labels),</span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="dv">0</span>,</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a><span class="co"># add significance</span></span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a>gg_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>gg_gs <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dat[dat<span class="sc">$</span>group.size <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>,],</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> distance,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> type,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> type,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill =</span> type</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                )) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.6</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># color = fill_color,</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># draw jitter on the left</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># control range of jitter</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add some transparency</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">3</span>,</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_viridis_d(option = "G",</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                      end = 0.8,</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                      alpha = 0.6) +</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> graph_cols[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> graph_cols_transp[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_gp[agg_gp<span class="sc">$</span>group.size <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, ],</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> type),</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"orange"</span>,</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># draw jitter on the left</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># control range of jitter</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add some transparency</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>     <span class="at">fill =</span> <span class="fu">adjustcolor</span>(<span class="st">"orange"</span>, <span class="at">alpha.f =</span> <span class="fl">0.1</span>),</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_gp[agg_gp<span class="sc">$</span>group.size <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, ],</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> type),</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">adjustcolor</span>(<span class="st">"orange"</span>, <span class="at">alpha.f =</span> <span class="fl">0.6</span>),</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">1</span>,</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">4.8</span>)) <span class="sc">+</span></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">"natural"</span> <span class="ot">=</span> <span class="st">"Natural"</span>,</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artificial"</span> <span class="ot">=</span> <span class="st">"Artificial"</span>,</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">"simulated"</span> <span class="ot">=</span> <span class="st">"Simulated"</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> group.size.factor,</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group.size.factor =</span> custom_labels)</span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Pairwise flight distance (m)"</span>) <span class="sc">+</span></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">lineheight =</span> <span class="fl">0.8</span>,</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> n_grps[n_grps<span class="sc">$</span>group.size.factor <span class="sc">%in%</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, ],</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> type, <span class="at">label =</span> n.labels),</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="dv">0</span>,</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.3</span></span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a><span class="co"># gg_gs</span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_grid</span>(</span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>    gg_gs <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>    gg_all <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>),</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a common x-axis label</span></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>(pg) <span class="sc">+</span></span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">draw_label</span>(</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Group type"</span>,</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">0.51</span>,</span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fl">0.02</span>,</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="dv">0</span>,</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">15</span></span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>hedFont <span class="ot">&lt;-</span> <span class="st">"Arial"</span></span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> pg <span class="sc">+</span> </span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">family =</span> hedFont, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>                                           </span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>pg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"./output/flight_coordination_5_panels.png"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  pg,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  grDevices<span class="sc">::</span>png,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">9</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">4</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="regression-model" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="regression-model"><span class="header-section-number">1.7</span> Regression model</h2>
<ul>
<li><p>Add the group roost entry data to each simulated set and run a bayesian mixed effects model coordination on roost entry for each data set</p></li>
<li><p>The mean pairwise spatial distance between individuals at each frame was used as the response variable, while group type (natural, artificial or simulated) was used as predictor</p></li>
<li><p>Group ID and group size were included as varying effects.</p></li>
<li><p>The posterior distributions from the 30 models were combined into a single model fit for statistical inference</p></li>
</ul>
<p>Model:</p>
<p><span class="math display">\[
\text{mean pairwise distance} \sim \text{type} + \text{monotonic(group size)} + (1 \mid \text{group}) + \text{arma(frame)}
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mods_flight_coord <span class="ot">&lt;-</span> <span class="fu">brm_multiple</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> distance <span class="sc">~</span> type <span class="sc">+</span> <span class="fu">mo</span>(group.size.factor) <span class="sc">+</span> <span class="fu">ar</span>(<span class="at">p =</span> <span class="dv">2</span>, <span class="at">time =</span> frame, <span class="at">gr =</span> group),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> iter,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> nat_sim_dist_list,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> chains,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># only works if cmdstanr package is installed</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> chains,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">combine =</span> <span class="cn">FALSE</span>,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mods_flight_coord[[<span class="dv">1</span>]], <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>mods_flight_coord <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(mods_flight_coord,  <span class="cf">function</span>(x) <span class="fu">add_criterion</span>(x, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>)))</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(mods_flight_coord,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"./data/processed/model_list_flight_coordination_monotonic.RDS"</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>null_mods_flight_coord <span class="ot">&lt;-</span> <span class="fu">brm_multiple</span>(</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> distance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">ar</span>(<span class="at">p =</span> <span class="dv">2</span>, <span class="at">time =</span> frame, <span class="at">gr =</span> group),</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> iter,</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> nat_sim_dist_list,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> chains,</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># only works if cmdstanr package is installed</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> chains,</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">combine =</span> <span class="cn">FALSE</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>null_mods_flight_coord <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(null_mods_flight_coord,  <span class="cf">function</span>(x) <span class="fu">add_criterion</span>(x, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>)))</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(null_mods_flight_coord,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        <span class="st">"./data/processed/nullmodel_list_flight_coordination_monotonic.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="results"><span class="header-section-number">1.7.1</span> Results</h3>
<section id="model-performance-vs-null-model" class="level4" data-number="1.7.1.1">
<h4 data-number="1.7.1.1" class="anchored" data-anchor-id="model-performance-vs-null-model"><span class="header-section-number">1.7.1.1</span> Model performance vs null model</h4>
<p>Mean ELPD and associated standard deviation between each model and its correspondent null model:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mods_flight_coord <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/model_list_flight_coordination_monotonic.RDS"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>null_mods_flight_coord <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/nullmodel_list_flight_coordination_monotonic.RDS"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>loo_diffs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(mods_flight_coord), <span class="cf">function</span>(x) loo<span class="sc">::</span><span class="fu">loo_compare</span>(mods_flight_coord[[x]],</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    null_mods_flight_coord[[x]]))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>loo_diff <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, loo_diffs)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loo_diff)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>loo_diff <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(loo_diff)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>loo_diff<span class="sc">$</span>model <span class="ot">&lt;-</span> rows</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">cbind</span>(elpd_diff, se_diff) <span class="sc">~</span> model, loo_diff, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">elpd_diff</th>
<th style="text-align: right;">se_diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mods_flight_coord[[x]]</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">null_mods_flight_coord[[x]]</td>
<td style="text-align: right;">-21.90503</td>
<td style="text-align: right;">7.252173</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="model-fit" class="level4" data-number="1.7.1.2">
<h4 data-number="1.7.1.2" class="anchored" data-anchor-id="model-fit"><span class="header-section-number">1.7.1.2</span> Model fit</h4>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># average model</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>avrg_call <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"posterior_average("</span>, <span class="fu">paste0</span>(<span class="fu">paste0</span>(<span class="st">"mods_flight_coord[["</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mods_flight_coord), <span class="st">"]]"</span>), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">", weights = 'loo')"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>average_model_draws <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> avrg_call))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_extended_summary</span>(average_model_draws, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> fill_color,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta.prefix =</span> <span class="fu">c</span>(<span class="st">"^b_"</span>, <span class="st">"^bsp_mo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
<th style="text-align:left;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_Intercept
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.543
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.422
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.658
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
13408.43
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
12889.18
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_typeartificial
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.324
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.190
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.457
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
18885.33
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
14627.23
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_typesimulated
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.355
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.244
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.465
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
19059.53
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
14710.03
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
bsp_mogroup.size.factor
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.066
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.033
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.102
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
13809.64
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
14422.19
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/regression%20results%20flight%20coordination-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="contrasts" class="level4" data-number="1.7.1.3">
<h4 data-number="1.7.1.3" class="anchored" data-anchor-id="contrasts"><span class="header-section-number">1.7.1.3</span> Contrasts</h4>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>contrasts <span class="ot">&lt;-</span> <span class="fu">draws_contrasts</span>(<span class="at">draws =</span> average_model_draws, <span class="at">predictor_name =</span> <span class="st">"type"</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">basal_level =</span> <span class="st">"natural"</span>, <span class="at">fill_color =</span> fill_color)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>contrasts<span class="sc">$</span>contrasts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">est</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">l-95% CI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">u-95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; background-color: rgba(56, 170, 172, 38) !important;">artificial - natural</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.324</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.457</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.190</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(56, 170, 172, 38) !important;">simulated - natural</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.355</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.465</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.244</td>
</tr>
<tr class="odd">
<td style="text-align: left;">simulated - artificial</td>
<td style="text-align: right;">-0.031</td>
<td style="text-align: right;">-0.162</td>
<td style="text-align: right;">0.098</td>
</tr>
</tbody>
</table>
</div>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>contrasts<span class="sc">$</span>plot <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p><img src="data_analysis_files/figure-html/regresion%20contrasts%20flight%20coordination-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="posterior-predictive-checks" class="level4" data-number="1.7.1.4">
<h4 data-number="1.7.1.4" class="anchored" data-anchor-id="posterior-predictive-checks"><span class="header-section-number">1.7.1.4</span> Posterior predictive checks</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="fu">readRDS</span>(<span class="st">"./data/processed/model_list_flight_coordination.RDS"</span>)[[<span class="dv">1</span>]],</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="st">"type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="takeaways" class="level4 unnumbered unlisted alert alert-info">
<h4 class="unnumbered unlisted anchored" data-anchor-id="takeaways">Takeaways</h4>
<ul>
<li>Flight coordination is higher in natural groups than in artificial and simulated groups</li>
<li>Flight coordination is similar in artificial and simulated groups</li>
<li>Flight distance between individuals increases with group size</li>
</ul>
</section>
</section>
</section>
</section>
<section id="roost-entry-coordination" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Roost entry coordination</h1>
<section id="data-description" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="data-description"><span class="header-section-number">2.1</span> Data description</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">"./data/raw/Anexo 1_Entrada a refugios-2022.xlsx"</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>entry.time <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dat<span class="sc">$</span><span class="st">`</span><span class="at">Tiempo real</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove missing data</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[<span class="sc">!</span><span class="fu">is.na</span>(dat<span class="sc">$</span>entry.time), ]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rename treatment levels</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>type <span class="ot">&lt;-</span> dat<span class="sc">$</span><span class="st">`</span><span class="at">Tipo grupo</span><span class="st">`</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>type[dat<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"Real"</span>] <span class="ot">&lt;-</span> <span class="st">"Natural"</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>type[dat<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"Mixto"</span>] <span class="ot">&lt;-</span> <span class="st">"Artificial"</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>group <span class="ot">&lt;-</span> dat<span class="sc">$</span>Grupo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Number of individuals per type:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Artificial Individual    Natural 
        94         34        124 </code></pre>
</div>
</div>
<p>Number of individuals per type removing missing data (NAs and Inf):</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">table</span>(dat<span class="sc">$</span>type[<span class="sc">!</span><span class="fu">is.infinite</span>(dat<span class="sc">$</span>entry.time) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dat<span class="sc">$</span>entry.time)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Artificial Individual    Natural 
        65         17         95 </code></pre>
</div>
</div>
<p>Individuals per experiment:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ind_per_video <span class="ot">&lt;-</span> <span class="fu">table</span>(dat<span class="sc">$</span>Video[dat<span class="sc">$</span>type <span class="sc">!=</span> <span class="st">"Individual"</span>])</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(ind_per_video)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ind_per_video
 2  3  4  5  6  7 
 8 16 14 17  1  1 </code></pre>
</div>
</div>
</section>
<section id="estimating-roost-entry-time-lapse" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="estimating-roost-entry-time-lapse"><span class="header-section-number">2.2</span> Estimating roost entry time lapse</h2>
<p>Calculate time lapse between the first individual to enter the roost for each group:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>group_dat <span class="ot">&lt;-</span> dat[<span class="sc">!</span><span class="fu">is.infinite</span>(dat<span class="sc">$</span>entry.time) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dat<span class="sc">$</span>entry.time) <span class="sc">&amp;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    dat<span class="sc">$</span>type <span class="sc">!=</span> <span class="st">"Individual"</span>, ]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get time difference between entries</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>group_dat_l <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(group_dat<span class="sc">$</span>group), <span class="cf">function</span>(x) {</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(x)</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> group_dat[group_dat<span class="sc">$</span>group <span class="sc">==</span> x, ]</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X[<span class="sc">!</span><span class="fu">is.na</span>(X<span class="sc">$</span>entry.time), ]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X[<span class="fu">order</span>(X<span class="sc">$</span>entry.time), ]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># X$entry.time.diff &lt;- X$entry.time - min(X$entry.time)</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    X<span class="sc">$</span>entry.time.diff <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, X<span class="sc">$</span>entry.time[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> X<span class="sc">$</span>entry.time[<span class="sc">-</span><span class="fu">nrow</span>(X)])</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X[<span class="sc">!</span><span class="fu">is.na</span>(X<span class="sc">$</span>entry.time.diff), ]</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add 1 milisecond to 0</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    X<span class="sc">$</span>entry.time.diff[X<span class="sc">$</span>entry.time.diff <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    X<span class="sc">$</span>group.size <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">nrow</span>(X) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(X) <span class="sc">-</span> <span class="dv">1</span> <span class="cf">else</span> <span class="fu">vector</span>()</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(X)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>group_dat <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, group_dat_l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulating-entry-time-lapse-data" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="simulating-entry-time-lapse-data"><span class="header-section-number">2.3</span> Simulating entry time lapse data</h2>
<p>Simulated 30 data sets, each one with a number of simulated groups for each group size (2 to 5 individuals) similar to those in the natural group data. This approach allowed us to propagate uncertainty from random group simulations into our statistical inference.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>group_dat <span class="ot">&lt;-</span> dat[<span class="sc">!</span><span class="fu">is.infinite</span>(dat<span class="sc">$</span>entry.time) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dat<span class="sc">$</span>entry.time) <span class="sc">&amp;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    dat<span class="sc">$</span>type <span class="sc">!=</span> <span class="st">"Individual"</span>, ]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get difference to first entry</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>group_dat_l <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(group_dat<span class="sc">$</span>group), <span class="cf">function</span>(x) {</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(x)</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> group_dat[group_dat<span class="sc">$</span>group <span class="sc">==</span> x, ]</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X[<span class="sc">!</span><span class="fu">is.na</span>(X<span class="sc">$</span>entry.time), ]</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X[<span class="fu">order</span>(X<span class="sc">$</span>entry.time), ]</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># X$entry.time.diff &lt;- X$entry.time - min(X$entry.time)</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    X<span class="sc">$</span>entry.time.diff <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, X<span class="sc">$</span>entry.time[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> X<span class="sc">$</span>entry.time[<span class="sc">-</span><span class="fu">nrow</span>(X)])</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> X[<span class="sc">!</span><span class="fu">is.na</span>(X<span class="sc">$</span>entry.time.diff), ]</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    X<span class="sc">$</span>group.size <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">nrow</span>(X) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(X) <span class="sc">+</span> <span class="dv">1</span> <span class="cf">else</span> <span class="fu">vector</span>()</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(X)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>group_dat <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, group_dat_l)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>group_dat<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(group_dat<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Artificial"</span>,</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Natural"</span>, <span class="st">"Simulated"</span>))</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co"># make random groups from individual flights</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>indiv_dat <span class="ot">&lt;-</span> dat[<span class="sc">!</span><span class="fu">is.infinite</span>(dat<span class="sc">$</span>entry.time) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(dat<span class="sc">$</span>entry.time) <span class="sc">&amp;</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    dat<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"Individual"</span>, ]</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>indivs <span class="ot">&lt;-</span> <span class="fu">unique</span>(indiv_dat<span class="sc">$</span>Individuo)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>group_sizes <span class="ot">&lt;-</span> group_dat<span class="sc">$</span>group.size[<span class="sc">!</span><span class="fu">duplicated</span>(group_dat<span class="sc">$</span>Video)]</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a><span class="co"># use only group sizes 2:5</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>group_sizes <span class="ot">&lt;-</span> group_sizes[group_sizes <span class="sc">&lt;=</span> <span class="dv">5</span>]</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(group_sizes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>group_sizes
2 3 4 5 
6 4 9 8 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate group entries</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>sim_groups_l <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">cl =</span> <span class="dv">10</span>, <span class="cf">function</span>(x) {</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># randomize order of distribution of individuals per</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># experiment</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(x)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    g_size <span class="ot">&lt;-</span> <span class="fu">sample</span>((group_sizes), <span class="fu">length</span>(group_sizes)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sampled_indivs &lt;- sample(indivs, sum(g_size), replace =</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># TRUE)</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(g_size) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"sim"</span>, x, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(g_size), <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># indivs_split &lt;- split(sampled_indivs, f =</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># unlist(sapply(seq_along(g_size), function(x)</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rep(names(g_size)[x], g_size[x]))))</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set.seed</span>(x)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    indivs_split <span class="ot">&lt;-</span> <span class="fu">lapply</span>(g_size, <span class="cf">function</span>(w) <span class="fu">sample</span>(indivs, w))</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    sub_sim_groups_l <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(indivs_split), <span class="cf">function</span>(y) {</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        sim_group <span class="ot">&lt;-</span> indiv_dat[indiv_dat<span class="sc">$</span>Individuo <span class="sc">%in%</span> indivs_split[[y]],</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        sim_group<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">names</span>(g_size)[y]</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>        sim_group <span class="ot">&lt;-</span> sim_group[<span class="sc">!</span><span class="fu">is.na</span>(sim_group<span class="sc">$</span>entry.time), ]</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>        sim_group <span class="ot">&lt;-</span> sim_group[<span class="fu">order</span>(sim_group<span class="sc">$</span>entry.time), ]</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sim_group$entry.time.diff &lt;- sim_group$entry.time -</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># min(sim_group$entry.time)</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>        sim_group<span class="sc">$</span>entry.time.diff <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, sim_group<span class="sc">$</span>entry.time[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>            sim_group<span class="sc">$</span>entry.time[<span class="sc">-</span><span class="fu">nrow</span>(sim_group)])</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        sim_group <span class="ot">&lt;-</span> sim_group[<span class="sc">!</span><span class="fu">is.na</span>(sim_group<span class="sc">$</span>entry.time.diff),</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>        sim_group<span class="sc">$</span>entry.time.diff[sim_group<span class="sc">$</span>entry.time.diff <span class="sc">&gt;</span> <span class="dv">300</span>] <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sim_group$entry.time.diff &lt;- sim_group$entry.time -</span></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># min(sim_group$entry.time) sim_group &lt;-</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># sim_group[-which.min(sim_group$entry.time.diff),]</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>        sim_group<span class="sc">$</span>group.size <span class="ot">&lt;-</span> <span class="fu">nrow</span>(sim_group) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>        sim_group<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="st">"Simulated"</span>)</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(sim_group)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>    sub_sim_groups <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, sub_sim_groups_l)</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># bind excluding first individual</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sub_sim_groups, group_dat[group_dat<span class="sc">$</span>group.size <span class="sc">%in%</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>        <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">&amp;</span> group_dat<span class="sc">$</span>entry.time.diff <span class="sc">&gt;</span> <span class="fl">0.001</span>, ])</span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>sim_group_n <span class="ot">&lt;-</span> <span class="fu">sapply</span>(sim_groups_l, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x<span class="sc">$</span>group[x<span class="sc">$</span>type <span class="sc">==</span></span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Simulated"</span>])))</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(sim_group_n <span class="sc">==</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sim_group_dat <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(sim_groups_l, <span class="cf">function</span>(x) x[x<span class="sc">$</span>type <span class="sc">==</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Simulated"</span>, ]))</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>sim_group_dat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim_group_dat, group_dat)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># also make group.size.factor</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>sim_groups_l <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sim_groups_l, <span class="cf">function</span>(x) {</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(x<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Natural"</span>, <span class="st">"Artificial"</span>, <span class="st">"Simulated"</span>))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span>group.size.factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(x<span class="sc">$</span>group.size)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="plot-raw-data-1" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="plot-raw-data-1"><span class="header-section-number">2.4</span> Plot raw data</h2>
<p>All group sizes combined:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># custom_labels &lt;- unique(sim_groups_l[[3]]$group.size)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># custom_labels &lt;- paste("group size = ", custom_labels)</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># names(custom_labels) &lt;- unique(sim_groups_l[[3]]$group.size)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># table(call_rate_by_group$group.size, call_rate_by_group$type)</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> graph_cols[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>cols_transp <span class="ot">&lt;-</span> graph_cols_transp[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cols) <span class="ot">&lt;-</span> <span class="fu">names</span>(cols_transp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Natural"</span>, <span class="st">"Artificial"</span>, <span class="st">"Simulated"</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>gg_entry <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sim_groups_l[[<span class="dv">1</span>]],</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> entry.time.diff,</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols) <span class="sc">+</span></span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cols_transp) <span class="sc">+</span></span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>      <span class="co"># scale_fill_viridis_d(option = "G",</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>      <span class="co">#                      end = 0.8,</span></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>      <span class="co">#                      alpha = 0.6) +</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>           <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"natural"</span> <span class="ot">=</span> <span class="st">"Natural"</span>,</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial"</span> <span class="ot">=</span> <span class="st">"Artificial"</span>,</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">"simulated"</span> <span class="ot">=</span> <span class="st">"Simulated"</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Group type"</span>, <span class="at">y =</span> <span class="st">"Time difference (s)"</span>)</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>agg_grp_time <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(entry.time.diff <span class="sc">~</span> type <span class="sc">+</span> group, sim_groups_l[[<span class="dv">1</span>]], mean)</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>n_grps <span class="ot">&lt;-</span></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(group <span class="sc">~</span> type <span class="sc">+</span> group.size, sim_groups_l[[<span class="dv">1</span>]], <span class="cf">function</span>(x)</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>indivs <span class="ot">&lt;-</span></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>  n_grps<span class="sc">$</span>group <span class="sc">*</span> n_grps<span class="sc">$</span>group.size</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>agg_grps <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(group <span class="sc">~</span> type, n_grps, sum)</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>agg_grps<span class="sc">$</span>indivs <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(indivs <span class="sc">~</span> type, n_grps, sum)<span class="sc">$</span>indivs</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>agg_grps<span class="sc">$</span>n.labels <span class="ot">&lt;-</span></span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(agg_grps<span class="sc">$</span>group, <span class="st">" / "</span>, agg_grps<span class="sc">$</span>indivs)</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>agg_grps<span class="sc">$</span>n.labels[<span class="dv">1</span>] <span class="ot">&lt;-</span></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>  <span class="st">" n = 13 groups /</span><span class="sc">\n</span><span class="st"> 50 individuals"</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>agg_grps<span class="sc">$</span>distance <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">15</span></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>gg_entry <span class="ot">&lt;-</span> gg_entry <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">210</span>)) <span class="sc">+</span></span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_signif</span>(</span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_position =</span> <span class="fu">c</span>(<span class="dv">170</span>, <span class="dv">190</span>, <span class="dv">210</span>),</span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb35-86"><a href="#cb35-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb35-87"><a href="#cb35-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation =</span> <span class="fu">c</span>(<span class="st">'beta:-1.71~ (-2.31 - -1.103)'</span>, <span class="st">'beta:-0.99~ (-1.59 - -0.40)'</span>, <span class="st">'beta:-0.72 ~ (-1.30 - -0.12)'</span>), </span>
<span id="cb35-88"><a href="#cb35-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-89"><a href="#cb35-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">tip_length =</span> <span class="fl">0.02</span>,</span>
<span id="cb35-90"><a href="#cb35-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">textsize =</span> <span class="dv">3</span>,</span>
<span id="cb35-91"><a href="#cb35-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb35-92"><a href="#cb35-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb35-93"><a href="#cb35-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.2</span></span>
<span id="cb35-94"><a href="#cb35-94" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-95"><a href="#cb35-95" aria-hidden="true" tabindex="-1"></a>   gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb35-96"><a href="#cb35-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_grp_time,</span>
<span id="cb35-97"><a href="#cb35-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> entry.time.diff, <span class="at">x =</span> type),</span>
<span id="cb35-98"><a href="#cb35-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"orange"</span>,</span>
<span id="cb35-99"><a href="#cb35-99" aria-hidden="true" tabindex="-1"></a>    <span class="co"># draw jitter on the left</span></span>
<span id="cb35-100"><a href="#cb35-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb35-101"><a href="#cb35-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb35-102"><a href="#cb35-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb35-103"><a href="#cb35-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># control range of jitter</span></span>
<span id="cb35-104"><a href="#cb35-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb35-105"><a href="#cb35-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add some transparency</span></span>
<span id="cb35-106"><a href="#cb35-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb35-107"><a href="#cb35-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb35-108"><a href="#cb35-108" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-109"><a href="#cb35-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(</span>
<span id="cb35-110"><a href="#cb35-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">adjustcolor</span>(<span class="st">"orange"</span>, <span class="at">alpha.f =</span> <span class="fl">0.1</span>),</span>
<span id="cb35-111"><a href="#cb35-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_grp_time,</span>
<span id="cb35-112"><a href="#cb35-112" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> entry.time.diff, <span class="at">x =</span> type),</span>
<span id="cb35-113"><a href="#cb35-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">adjustcolor</span>(<span class="st">"orange"</span>, <span class="at">alpha.f =</span> <span class="fl">0.6</span>),</span>
<span id="cb35-114"><a href="#cb35-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">1</span>,</span>
<span id="cb35-115"><a href="#cb35-115" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb35-116"><a href="#cb35-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb35-117"><a href="#cb35-117" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-118"><a href="#cb35-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">lineheight =</span> <span class="fl">0.8</span>,</span>
<span id="cb35-119"><a href="#cb35-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_grps,</span>
<span id="cb35-120"><a href="#cb35-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> type, <span class="at">label =</span> n.labels),</span>
<span id="cb35-121"><a href="#cb35-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb35-122"><a href="#cb35-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="dv">0</span>,</span>
<span id="cb35-123"><a href="#cb35-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span></span>
<span id="cb35-124"><a href="#cb35-124" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb35-125"><a href="#cb35-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-126"><a href="#cb35-126" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb35-127"><a href="#cb35-127" aria-hidden="true" tabindex="-1"></a>  <span class="st">"./output/roost_entry_coordination_1_panel.png"</span>,</span>
<span id="cb35-128"><a href="#cb35-128" aria-hidden="true" tabindex="-1"></a>  gg_entry,</span>
<span id="cb35-129"><a href="#cb35-129" aria-hidden="true" tabindex="-1"></a>  grDevices<span class="sc">::</span>png,</span>
<span id="cb35-130"><a href="#cb35-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="fl">4.5</span>,</span>
<span id="cb35-131"><a href="#cb35-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="fl">3.5</span>,</span>
<span id="cb35-132"><a href="#cb35-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb35-133"><a href="#cb35-133" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>By group size:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim_groups_l[[<span class="dv">1</span>]],</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> entry.time.diff,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>           <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"natural"</span> <span class="ot">=</span> <span class="st">"Natural"</span>,</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial"</span> <span class="ot">=</span> <span class="st">"Artificial"</span>,</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">"simulated"</span> <span class="ot">=</span> <span class="st">"Simulated"</span></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> group.size.factor,</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group.size.factor =</span> custom_labels)</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Time difference (s)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regression-model-1" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="regression-model-1"><span class="header-section-number">2.5</span> Regression model</h2>
<ul>
<li><p>Add the group roost entry data to each simulated set and run a bayesian mixed effects model coordination on roost entry for each data set</p></li>
<li><p>The difference in time between when entering the roost between consecutive individuals was used as the response variable (modeled with a normal distribution), while group type (natural, artificial or simulated) was used as predictor</p></li>
<li><p>Group ID was included as varying effect</p></li>
<li><p>The posterior distributions from the 30 models were combined into a single model fit for statistical inference</p></li>
</ul>
<p>Model:</p>
<p><span class="math display">\[
\text{log(entry time difference + 1)} \sim \text{type} + \text{monotonic(group size)} + (\text{1} \mid \text{group})
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>entry_mod_list <span class="ot">&lt;-</span> <span class="fu">brm_multiple</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">log</span>(entry.time.diff <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> type <span class="sc">+</span> <span class="fu">mo</span>(group.size) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> group),</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> iter,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sim_groups_l,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> chains,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># only works if cmdstanr package is installed</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">threads =</span> <span class="fu">threading</span>(<span class="dv">2</span>),</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> chains,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">combine =</span> <span class="cn">FALSE</span>,</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> entry_mod_list[[<span class="dv">1</span>]], <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>entry_mod_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(entry_mod_list,  <span class="cf">function</span>(x) <span class="fu">add_criterion</span>(x, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>)))</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(entry_mod_list,</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"./data/processed/model_list_roost_entry_time_regression_monotonic.RDS"</span>)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co"># run null model</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>null_entry_mod_list <span class="ot">&lt;-</span> <span class="fu">brm_multiple</span>(</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> <span class="fu">log</span>(entry.time.diff <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> group),</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> iter,</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sim_groups_l,</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> chains,</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># only works if cmdstanr package is installed</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">threads =</span> <span class="fu">threading</span>(<span class="dv">2</span>),</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> chains,</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">combine =</span> <span class="cn">FALSE</span>,</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>)</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>null_entry_mod_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(null_entry_mod_list,  <span class="cf">function</span>(x) <span class="fu">add_criterion</span>(x, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>)))</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a><span class="co"># loo_compare(entry_mod_list[[1]], null_entry_mod_list[[1]])</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(null_entry_mod_list,</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">"./data/processed/null_model_list_roost_entry_time_regression_monotonic.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results-1" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="results-1"><span class="header-section-number">2.5.1</span> Results</h3>
<section id="model-performance-vs-null-model-1" class="level4" data-number="2.5.1.1">
<h4 data-number="2.5.1.1" class="anchored" data-anchor-id="model-performance-vs-null-model-1"><span class="header-section-number">2.5.1.1</span> Model performance vs null model</h4>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model_list_roost_entry_time_regression <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/model_list_roost_entry_time_regression_monotonic.RDS"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>null_model_list_roost_entry_time_regression <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/null_model_list_roost_entry_time_regression_monotonic.RDS"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>loo_diffs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(model_list_roost_entry_time_regression),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) loo<span class="sc">::</span><span class="fu">loo_compare</span>(model_list_roost_entry_time_regression[[x]],</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        null_model_list_roost_entry_time_regression[[x]]))</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>loo_diff <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, loo_diffs)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loo_diff)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>loo_diff <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(loo_diff)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>loo_diff<span class="sc">$</span>model <span class="ot">&lt;-</span> rows</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">cbind</span>(elpd_diff, se_diff) <span class="sc">~</span> model, loo_diff, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="kable-table">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">elpd_diff</th>
<th style="text-align: right;">se_diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">model_list_roost_entry_time_regression[[x]]</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">null_model_list_roost_entry_time_regression[[x]]</td>
<td style="text-align: right;">-14.07826</td>
<td style="text-align: right;">4.578788</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="model-fit-1" class="level4" data-number="2.5.1.2">
<h4 data-number="2.5.1.2" class="anchored" data-anchor-id="model-fit-1"><span class="header-section-number">2.5.1.2</span> Model fit</h4>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># average model</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>avrg_call <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"posterior_average("</span>, <span class="fu">paste0</span>(<span class="fu">paste0</span>(<span class="st">"model_list_roost_entry_time_regression[["</span>,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(model_list_roost_entry_time_regression), <span class="st">"]]"</span>), <span class="at">collapse =</span> <span class="st">", "</span>),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">", weights = 'loo')"</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>average_model_draws <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> avrg_call))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_extended_summary</span>(average_model_draws, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> fill_color,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta.prefix =</span> <span class="fu">c</span>(<span class="st">"^b_"</span>, <span class="st">"^bsp_mo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
<th style="text-align:left;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_Intercept
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
2.638
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.861
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
3.439
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
8933.489
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
12093.30
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_typeArtificial
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.990
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.405
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.585
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
14848.445
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
14559.90
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_typeSimulated
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.703
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.103
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
2.311
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
11169.393
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
14767.39
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
bsp_mogroup.size
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.331
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.576
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.078
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
9756.350
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
12736.37
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/regression%20results%20entry-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="contrasts-1" class="level4" data-number="2.5.1.3">
<h4 data-number="2.5.1.3" class="anchored" data-anchor-id="contrasts-1"><span class="header-section-number">2.5.1.3</span> Contrasts</h4>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>contrasts <span class="ot">&lt;-</span> <span class="fu">draws_contrasts</span>(average_model_draws, <span class="at">predictor_name =</span> <span class="st">"type"</span>,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">basal_level =</span> <span class="st">"Natural"</span>, <span class="at">fill_color =</span> fill_color)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>contrasts<span class="sc">$</span>contrasts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">est</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">l-95% CI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">u-95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; background-color: rgba(56, 170, 172, 38) !important;">Artificial - Natural</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.990</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-1.585</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.405</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(56, 170, 172, 38) !important;">Simulated - Natural</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-1.705</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-2.311</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-1.103</td>
</tr>
<tr class="odd">
<td style="text-align: left; background-color: rgba(56, 170, 172, 38) !important;">Simulated - Artificial</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.715</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-1.299</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.121</td>
</tr>
</tbody>
</table>
</div>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>contrasts<span class="sc">$</span>plot <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p><img src="data_analysis_files/figure-html/regresion%20contrasts%20roost%20entry-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="posterior-predictive-checks-1" class="level4" data-number="2.5.1.4">
<h4 data-number="2.5.1.4" class="anchored" data-anchor-id="posterior-predictive-checks-1"><span class="header-section-number">2.5.1.4</span> Posterior predictive checks</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> model_list_roost_entry_time_regression[[<span class="dv">1</span>]], <span class="at">group =</span> <span class="st">"type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="takeaways-1" class="level4 unnumbered unlisted alert alert-info">
<h4 class="unnumbered unlisted anchored" data-anchor-id="takeaways-1">Takeaways</h4>
<ul>
<li>Natural groups enter more coordinated than simulated and artificial groups</li>
<li>Artificial groups enter more coordinated than simulated groups</li>
<li>Entry time difference decreases with group size</li>
</ul>
</section>
</section>
</section>
</section>
<section id="calling-behavior" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Calling behavior</h1>
<section id="read-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="read-data"><span class="header-section-number">3.1</span> Read data</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>clls <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/curated_extended_selection_table_inquiry_calls_2020_&amp;_2021.RDS"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>sub_clls <span class="ot">&lt;-</span> clls[<span class="sc">!</span><span class="fu">duplicated</span>(clls<span class="sc">$</span>org.sound.files), ]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>sub_clls<span class="sc">$</span>file.duration <span class="ot">&lt;-</span> sub_clls<span class="sc">$</span>sound.file.samples<span class="sc">/</span>(sub_clls<span class="sc">$</span>sample.rate <span class="sc">*</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1000</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># metadat2 &lt;-</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># read.csv('./data/processed/metadata_inquiry_calls_2020_&amp;_2021.csv',</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co"># stringsAsFactors = FALSE)</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>metadat <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="st">"./data/raw/Anexo 1_Proyecto MPI enero 20-21.xlsx"</span>))</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(metadat) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">" "</span>, <span class="st">"."</span>, <span class="fu">names</span>(metadat))</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>metadat<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">substr</span>(metadat<span class="sc">$</span>DÃ­a, <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>metadat<span class="sc">$</span>year[<span class="fu">is.na</span>(metadat<span class="sc">$</span>year)] <span class="ot">&lt;-</span> <span class="st">"2021"</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>metadat <span class="ot">&lt;-</span> metadat[metadat<span class="sc">$</span>tipo.de.video <span class="sc">!=</span> <span class="st">"calibracion de video"</span>,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co"># audio solamente para identificacion de sonidos. TASA NO</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>metadat <span class="ot">&lt;-</span> metadat[metadat<span class="sc">$</span>Audio <span class="sc">!=</span> <span class="st">"60 y 61"</span>, ]</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>metadat<span class="sc">$</span>year.audio <span class="ot">&lt;-</span> <span class="fu">paste</span>(metadat<span class="sc">$</span>year, metadat<span class="sc">$</span>Audio, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>caps <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_excel</span>(<span class="st">"./data/raw/Proyecto MPI enero 2020_2.xlsx"</span>,</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet =</span> <span class="st">"Capturas"</span>))</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="co"># read acoustic parameter data</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>acous_param_l <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/acoustic_parameters_all_groups_specific_warbler_acoustic_measurements_curated_data_2020_&amp;_2021.RDS"</span>)</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="co"># read as RDS</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>agg_pred <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/predicted_individual_in_group_flights_2020_&amp;_2021.RDS"</span>)</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="co"># read diagnostics</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>diagnostics <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/random_forests_diagnostics_solo_flight.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="call-rate" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="call-rate"><span class="header-section-number">3.2</span> Call rate</h2>
<section id="individual-in-solo-flight-vs-overall-group-flight" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="individual-in-solo-flight-vs-overall-group-flight"><span class="header-section-number">3.2.1</span> Individual in solo flight vs overall group flight</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>call_rate_by_group <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/call_rate_by_group.RDS"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove those in which only one individual called</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/processed/group_call_individual_id_sequence.csv"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> call_id_seq[<span class="fu">order</span>(call_id_seq<span class="sc">$</span>event, call_id_seq<span class="sc">$</span>start),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>call_id_seq_list <span class="ot">&lt;-</span> <span class="fu">split</span>(call_id_seq, call_id_seq<span class="sc">$</span>event)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co"># get diversity and entropy</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>unique_callers_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(call_id_seq_list, <span class="cf">function</span>(x) {</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[<span class="fu">order</span>(x<span class="sc">$</span>start), ]</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> x<span class="sc">$</span>indiv</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(id_seq)))</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    unique.callers <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(id_seq))</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> x<span class="sc">$</span>group[<span class="dv">1</span>], <span class="at">unique.callers =</span> unique.callers)</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>unique_callers_df <span class="ot">&lt;-</span> <span class="fu">do_call</span>(rbind, unique_callers_list)</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>call_rate_by_group <span class="ot">&lt;-</span> call_rate_by_group[<span class="sc">!</span>call_rate_by_group<span class="sc">$</span>group <span class="sc">%in%</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    unique_callers_df<span class="sc">$</span>group[unique_callers_df<span class="sc">$</span>unique.callers <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>call_rate_by_group<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(call_rate_by_group<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span>,</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"solo"</span>, <span class="fu">paste</span>(call_rate_by_group<span class="sc">$</span>experiment, call_rate_by_group<span class="sc">$</span>type,</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>call_rate_by_group<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"mixed.group"</span>, <span class="st">"artificial.group"</span>,</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>    call_rate_by_group<span class="sc">$</span>type)</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>call_rate_by_group<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"regular.group"</span>, <span class="st">"natural.group"</span>,</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>    call_rate_by_group<span class="sc">$</span>type)</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>call_rate_by_group<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(call_rate_by_group<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"solo"</span>,</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"natural.group"</span>, <span class="st">"artificial.group"</span>))</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="co"># mean centering group size</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>call_rate_by_group<span class="sc">$</span>group.size.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(call_rate_by_group<span class="sc">$</span>group.size,</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-raw-data-2" class="level4" data-number="3.2.1.1">
<h4 data-number="3.2.1.1" class="anchored" data-anchor-id="plot-raw-data-2"><span class="header-section-number">3.2.1.1</span> Plot raw data</h4>
<p>All group sizes combined:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table(call_rate_by_group$group.size, call_rate_by_group$type)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> graph_cols[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>cols_transp <span class="ot">&lt;-</span> graph_cols_transp[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cols) <span class="ot">&lt;-</span> <span class="fu">names</span>(cols_transp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"solo"</span>, <span class="st">"natural.group"</span>, <span class="st">"artificial.group"</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  ggrate_indv_grp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(call_rate_by_group,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> rate,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>      <span class="co"># scale_color_viridis_d(option = "G", begin = 0.2, end = 0.8) +</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>      <span class="co"># scale_fill_viridis_d(option = "G",</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>      <span class="co">#                      end = 0.8,</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>      <span class="co">#                      alpha = 0.6) +</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols) <span class="sc">+</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cols_transp) <span class="sc">+</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">60</span>)) <span class="sc">+</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>           <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Solo"</span>,</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">"natural.group"</span> <span class="ot">=</span> <span class="st">"Natural group"</span>,</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Artificial group"</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Calling rate (calls / min)"</span>)</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(call_rate_by_group<span class="sc">$</span>group))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 69</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>n_grps <span class="ot">&lt;-</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(group <span class="sc">~</span> type, call_rate_by_group, <span class="cf">function</span>(x)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n_grps<span class="sc">$</span>type, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(call_rate_by_group<span class="sc">$</span>group[call_rate_by_group<span class="sc">$</span>type <span class="sc">==</span> x <span class="sc">&amp;</span> call_rate_by_group<span class="sc">$</span>indiv <span class="sc">==</span> <span class="st">"group"</span>])))</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>group[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(call_rate_by_group<span class="sc">$</span>group[call_rate_by_group<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span> <span class="sc">&amp;</span> call_rate_by_group<span class="sc">$</span>experiment <span class="sc">==</span> <span class="st">"regular"</span>]))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>indivs <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>indivs[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(call_rate_by_group<span class="sc">$</span>indiv[call_rate_by_group<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span>]))</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>distance <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>n.labels <span class="ot">&lt;-</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(n_grps<span class="sc">$</span>group, <span class="st">" / "</span>, n_grps<span class="sc">$</span>indivs)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>n.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"n = 131 individuals</span><span class="sc">\n</span><span class="st">from 29 groups"</span>,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"32 groups"</span>,</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"37 groups"</span>)</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>ggrate_indv_grp_pimp <span class="ot">&lt;-</span> ggrate_indv_grp <span class="sc">+</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Single individual"</span>,</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"natural.group"</span> <span class="ot">=</span> <span class="st">"Natural group"</span>,</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Artificial group"</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_signif</span>(</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_position =</span> <span class="fu">c</span>(<span class="dv">61</span>, <span class="dv">68</span>),</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation =</span> <span class="fu">c</span>(<span class="st">'beta:-0.41~ (-0.74 - -0.089)'</span>, <span class="st">'beta:-0.64 ~ (-1.05 - -0.23)'</span>), </span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">tip_length =</span> <span class="fl">0.02</span>,</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">textsize =</span> <span class="dv">3</span>,</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.2</span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">68</span>)) <span class="sc">+</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="at">lineheight =</span> <span class="fl">0.8</span>,</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> n_grps,</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> type, <span class="at">label =</span> n.labels),</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="dv">0</span>,</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>By group size:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span> <span class="fu">unique</span>(call_rate_by_group<span class="sc">$</span>group.size)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"group size = "</span>, custom_labels)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(custom_labels) <span class="ot">&lt;-</span> <span class="fu">unique</span>(call_rate_by_group<span class="sc">$</span>group.size)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(call_rate_by_group[call_rate_by_group<span class="sc">$</span>group.size <span class="sc">&lt;=</span> <span class="dv">5</span>,],</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> rate,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">60</span>)) <span class="sc">+</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>             <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Solo"</span>,</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">"natural.group"</span> <span class="ot">=</span> <span class="st">"Natural group"</span>,</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Artificial group"</span></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Calling rate (calls / min)"</span>) <span class="sc">+</span></span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> group.size.f,</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group.size.f =</span> custom_labels)</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>      ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regression-model-2" class="level4" data-number="3.2.1.2">
<h4 data-number="3.2.1.2" class="anchored" data-anchor-id="regression-model-2"><span class="header-section-number">3.2.1.2</span> Regression model</h4>
<p>Model:</p>
<p><span class="math display">\[
\text{call rate} \sim \text{type} + (1 \mid \text{group}) + \text{monotonic(group size)} + (\text{type} \mid \text{group})
\]</span></p>
<p>Response modeled with a negative binomial distribution.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> calls <span class="sc">|</span> <span class="fu">resp_rate</span>(flight.time) <span class="sc">~</span> type <span class="sc">+</span> <span class="fu">mo</span>(group.size.f) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    (type <span class="sc">|</span> group), <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> call_rate_by_group,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">negbinomial</span>(), <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>), <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file =</span> <span class="st">"./data/processed/individual_vs_group_call_rate_group_size_monot"</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_refit =</span> <span class="st">"always"</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="co"># custom_ppc(fit = mod, group = 'type')</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mod, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>))</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> calls <span class="sc">|</span> <span class="fu">resp_rate</span>(flight.time) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    group), <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> call_rate_by_group, <span class="at">family =</span> <span class="fu">negbinomial</span>(),</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains, <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file =</span> <span class="st">"./data/processed/null_mod_individual_vs_group_call_rate_group_size"</span>,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_refit =</span> <span class="st">"always"</span>)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(null_mod, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>))</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>beepr<span class="sc">::</span><span class="fu">beep</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="results-2" class="level4" data-number="3.2.1.3">
<h4 data-number="3.2.1.3" class="anchored" data-anchor-id="results-2"><span class="header-section-number">3.2.1.3</span> Results</h4>
<section id="model-performance-vs-null-model-2" class="level5" data-number="3.2.1.3.1">
<h5 data-number="3.2.1.3.1" class="anchored" data-anchor-id="model-performance-vs-null-model-2"><span class="header-section-number">3.2.1.3.1</span> Model performance vs null model</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/individual_vs_group_call_rate_group_size_monot.rds"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/null_mod_individual_vs_group_call_rate_group_size.rds"</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>loo_diff <span class="ot">&lt;-</span> loo<span class="sc">::</span><span class="fu">loo_compare</span>(mod, null_mod)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>loo_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         elpd_diff se_diff
mod        0.0       0.0  
null_mod -27.4      11.0  </code></pre>
</div>
</div>
</section>
<section id="model-fit-2" class="level5" data-number="3.2.1.3.2">
<h5 data-number="3.2.1.3.2" class="anchored" data-anchor-id="model-fit-2"><span class="header-section-number">3.2.1.3.2</span> Model fit</h5>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extended_summary</span>(<span class="at">fit =</span> mod, <span class="at">gsub.pattern =</span> <span class="st">"type"</span>, <span class="at">gsub.replacement =</span> <span class="st">"solo_vs_"</span>,</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">remove.intercepts =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">print.name =</span> <span class="cn">FALSE</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace.palette =</span> viridis<span class="sc">::</span>mako, <span class="at">fill =</span> fill_color, <span class="at">beta.prefix =</span> <span class="fu">c</span>(<span class="st">"^b_"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"^bsp_mo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
priors
</th>
<th style="text-align:left;">
formula
</th>
<th style="text-align:right;">
iterations
</th>
<th style="text-align:right;">
chains
</th>
<th style="text-align:right;">
thinning
</th>
<th style="text-align:right;">
warmup
</th>
<th style="text-align:left;">
diverg_transitions
</th>
<th style="text-align:left;">
rhats &gt; 1.05
</th>
<th style="text-align:right;">
min_bulk_ESS
</th>
<th style="text-align:right;">
min_tail_ESS
</th>
<th style="text-align:left;">
seed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Intercept-student_t(3, 3.3, 2.5) L-lkj_corr_cholesky(1) sd-student_t(3, 0, 2.5) shape-inv_gamma(0.4, 0.3) simo-dirichlet(1)
</td>
<td style="text-align:left;">
calls | resp_rate(flight.time) ~ type + mo(group.size.f) + (type | group)
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5000
</td>
<td style="text-align:left;">
<span style="     ">0 (0%)</span>
</td>
<td style="text-align:left;">
<span style="     ">0</span>
</td>
<td style="text-align:right;">
6836.813
</td>
<td style="text-align:right;">
10966.32
</td>
<td style="text-align:left;">
1764324928
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
<th style="text-align:left;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
b_solo_vs_natural.group
</td>
<td style="text-align:right;">
0.226
</td>
<td style="text-align:right;">
-0.040
</td>
<td style="text-align:right;">
0.485
</td>
<td style="text-align:left;">
<span style="     ">1</span>
</td>
<td style="text-align:right;">
15615.687
</td>
<td style="text-align:right;">
14364.50
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_solo_vs_artificial.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.412
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.743
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.089
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
11809.438
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
13918.76
</td>
</tr>
<tr>
<td style="text-align:left;">
bsp_mogroup.size.f
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
-0.087
</td>
<td style="text-align:right;">
0.096
</td>
<td style="text-align:left;">
<span style="     ">1</span>
</td>
<td style="text-align:right;">
6836.813
</td>
<td style="text-align:right;">
10966.32
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/individual%20vs%20group%20call%20rate%20results-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="contrasts-2" class="level5" data-number="3.2.1.3.3">
<h5 data-number="3.2.1.3.3" class="anchored" data-anchor-id="contrasts-2"><span class="header-section-number">3.2.1.3.3</span> Contrasts</h5>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(<span class="at">fit =</span> mod, <span class="at">predictor =</span> <span class="st">"type"</span>, <span class="at">n.posterior =</span> <span class="dv">2000</span>, <span class="at">level.sep =</span> <span class="st">" VS "</span>,</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">html.table =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> fill_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Contrasts
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Est.Error
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
solo VS natural.group
</td>
<td style="text-align:right;">
-0.226
</td>
<td style="text-align:right;">
0.133
</td>
<td style="text-align:right;">
0.040
</td>
<td style="text-align:right;">
-0.485
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
2
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
solo VS artificial.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.412
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.165
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.743
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.089
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
3
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
natural.group VS artificial.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.637
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.211
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.225
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.052
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/rate%20per%20group%20solo%20vs%20group%20results%20contrasts-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="posterior-predictive-checks-2" class="level5" data-number="3.2.1.3.4">
<h5 data-number="3.2.1.3.4" class="anchored" data-anchor-id="posterior-predictive-checks-2"><span class="header-section-number">3.2.1.3.4</span> Posterior predictive checks</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="takeaways-2" class="level5 unnumbered unlisted alert alert-info">
<h5 class="unnumbered unlisted anchored" data-anchor-id="takeaways-2">Takeaways</h5>
<ul>
<li>No difference in call rate between solo individuals and natural groups</li>
<li>Artificial groups produce lower call rates than solo individuals and natural groups</li>
<li>No effect of group size</li>
</ul>
</section>
</section>
</section>
<section id="individual-in-solo-flight-vs-individuals-in-group-flight" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="individual-in-solo-flight-vs-individuals-in-group-flight"><span class="header-section-number">3.2.2</span> Individual in solo flight vs individuals in group flight</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>call_rate_by_group <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/call_rate_by_group.RDS"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove those in which only one individual called</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/processed/group_call_individual_id_sequence.csv"</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> call_id_seq[<span class="fu">order</span>(call_id_seq<span class="sc">$</span>event, call_id_seq<span class="sc">$</span>start),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>call_id_seq_list <span class="ot">&lt;-</span> <span class="fu">split</span>(call_id_seq, call_id_seq<span class="sc">$</span>event)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a><span class="co"># get diversity and entropy</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>unique_callers_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(call_id_seq_list, <span class="cf">function</span>(x) {</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[<span class="fu">order</span>(x<span class="sc">$</span>start), ]</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> x<span class="sc">$</span>indiv</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(id_seq)))</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    unique.callers <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(id_seq))</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> x<span class="sc">$</span>group[<span class="dv">1</span>], <span class="at">unique.callers =</span> unique.callers)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>unique_callers_df <span class="ot">&lt;-</span> <span class="fu">do_call</span>(rbind, unique_callers_list)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>call_rate_by_group <span class="ot">&lt;-</span> call_rate_by_group[<span class="sc">!</span>call_rate_by_group<span class="sc">$</span>group <span class="sc">%in%</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    unique_callers_df<span class="sc">$</span>group[unique_callers_df<span class="sc">$</span>unique.callers <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>call_rate_indiv <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/call_rate_by_individual.RDS"</span>)</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>call_rate_indiv <span class="ot">&lt;-</span> call_rate_indiv[<span class="sc">!</span>call_rate_indiv<span class="sc">$</span>group <span class="sc">%in%</span> unique_callers_df<span class="sc">$</span>group[unique_callers_df<span class="sc">$</span>unique.callers <span class="sc">==</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>], ]</span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>call_rate_by_group <span class="ot">&lt;-</span> call_rate_by_group[call_rate_by_group<span class="sc">$</span>type <span class="sc">!=</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"solo"</span>, ]</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>call_rate_by_group<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"overall.group"</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>call_rate_indiv<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">as.character</span>(call_rate_indiv<span class="sc">$</span>type)</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>call_rate_indiv<span class="sc">$</span>type[call_rate_indiv<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"group"</span>] <span class="ot">&lt;-</span> <span class="st">"indiv.group"</span></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>call_rate <span class="ot">&lt;-</span> <span class="fu">rbind</span>(call_rate_by_group[, <span class="fu">intersect</span>(<span class="fu">names</span>(call_rate_by_group),</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(call_rate_indiv))], call_rate_indiv[, <span class="fu">intersect</span>(<span class="fu">names</span>(call_rate_by_group),</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(call_rate_indiv))])</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate for plot</span></span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>agg_rate <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(rate <span class="sc">~</span> experiment <span class="sc">+</span> type <span class="sc">+</span> group.size, <span class="at">data =</span> call_rate,</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> mean)</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>agg_rate<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(rate <span class="sc">~</span> experiment <span class="sc">+</span> type <span class="sc">+</span> group.size, <span class="at">data =</span> call_rate,</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> sd)<span class="sc">$</span>rate</span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>agg_rate<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(agg_rate<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"solo"</span>, <span class="st">"indiv.group"</span>,</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"overall.group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>call_rate_indiv <span class="ot">&lt;-</span> call_rate_indiv[<span class="sc">!</span><span class="fu">is.na</span>(call_rate_indiv<span class="sc">$</span>rate) <span class="sc">&amp;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    call_rate_indiv<span class="sc">$</span>rate <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>no_solo <span class="ot">&lt;-</span> call_rate_indiv[call_rate_indiv<span class="sc">$</span>type <span class="sc">!=</span> <span class="st">"solo"</span>, ]</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(indiv <span class="sc">~</span> group <span class="sc">+</span> experiment, <span class="at">data =</span> no_solo, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>group.size <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(group.size <span class="sc">~</span> group <span class="sc">+</span> experiment, <span class="at">data =</span> no_solo,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) <span class="fu">mean</span>(x))<span class="sc">$</span>group.size</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>prop.callers <span class="ot">&lt;-</span> agg<span class="sc">$</span>indiv<span class="sc">/</span>agg<span class="sc">$</span>group.size</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co"># t.test(agg$prop.callers ~ agg$experiment)</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate(prop.callers ~ experiment, agg, mean)</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate(prop.callers ~ experiment, agg, sd)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In average 0.81 (+/- 0.2 SD) individuals in group flights called</p>
<section id="plot-raw-data-3" class="level4" data-number="3.2.2.1">
<h4 data-number="3.2.2.1" class="anchored" data-anchor-id="plot-raw-data-3"><span class="header-section-number">3.2.2.1</span> Plot raw data</h4>
<p>All group sizes combined:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>call_rate_indiv <span class="ot">&lt;-</span> call_rate_indiv[<span class="sc">!</span><span class="fu">is.na</span>(call_rate_indiv<span class="sc">$</span>rate) <span class="sc">&amp;</span> call_rate_indiv<span class="sc">$</span>rate <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.factor</span>(call_rate_indiv<span class="sc">$</span>type)){</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>call_rate_indiv<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(call_rate_indiv<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span>, <span class="st">"solo"</span>, <span class="fu">paste</span>(call_rate_indiv<span class="sc">$</span>experiment, call_rate_indiv<span class="sc">$</span>type, <span class="at">sep =</span> <span class="st">"-"</span>))</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>call_rate_indiv<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"mixed-indiv.group"</span>, <span class="st">"artificial.group"</span>, call_rate_indiv<span class="sc">$</span>type)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>call_rate_indiv<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"regular-indiv.group"</span>, <span class="st">"natural.group"</span>, call_rate_indiv<span class="sc">$</span>type)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>call_rate_indiv<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(call_rate_indiv<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"solo"</span>, <span class="st">"natural.group"</span>, <span class="st">"artificial.group"</span>)) </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="co"># table(call_rate_by_group$group.size, call_rate_by_group$type)</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> graph_cols[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>cols_transp <span class="ot">&lt;-</span> graph_cols_transp[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cols) <span class="ot">&lt;-</span> <span class="fu">names</span>(cols_transp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"solo"</span>, <span class="st">"natural.group"</span>, <span class="st">"artificial.group"</span>)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>gg_rate_indiv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(call_rate_indiv,</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> rate,</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a>      <span class="co"># scale_fill_viridis_d(option = "G",</span></span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a>      <span class="co">#                      end = 0.8,</span></span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>      <span class="co">#                      alpha = 0.6) +</span></span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a>     <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols) <span class="sc">+</span></span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> cols_transp) <span class="sc">+</span></span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb57-62"><a href="#cb57-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb57-63"><a href="#cb57-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Type"</span>, <span class="at">y =</span> <span class="st">"Calling rate (calls / min)"</span>) <span class="sc">+</span></span>
<span id="cb57-64"><a href="#cb57-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb57-65"><a href="#cb57-65" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Solo"</span>,</span>
<span id="cb57-66"><a href="#cb57-66" aria-hidden="true" tabindex="-1"></a>        <span class="st">"natural.group"</span> <span class="ot">=</span> <span class="st">"Natural group"</span>,</span>
<span id="cb57-67"><a href="#cb57-67" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Artificial group"</span></span>
<span id="cb57-68"><a href="#cb57-68" aria-hidden="true" tabindex="-1"></a>      ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>n_grps <span class="ot">&lt;-</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(group <span class="sc">~</span> type, call_rate_indiv, <span class="cf">function</span>(x)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>indivs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n_grps<span class="sc">$</span>type, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(call_rate_indiv<span class="sc">$</span>indiv[call_rate_indiv<span class="sc">$</span>type <span class="sc">==</span> x])))</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>group[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(call_rate_indiv<span class="sc">$</span>group[call_rate_indiv<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span> <span class="sc">&amp;</span> call_rate_indiv<span class="sc">$</span>experiment <span class="sc">==</span> <span class="st">"regular"</span>]))</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>indivs[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(call_rate_indiv<span class="sc">$</span>indiv[call_rate_indiv<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span> <span class="sc">&amp;</span> call_rate_indiv<span class="sc">$</span>experiment <span class="sc">==</span> <span class="st">"regular"</span>]))</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>distance <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>n.labels <span class="ot">&lt;-</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(n_grps<span class="sc">$</span>group, <span class="st">" / "</span>, n_grps<span class="sc">$</span>indivs)</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>n.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"n = 81 individuals</span><span class="sc">\n</span><span class="st">from 23 groups"</span>,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"63 individuals</span><span class="sc">\n</span><span class="st">21 groups"</span>,</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"44 individuals</span><span class="sc">\n</span><span class="st">21 groups"</span>)</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>agg_rate <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(rate <span class="sc">~</span> type <span class="sc">+</span> group, <span class="at">data =</span> call_rate_indiv, <span class="at">FUN =</span> mean)</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(agg_rate$group, function(x) if(any(agg_rate$type == "natural.group")) "natural" else "artificial")</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only those solo from natural groups</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>solo_keep <span class="ot">&lt;-</span> agg_rate[agg_rate<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"natural.group"</span>, ]</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>solo_keep <span class="ot">&lt;-</span> solo_keep<span class="sc">$</span>group[solo_keep<span class="sc">$</span>group <span class="sc">%in%</span> agg_rate<span class="sc">$</span>group[agg_rate<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span>]]</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>agg_rate <span class="ot">&lt;-</span> agg_rate[(agg_rate<span class="sc">$</span>group <span class="sc">%in%</span> solo_keep <span class="sc">&amp;</span> agg_rate<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span>) <span class="sc">|</span> agg_rate<span class="sc">$</span>type <span class="sc">!=</span> <span class="st">"solo"</span>, ]</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>gg_rate_indiv_pimp <span class="ot">&lt;-</span> gg_rate_indiv <span class="sc">+</span> </span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">35</span>)) <span class="sc">+</span></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">lineheight =</span> <span class="fl">0.8</span>,</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> n_grps,</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> type, <span class="at">label =</span> n.labels),</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="dv">0</span>,</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(</span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_position =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">34</span>),</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation =</span> <span class="fu">c</span>(<span class="st">'beta:-1.60~ (-1.87 - -1.33)'</span>, <span class="st">'beta:-1.31 ~ (-1.55 - -1.07)'</span>), </span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">tip_length =</span> <span class="fl">0.02</span>,</span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">textsize =</span> <span class="dv">3</span>,</span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.2</span></span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">adjustcolor</span>(<span class="st">"orange"</span>, <span class="at">alpha.f =</span> <span class="fl">0.1</span>),</span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_rate,</span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> rate,</span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type</span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a>       ),</span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">adjustcolor</span>(<span class="st">"orange"</span>, <span class="at">alpha.f =</span> <span class="fl">0.6</span>),</span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">1</span>,</span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a>   gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_rate,</span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> rate, <span class="at">x =</span> type),</span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"orange"</span>,</span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># draw jitter on the left</span></span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># control range of jitter</span></span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add some transparency</span></span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Single individual"</span>,</span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a>        <span class="st">"natural.group"</span> <span class="ot">=</span> <span class="st">"Individual in</span><span class="sc">\n</span><span class="st"> natural group"</span>,</span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Individual in</span><span class="sc">\n</span><span class="st">artificial group"</span></span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb58-87"><a href="#cb58-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-88"><a href="#cb58-88" aria-hidden="true" tabindex="-1"></a>gg_rate_indiv_pimp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>By group size:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(call_rate_indiv,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> rate,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Type"</span>, <span class="at">y =</span> <span class="st">"Rate (calls / min)"</span>) <span class="sc">+</span> </span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(</span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> group.size,</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group.size =</span> custom_labels)</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Solo"</span>,</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"natural.group"</span> <span class="ot">=</span> <span class="st">"Natural group"</span>,</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Artificial group"</span></span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a>      ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regression-model-3" class="level4" data-number="3.2.2.2">
<h4 data-number="3.2.2.2" class="anchored" data-anchor-id="regression-model-3"><span class="header-section-number">3.2.2.2</span> Regression model</h4>
<p><span class="math display">\[
\text{call rate} \sim \text{type} + (1 \mid \text{group}) + \text{monotonic(group size)} + (1 \mid \text{individual})
\]</span></p>
<p>Response modeled with a log-normal distribution.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> calls <span class="sc">|</span> <span class="fu">resp_rate</span>(flight.time) <span class="sc">~</span> type <span class="sc">+</span> <span class="fu">mo</span>(group.size.f) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> indiv), <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> call_rate_indiv, <span class="at">family =</span> <span class="fu">negbinomial</span>(),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file =</span> <span class="st">"./data/processed/individual_call_rate_solo_vs_group_group_size_monot_negbinomial"</span>,</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_refit =</span> <span class="st">"always"</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> calls <span class="sc">|</span> <span class="fu">resp_rate</span>(flight.time) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    indiv), <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> call_rate_indiv, <span class="at">family =</span> <span class="fu">negbinomial</span>(),</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file =</span> <span class="st">"./data/processed/null_model_individual_call_rate_solo_vs_group_group_size_monot_negbinomial"</span>,</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_refit =</span> <span class="st">"always"</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(null_mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results-3" class="level5" data-number="3.2.2.2.1">
<h5 data-number="3.2.2.2.1" class="anchored" data-anchor-id="results-3"><span class="header-section-number">3.2.2.2.1</span> Results</h5>
<section id="model-performance-vs-null-model-3" class="level6" data-number="3.2.2.2.1.1">
<h6 data-number="3.2.2.2.1.1" class="anchored" data-anchor-id="model-performance-vs-null-model-3"><span class="header-section-number">3.2.2.2.1.1</span> Model performance vs null model</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/individual_call_rate_solo_vs_group_group_size_monot.rds"</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/null_model_individual_call_rate_solo_vs_group_group_size_monot.rds"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(mod, null_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         elpd_diff se_diff
mod        0.0       0.0  
null_mod -79.4      10.4  </code></pre>
</div>
</div>
</section>
<section id="model-fit-3" class="level6" data-number="3.2.2.2.1.2">
<h6 data-number="3.2.2.2.1.2" class="anchored" data-anchor-id="model-fit-3"><span class="header-section-number">3.2.2.2.1.2</span> Model fit</h6>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extended_summary</span>(<span class="at">fit =</span> mod, <span class="at">gsub.pattern =</span> <span class="st">"type"</span>, <span class="at">gsub.replacement =</span> <span class="st">"solo_vs_"</span>,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">remove.intercepts =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">print.name =</span> <span class="cn">FALSE</span>,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace.palette =</span> viridis<span class="sc">::</span>mako, <span class="at">fill =</span> fill_color, <span class="at">beta.prefix =</span> <span class="fu">c</span>(<span class="st">"^b_"</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"^bsp_mo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
priors
</th>
<th style="text-align:left;">
formula
</th>
<th style="text-align:right;">
iterations
</th>
<th style="text-align:right;">
chains
</th>
<th style="text-align:right;">
thinning
</th>
<th style="text-align:right;">
warmup
</th>
<th style="text-align:left;">
diverg_transitions
</th>
<th style="text-align:left;">
rhats &gt; 1.05
</th>
<th style="text-align:right;">
min_bulk_ESS
</th>
<th style="text-align:right;">
min_tail_ESS
</th>
<th style="text-align:left;">
seed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Intercept-student_t(3, 1.9, 2.5) sd-student_t(3, 0, 2.5) sigma-student_t(3, 0, 2.5) simo-dirichlet(1)
</td>
<td style="text-align:left;">
rate ~ type + mo(group.size.f) + (1 | indiv)
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5000
</td>
<td style="text-align:left;">
<span style="     ">0 (0%)</span>
</td>
<td style="text-align:left;">
<span style="     ">0</span>
</td>
<td style="text-align:right;">
10027.95
</td>
<td style="text-align:right;">
13624.49
</td>
<td style="text-align:left;">
2138101156
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
<th style="text-align:left;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_solo_vs_natural.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-1.308
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-1.550
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-1.067
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
29407.61
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
16023.32
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_solo_vs_artificial.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-1.601
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-1.873
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-1.329
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
29640.05
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
15070.35
</td>
</tr>
<tr>
<td style="text-align:left;">
bsp_mogroup.size.f
</td>
<td style="text-align:right;">
-0.093
</td>
<td style="text-align:right;">
-0.211
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:left;">
<span style="     ">1</span>
</td>
<td style="text-align:right;">
10027.95
</td>
<td style="text-align:right;">
13624.49
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/individual%20call%20rate%20results-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="contrasts-3" class="level6" data-number="3.2.2.2.1.3">
<h6 data-number="3.2.2.2.1.3" class="anchored" data-anchor-id="contrasts-3"><span class="header-section-number">3.2.2.2.1.3</span> Contrasts</h6>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(<span class="at">fit =</span> mod, <span class="at">predictor =</span> <span class="st">"type"</span>, <span class="at">n.posterior =</span> <span class="dv">2000</span>, <span class="at">level.sep =</span> <span class="st">" VS "</span>,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">html.table =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> fill_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Contrasts
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Est.Error
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
1
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
natural.group VS solo
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-1.308
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.122
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-1.550
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-1.067
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
natural.group VS artificial.group
</td>
<td style="text-align:right;">
0.293
</td>
<td style="text-align:right;">
0.167
</td>
<td style="text-align:right;">
-0.033
</td>
<td style="text-align:right;">
0.623
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
3
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
solo VS artificial.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.601
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.139
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.873
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.329
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/contrasts-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="posterior-predictive-checks-3" class="level6" data-number="3.2.2.2.1.4">
<h6 data-number="3.2.2.2.1.4" class="anchored" data-anchor-id="posterior-predictive-checks-3"><span class="header-section-number">3.2.2.2.1.4</span> Posterior predictive checks</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="takeaways-3" class="level6 unnumbered unlisted alert alert-info">
<h6 class="unnumbered unlisted anchored" data-anchor-id="takeaways-3">Takeaways</h6>
<ul>
<li>Individuals in natural and artificial groups produce lower call rates than in solo flights</li>
<li>No difference in call rate between natural and artificial groups</li>
<li>No effect of group size</li>
</ul>
</section>
</section>
</section>
</section>
<section id="individual-consistency-in-call-rate-across-flight-types" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="individual-consistency-in-call-rate-across-flight-types"><span class="header-section-number">3.2.3</span> Individual consistency in call rate across flight types</h3>
<section id="plot-raw-data-4" class="level4" data-number="3.2.3.1">
<h4 data-number="3.2.3.1" class="anchored" data-anchor-id="plot-raw-data-4"><span class="header-section-number">3.2.3.1</span> Plot raw data</h4>
<p>All group sizes combined:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>call_rate_indiv <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/call_rate_by_individual.RDS"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>call_rate_indiv <span class="ot">&lt;-</span> call_rate_indiv[<span class="sc">!</span>call_rate_indiv<span class="sc">$</span>group <span class="sc">%in%</span> unique_callers_df<span class="sc">$</span>group[unique_callers_df<span class="sc">$</span>unique.callers <span class="sc">==</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>], ]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>call_rate_by_group <span class="ot">&lt;-</span> call_rate_by_group[call_rate_by_group<span class="sc">$</span>type <span class="sc">!=</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"solo"</span>, ]</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>call_rate_by_group<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"overall.group"</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>call_rate_indiv<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">as.character</span>(call_rate_indiv<span class="sc">$</span>type)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>call_rate_indiv<span class="sc">$</span>type[call_rate_indiv<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"group"</span>] <span class="ot">&lt;-</span> <span class="st">"indiv.group"</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>call_rate_indiv <span class="ot">&lt;-</span> call_rate_indiv[<span class="sc">!</span><span class="fu">is.na</span>(call_rate_indiv<span class="sc">$</span>rate) <span class="sc">&amp;</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    call_rate_indiv<span class="sc">$</span>rate <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>call_rate_indiv_cov_l <span class="ot">&lt;-</span> <span class="fu">lapply</span>(call_rate_indiv<span class="sc">$</span>indiv, <span class="cf">function</span>(x) {</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> call_rate_indiv[call_rate_indiv<span class="sc">$</span>indiv <span class="sc">==</span> x, ]</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    out2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(Y<span class="sc">$</span>group), <span class="cf">function</span>(y) {</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>        Y2 <span class="ot">&lt;-</span> Y[Y<span class="sc">$</span>group <span class="sc">==</span> y, ]</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>        res <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">unstack</span>(Y2[, <span class="fu">c</span>(<span class="st">"rate"</span>, <span class="st">"type"</span>)])))</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>        res<span class="sc">$</span>group <span class="ot">&lt;-</span> y</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>        res<span class="sc">$</span>experiment <span class="ot">&lt;-</span> Y2<span class="sc">$</span>experiment[<span class="dv">1</span>]</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>        res<span class="sc">$</span>group.size <span class="ot">&lt;-</span> Y2<span class="sc">$</span>group.size[<span class="dv">1</span>]</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(res)</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>    out2 <span class="ot">&lt;-</span> out2[<span class="fu">sapply</span>(out2, ncol) <span class="sc">==</span> <span class="dv">5</span>]</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>    rate_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, out2)</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>    rate_df<span class="sc">$</span>indiv <span class="ot">&lt;-</span> x</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(rate_df)</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>call_rate_indiv_cov <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, call_rate_indiv_cov_l[<span class="fu">sapply</span>(call_rate_indiv_cov_l,</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>    class) <span class="sc">==</span> <span class="st">"data.frame"</span>])</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>call_rate_indiv_cov<span class="sc">$</span>experiment <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(call_rate_indiv_cov<span class="sc">$</span>experiment <span class="sc">==</span></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mixed"</span>, <span class="st">"artificial"</span>, <span class="st">"natural"</span>)</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a><span class="co"># make group size a factor</span></span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>call_rate_indiv_cov<span class="sc">$</span>group.size.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(call_rate_indiv_cov<span class="sc">$</span>group.size,</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(call_rate_indiv_cov, <span class="fu">aes</span>(<span class="at">y =</span> indiv.group, <span class="at">x =</span> solo, <span class="at">color =</span> experiment)) <span class="sc">+</span></span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">40</span>)) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">40</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Type"</span>, <span class="at">y =</span> <span class="st">"Rate (calls / min)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>By group size:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(call_rate_indiv_cov, <span class="fu">aes</span>(<span class="at">y =</span> indiv.group, <span class="at">x =</span> solo, <span class="at">color =</span> experiment)) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">40</span>)) <span class="sc">+</span> <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">40</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Type"</span>, <span class="at">y =</span> <span class="st">"Rate (calls / min)"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>group.size.f,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group.size.f =</span> custom_labels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regression-model-4" class="level4" data-number="3.2.3.2">
<h4 data-number="3.2.3.2" class="anchored" data-anchor-id="regression-model-4"><span class="header-section-number">3.2.3.2</span> Regression model</h4>
<p><span class="math display">\[
\text{indiv call rate in group} \sim \text{solo call rate} + \text{experiment} + (1 \mid \text{group}) + \text{monotonic(group size)} + (1 \mid \text{individual})
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> indiv.group <span class="sc">~</span> solo <span class="sc">+</span> experiment <span class="sc">+</span> <span class="fu">mo</span>(group.size.f) <span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> indiv), <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> call_rate_indiv_cov,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file =</span> <span class="st">"./data/processed/individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_refit =</span> <span class="st">"always"</span>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>mod_inter <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> indiv.group <span class="sc">~</span> solo <span class="sc">*</span> experiment <span class="sc">+</span> <span class="fu">mo</span>(group.size.f) <span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> indiv), <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> call_rate_indiv_cov,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains,</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file =</span> <span class="st">"./data/processed/individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial_interaction"</span>,</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_refit =</span> <span class="st">"always"</span>)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>mod_inter <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mod_inter, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> indiv.group <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">mo</span>(group.size.f) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    indiv), <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> call_rate_indiv_cov, <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file =</span> <span class="st">"./data/processed/null_model_individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial"</span>,</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_refit =</span> <span class="st">"always"</span>)</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(null_mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results-4" class="level5" data-number="3.2.3.2.1">
<h5 data-number="3.2.3.2.1" class="anchored" data-anchor-id="results-4"><span class="header-section-number">3.2.3.2.1</span> Results</h5>
<section id="model-performance-vs-null-model-4" class="level6" data-number="3.2.3.2.1.1">
<h6 data-number="3.2.3.2.1.1" class="anchored" data-anchor-id="model-performance-vs-null-model-4"><span class="header-section-number">3.2.3.2.1.1</span> Model performance vs null model</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial.rds"</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>mod_inter <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial_interaction.rds"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/null_model_individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial.rds"</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(mod, mod_inter, null_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          elpd_diff se_diff
mod        0.0       0.0   
mod_inter -0.8       1.6   
null_mod  -1.1       1.5   </code></pre>
</div>
</div>
</section>
<section id="model-fit-4" class="level6" data-number="3.2.3.2.1.2">
<h6 data-number="3.2.3.2.1.2" class="anchored" data-anchor-id="model-fit-4"><span class="header-section-number">3.2.3.2.1.2</span> Model fit</h6>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extended_summary</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit =</span> mod,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove.intercepts =</span> <span class="cn">TRUE</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">print.name =</span> <span class="cn">FALSE</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace.palette =</span> viridis<span class="sc">::</span>mako, </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> fill_color,</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta.prefix =</span> <span class="fu">c</span>(<span class="st">"^b_"</span>, <span class="st">"^bsp_mo"</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
priors
</th>
<th style="text-align:left;">
formula
</th>
<th style="text-align:right;">
iterations
</th>
<th style="text-align:right;">
chains
</th>
<th style="text-align:right;">
thinning
</th>
<th style="text-align:right;">
warmup
</th>
<th style="text-align:left;">
diverg_transitions
</th>
<th style="text-align:left;">
rhats &gt; 1.05
</th>
<th style="text-align:right;">
min_bulk_ESS
</th>
<th style="text-align:right;">
min_tail_ESS
</th>
<th style="text-align:left;">
seed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Intercept-student_t(3, 2.2, 2.5) sd-student_t(3, 0, 2.5) sigma-student_t(3, 0, 2.5) simo-dirichlet(1)
</td>
<td style="text-align:left;">
indiv.group ~ solo + experiment + mo(group.size.f) + (1 | indiv)
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5000
</td>
<td style="text-align:left;">
<span style="     ">0 (0%)</span>
</td>
<td style="text-align:left;">
<span style="     ">0</span>
</td>
<td style="text-align:right;">
6969.194
</td>
<td style="text-align:right;">
7450.404
</td>
<td style="text-align:left;">
734280391
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
<th style="text-align:left;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_solo
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.113
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.014
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.212
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1.001</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
6969.194
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
10272.338
</td>
</tr>
<tr>
<td style="text-align:left;">
b_experimentnatural
</td>
<td style="text-align:right;">
0.605
</td>
<td style="text-align:right;">
-0.818
</td>
<td style="text-align:right;">
2.041
</td>
<td style="text-align:left;">
<span style="     ">1</span>
</td>
<td style="text-align:right;">
14164.781
</td>
<td style="text-align:right;">
15121.912
</td>
</tr>
<tr>
<td style="text-align:left;">
bsp_mogroup.size.f
</td>
<td style="text-align:right;">
-0.586
</td>
<td style="text-align:right;">
-1.400
</td>
<td style="text-align:right;">
0.047
</td>
<td style="text-align:left;">
<span style="     ">1</span>
</td>
<td style="text-align:right;">
7170.390
</td>
<td style="text-align:right;">
7450.404
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/individual%20call%20rate%20covariation%20results-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="posterior-predictive-checks-4" class="level6" data-number="3.2.3.2.1.3">
<h6 data-number="3.2.3.2.1.3" class="anchored" data-anchor-id="posterior-predictive-checks-4"><span class="header-section-number">3.2.3.2.1.3</span> Posterior predictive checks</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="takeaways-4" class="level6 unnumbered unlisted alert alert-info">
<h6 class="unnumbered unlisted anchored" data-anchor-id="takeaways-4">Takeaways</h6>
<ul>
<li>Individual call rate is positively associated between solo and group flights</li>
<li>Association of call rate between solo and group flights is similar between natural and artificial groups</li>
<li>No effect of group size</li>
</ul>
</section>
</section>
</section>
</section>
</section>
<section id="simulated-group-calling" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="simulated-group-calling"><span class="header-section-number">3.3</span> Simulated group calling</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>time_calls_indiv <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/time_position_calls_by_individual.RDS"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only 120 s duration flights</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>time_calls_indiv <span class="ot">&lt;-</span> time_calls_indiv[time_calls_indiv<span class="sc">$</span>flight.time <span class="sc">==</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">120</span>, ]</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>time_calls_indiv <span class="ot">&lt;-</span> time_calls_indiv[<span class="fu">complete.cases</span>(time_calls_indiv),</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>time_calls_indiv<span class="sc">$</span>sound.files <span class="ot">&lt;-</span> time_calls_indiv<span class="sc">$</span>orig.sound.files</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>ovlp <span class="ot">&lt;-</span> <span class="fu">overlapping_sels</span>(time_calls_indiv, <span class="at">parallel =</span> <span class="dv">10</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="co"># remove overlapping sounds</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>time_calls_indiv <span class="ot">&lt;-</span> ovlp[<span class="fu">is.na</span>(ovlp<span class="sc">$</span>ovlp.sels), ]</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>sim_group_call_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="cf">function</span>(x) <span class="fu">sim_group_call</span>(<span class="fu">c</span>(group_sizes,</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="dv">7</span>, <span class="dv">6</span>)), <span class="at">seed =</span> x))</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a><span class="co"># add simulation tag</span></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>sim_group_call_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(sim_group_call_list), <span class="cf">function</span>(x) {</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> sim_group_call_list[[x]]</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>    Y<span class="sc">$</span>sim <span class="ot">&lt;-</span> x</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>    Y<span class="sc">$</span>sound.files <span class="ot">&lt;-</span> <span class="fu">paste0</span>(Y<span class="sc">$</span>sound.files, <span class="st">"-sim"</span>, x)</span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>    Y<span class="sc">$</span>selec <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(Y))</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(Y)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>sim_group_call_df <span class="ot">&lt;-</span> <span class="fu">do_call</span>(rbind, sim_group_call_list)</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>ovlps <span class="ot">&lt;-</span> <span class="fu">overlapping_sels</span>(sim_group_call_df, <span class="at">parallel =</span> <span class="dv">10</span>)</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>ovlp_count_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(ovlps<span class="sc">$</span>sound.files), <span class="cf">function</span>(x) {</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> ovlps[ovlps<span class="sc">$</span>sound.files <span class="sc">==</span> x, ]</span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>    cnt <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(X<span class="sc">$</span>ovlp.sels))</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sound.files =</span> x, <span class="at">group.size =</span> X<span class="sc">$</span>group.size[<span class="dv">1</span>],</span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">ovlp.count =</span> cnt)</span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>ovlp_count_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, ovlp_count_list)</span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>ovlp_count_df<span class="sc">$</span>ovlp.count <span class="ot">&lt;-</span> ovlp_count_df<span class="sc">$</span>ovlp.count<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a>ovlp_count_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Simulated"</span></span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a>ovlp_count_df<span class="sc">$</span>flight.time <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a>ovlp_count_df<span class="sc">$</span>ovlp.rate <span class="ot">&lt;-</span> ovlp_count_df<span class="sc">$</span>ovlp.count<span class="sc">/</span>ovlp_count_df<span class="sc">$</span>fligh.time</span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ovlp_count_df, <span class="st">"./data/processed/ovlps_simulated_group_call.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>sim_ovlp_count_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/ovlps_simulated_group_call.RDS"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot with histogram of # of overlapping sounds by group size</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim_ovlp_count_df, <span class="fu">aes</span>(<span class="at">x =</span> ovlp.rate, <span class="at">fill =</span> <span class="fu">factor</span>(group.size))) <span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of overlaps"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>group.size)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>time_calls_groups <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/time_position_calls_for_group_flights.RDS"</span>)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="co"># remove those in which only one individual called</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/processed/group_call_individual_id_sequence.csv"</span>)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="co"># # keep only 120 s duration flights call_id_seq &lt;-</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="co"># call_id_seq[call_id_seq$flight.time == 120,]</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> call_id_seq[<span class="fu">order</span>(call_id_seq<span class="sc">$</span>event, call_id_seq<span class="sc">$</span>start),</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>call_id_seq_list <span class="ot">&lt;-</span> <span class="fu">split</span>(call_id_seq, call_id_seq<span class="sc">$</span>event)</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>unique_callers_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(call_id_seq_list, <span class="cf">function</span>(x) {</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[<span class="fu">order</span>(x<span class="sc">$</span>start), ]</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> x<span class="sc">$</span>indiv</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(id_seq)))</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>    unique.callers <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(id_seq))</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> x<span class="sc">$</span>group[<span class="dv">1</span>], <span class="at">unique.callers =</span> unique.callers)</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>unique_callers_df <span class="ot">&lt;-</span> <span class="fu">do_call</span>(rbind, unique_callers_list)</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>time_calls_groups <span class="ot">&lt;-</span> call_id_seq[<span class="sc">!</span>call_id_seq<span class="sc">$</span>group <span class="sc">%in%</span> unique_callers_df<span class="sc">$</span>group[unique_callers_df<span class="sc">$</span>unique.callers <span class="sc">==</span></span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>], ]</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>time_calls_groups<span class="sc">$</span>sound.files <span class="ot">&lt;-</span> time_calls_groups<span class="sc">$</span>event</span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>obs_ovlps <span class="ot">&lt;-</span> <span class="fu">overlapping_sels</span>(time_calls_groups, <span class="at">parallel =</span> <span class="dv">10</span>)</span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>obs_ovlp_count_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(obs_ovlps<span class="sc">$</span>sound.files), <span class="cf">function</span>(x) {</span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> obs_ovlps[obs_ovlps<span class="sc">$</span>sound.files <span class="sc">==</span> x, ]</span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>    cnt <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(X<span class="sc">$</span>ovlp.sels))</span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sound.files =</span> x, <span class="at">group.size =</span> X<span class="sc">$</span>group.size[<span class="dv">1</span>],</span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> X<span class="sc">$</span>type[<span class="dv">1</span>], <span class="at">ovlp.count =</span> cnt, <span class="at">flight.time =</span> X<span class="sc">$</span>flight.time[<span class="dv">1</span>])</span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a>obs_ovlp_count_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, obs_ovlp_count_list)</span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a>obs_ovlp_count_df<span class="sc">$</span>ovlp.count <span class="ot">&lt;-</span> obs_ovlp_count_df<span class="sc">$</span>ovlp.count<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a>obs_ovlp_count_df<span class="sc">$</span>ovlp.rate <span class="ot">&lt;-</span> obs_ovlp_count_df<span class="sc">$</span>ovlp.count<span class="sc">/</span>obs_ovlp_count_df<span class="sc">$</span>flight.time</span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot with histogram of # of overlapping sounds by group size</span></span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(obs_ovlp_count_df, <span class="fu">aes</span>(<span class="at">x =</span> ovlp.rate, <span class="at">fill =</span> <span class="fu">factor</span>(group.size))) <span class="sc">+</span></span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of overlaps"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>group.size)</span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a>sim_ovlp_count_df<span class="sc">$</span>simulation <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a>total_count_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim_ovlp_count_df, obs_ovlp_count_df)</span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a>total_count_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Regular"</span>, <span class="st">"Natural"</span>, total_count_df<span class="sc">$</span>type)</span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-71"><a href="#cb74-71" aria-hidden="true" tabindex="-1"></a>total_count_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(total_count_df<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Natural"</span>,</span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Artificial"</span>, <span class="st">"Simulated"</span>))</span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(total_count_df, <span class="st">"./data/processed/total_ovlp_count.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>total_count_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/total_ovlp_count.RDS"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to overlaps per minute</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>total_count_df<span class="sc">$</span>ovlp.rate <span class="ot">&lt;-</span> total_count_df<span class="sc">$</span>ovlp.rate <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_count_df, <span class="fu">aes</span>(<span class="at">x =</span> ovlp.rate, <span class="at">fill =</span> <span class="fu">factor</span>(type))) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">adjust =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of overlaps"</span>,</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">fill =</span> <span class="st">"Group type"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>group.size,</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>agg_cnt <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(ovlp.rate <span class="sc">~</span> group.size <span class="sc">+</span> type, <span class="at">data =</span> total_count_df,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> mean)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>agg_cnt<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(ovlp.rate <span class="sc">~</span> group.size <span class="sc">+</span> type, <span class="at">data =</span> total_count_df,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> sd)<span class="sc">$</span>ovlp.rate</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># table(call_rate_by_group$group.size, call_rate_by_group$type)</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> graph_cols[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cols) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"Natural"</span>, <span class="st">"Artificial"</span>, <span class="st">"Simulated"</span>), <span class="st">"group"</span>)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>agg_cnt<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">paste</span>(agg_cnt<span class="sc">$</span>type, <span class="st">"group"</span>)</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>agg_cnt<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(agg_cnt<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Natural group"</span>, <span class="st">"Artificial group"</span>,</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Simulated group"</span>))</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="co"># convert previous graph in a point sd graph with number of</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="co"># overlaps in y and group size as factor in x</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>gg_overlap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agg_cnt, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(group.size), <span class="at">y =</span> ovlp.rate,</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> type)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>),</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ovlp.rate <span class="sc">-</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>    sd, <span class="at">ymax =</span> ovlp.rate <span class="sc">+</span> sd), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>),</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols) <span class="sc">+</span></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Group size"</span>, <span class="at">y =</span> <span class="st">"Overlaps / min"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"inside"</span>,</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
â„¹ Please use `linewidth` instead.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>gg_overlap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(gg_rate_indiv_pimp <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>, <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    ggrate_indv_grp_pimp <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()), gg_overlap <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"inside"</span>, <span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.7</span>)), <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="st">"AUTO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values or values outside the scale range
(`stat_slabinterval()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_half_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_signif()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_half_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 26 rows containing missing values or values outside the scale range
(`stat_slabinterval()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 26 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 26 rows containing non-finite outside the scale range
(`stat_half_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 26 rows containing non-finite outside the scale range
(`stat_signif()`).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>hedFont <span class="ot">&lt;-</span> <span class="st">"Arial"</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> pg <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">family =</span> hedFont,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>pg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave( './output/vocal_coordination_3_panels.png', pg,</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># grDevices::png, width = 6, height = 8, dpi = 300 )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># observed data</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>obs_ovlp_count_df <span class="ot">&lt;-</span> total_count_df[total_count_df<span class="sc">$</span>type <span class="sc">!=</span> <span class="st">"Simulated"</span>, ]</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>sim_ovlp_count_df<span class="sc">$</span>simulation <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">strsplit</span>(sim_ovlp_count_df<span class="sc">$</span>sound.files, <span class="st">"-"</span>), <span class="st">"["</span>, <span class="dv">3</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="co"># split by simulation</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>sim_ovlp_count_list <span class="ot">&lt;-</span> <span class="fu">split</span>(sim_ovlp_count_df, sim_ovlp_count_df<span class="sc">$</span>simulation)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>sim_ovlp_count_list <span class="ot">&lt;-</span> <span class="fu">sample</span>(sim_ovlp_count_list, <span class="dv">30</span>)</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="co">#combined each simulated data with the observed data</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>sim_call_groups_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sim_ovlp_count_list, <span class="cf">function</span>(x){</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span>simulation <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">rbind</span>(obs_ovlp_count_df, x)</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>ovlp.count <span class="ot">&lt;-</span> out<span class="sc">$</span>ovlp.count <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>group.size.sc <span class="ot">&lt;-</span> <span class="fu">scale</span>(out<span class="sc">$</span>group.size, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>) </span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Regular"</span>, <span class="st">"Natural"</span>, out<span class="sc">$</span>type)</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>  out<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(out<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Natural"</span>, <span class="st">"Artificial"</span>, <span class="st">"Simulated"</span>))</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>group_call_mod <span class="ot">&lt;-</span> <span class="fu">brm_multiple</span>(</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> ovlp.count <span class="sc">~</span> type <span class="sc">+</span> group.size <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(flight.time)),</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> iter,</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sim_call_groups_list,</span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_inflated_poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> chains,</span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># only works if cmdstanr package is installed</span></span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">threads =</span> <span class="fu">threading</span>(<span class="dv">2</span>),</span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> chains,</span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">combine =</span> <span class="cn">FALSE</span>,</span>
<span id="cb92-37"><a href="#cb92-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>)</span>
<span id="cb92-38"><a href="#cb92-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-39"><a href="#cb92-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-40"><a href="#cb92-40" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> group_call_mod[[<span class="dv">1</span>]], <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb92-41"><a href="#cb92-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-42"><a href="#cb92-42" aria-hidden="true" tabindex="-1"></a>group_call_mod <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(group_call_mod,  <span class="cf">function</span>(x) <span class="fu">add_criterion</span>(x, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>)))</span>
<span id="cb92-43"><a href="#cb92-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-44"><a href="#cb92-44" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(group_call_mod,</span>
<span id="cb92-45"><a href="#cb92-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">"./data/processed/simulated_group_call_model.RDS"</span>)</span>
<span id="cb92-46"><a href="#cb92-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-47"><a href="#cb92-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-48"><a href="#cb92-48" aria-hidden="true" tabindex="-1"></a>null_group_call_mod <span class="ot">&lt;-</span> <span class="fu">brm_multiple</span>(</span>
<span id="cb92-49"><a href="#cb92-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> ovlp.count <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> group.size <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(flight.time)),</span>
<span id="cb92-50"><a href="#cb92-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter =</span> iter,</span>
<span id="cb92-51"><a href="#cb92-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb92-52"><a href="#cb92-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sim_call_groups_list,</span>
<span id="cb92-53"><a href="#cb92-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">zero_inflated_poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb92-54"><a href="#cb92-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb92-55"><a href="#cb92-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> chains,</span>
<span id="cb92-56"><a href="#cb92-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb92-57"><a href="#cb92-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># only works if cmdstanr package is installed</span></span>
<span id="cb92-58"><a href="#cb92-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">threads =</span> <span class="fu">threading</span>(<span class="dv">2</span>),</span>
<span id="cb92-59"><a href="#cb92-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> chains,</span>
<span id="cb92-60"><a href="#cb92-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">combine =</span> <span class="cn">FALSE</span>,</span>
<span id="cb92-61"><a href="#cb92-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>)</span>
<span id="cb92-62"><a href="#cb92-62" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-63"><a href="#cb92-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-64"><a href="#cb92-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-65"><a href="#cb92-65" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> null_group_call_mod[[<span class="dv">1</span>]], <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb92-66"><a href="#cb92-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-67"><a href="#cb92-67" aria-hidden="true" tabindex="-1"></a>null_group_call_mod <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(null_group_call_mod,  <span class="cf">function</span>(x) {</span>
<span id="cb92-68"><a href="#cb92-68" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">add_criterion</span>(x, <span class="at">criterion =</span> <span class="fu">c</span>(<span class="st">"loo"</span>)), <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb92-69"><a href="#cb92-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is</span>(out, <span class="st">"try-error"</span>)) <span class="fu">return</span>(x)</span>
<span id="cb92-70"><a href="#cb92-70" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(out)</span>
<span id="cb92-71"><a href="#cb92-71" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-72"><a href="#cb92-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-73"><a href="#cb92-73" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(group_call_mod[[<span class="dv">1</span>]], null_group_call_mod[[<span class="dv">1</span>]])</span>
<span id="cb92-74"><a href="#cb92-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-75"><a href="#cb92-75" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(null_group_call_mod,</span>
<span id="cb92-76"><a href="#cb92-76" aria-hidden="true" tabindex="-1"></a>        <span class="st">"./data/processed/simulated_group_call_null_model.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results-5" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="results-5"><span class="header-section-number">3.3.1</span> Results</h3>
<section id="model-performance-vs-null-model-5" class="level4" data-number="3.3.1.1">
<h4 data-number="3.3.1.1" class="anchored" data-anchor-id="model-performance-vs-null-model-5"><span class="header-section-number">3.3.1.1</span> Model performance vs null model</h4>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>group_call_mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/simulated_group_call_model.RDS"</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>null_group_call_mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/simulated_group_call_null_model.RDS"</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>loo_diffs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(group_call_mod), <span class="cf">function</span>(x) loo<span class="sc">::</span><span class="fu">loo_compare</span>(group_call_mod[[x]],</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    null_group_call_mod[[x]]))</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>loo_diff <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, loo_diffs)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">rownames</span>(loo_diff)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>loo_diff <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(loo_diff)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>loo_diff<span class="sc">$</span>model <span class="ot">&lt;-</span> rows</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">cbind</span>(elpd_diff, se_diff) <span class="sc">~</span> model, loo_diff, mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="kable-table">
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">model</th>
<th style="text-align: right;">elpd_diff</th>
<th style="text-align: right;">se_diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">group_call_mod[[x]]</td>
<td style="text-align: right;">0.00000</td>
<td style="text-align: right;">0.00000</td>
</tr>
<tr class="even">
<td style="text-align: left;">null_group_call_mod[[x]]</td>
<td style="text-align: right;">-27.23418</td>
<td style="text-align: right;">20.58624</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="model-fit-5" class="level4" data-number="3.3.1.2">
<h4 data-number="3.3.1.2" class="anchored" data-anchor-id="model-fit-5"><span class="header-section-number">3.3.1.2</span> Model fit</h4>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># average model</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>avrg_call <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"posterior_average("</span>, <span class="fu">paste0</span>(<span class="fu">paste0</span>(<span class="st">"group_call_mod[["</span>,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(group_call_mod), <span class="st">"]]"</span>), <span class="at">collapse =</span> <span class="st">", "</span>), <span class="st">", weights = 'loo')"</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>average_model_draws <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> avrg_call))</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_extended_summary</span>(average_model_draws, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> fill_color,</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta.prefix =</span> <span class="fu">c</span>(<span class="st">"^b_"</span>, <span class="st">"^bsp_mo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
<th style="text-align:left;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_Intercept
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-6.046
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-6.747
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-5.394
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
14618.493
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
12215.200
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_typeArtificial
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-2.763
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-4.118
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-1.598
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
9360.303
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
8966.711
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_typeSimulated
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.931
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.546
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
1.375
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
13855.804
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
11095.257
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_group.size
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.465
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.359
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.576
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
13451.932
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
12438.804
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/regression%20results%20group%20call%20simulation-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="contrasts-4" class="level4" data-number="3.3.1.3">
<h4 data-number="3.3.1.3" class="anchored" data-anchor-id="contrasts-4"><span class="header-section-number">3.3.1.3</span> Contrasts</h4>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>contrasts <span class="ot">&lt;-</span> <span class="fu">draws_contrasts</span>(average_model_draws, <span class="at">predictor_name =</span> <span class="st">"type"</span>,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">basal_level =</span> <span class="st">"Natural"</span>, <span class="at">fill_color =</span> fill_color)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>contrasts<span class="sc">$</span>contrasts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">est</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">l-95% CI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">u-95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; background-color: rgba(56, 170, 172, 38) !important;">Artificial - Natural</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">2.789</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">1.598</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">4.118</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(56, 170, 172, 38) !important;">Simulated - Natural</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.938</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-1.375</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-0.546</td>
</tr>
<tr class="odd">
<td style="text-align: left; background-color: rgba(56, 170, 172, 38) !important;">Simulated - Artificial</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-3.727</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-5.053</td>
<td style="text-align: right; background-color: rgba(56, 170, 172, 38) !important;">-2.558</td>
</tr>
</tbody>
</table>
</div>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>contrasts<span class="sc">$</span>plot <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p><img src="data_analysis_files/figure-html/regresion%20contrasts%20group%20call%20simulation-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="posterior-predictive-checks-5" class="level4" data-number="3.3.1.4">
<h4 data-number="3.3.1.4" class="anchored" data-anchor-id="posterior-predictive-checks-5"><span class="header-section-number">3.3.1.4</span> Posterior predictive checks</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> group_call_mod[[<span class="dv">1</span>]], <span class="at">group =</span> <span class="st">"type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="takeaways-5" class="level4 unnumbered unlisted alert alert-info">
<h4 class="unnumbered unlisted anchored" data-anchor-id="takeaways-5">Takeaways</h4>
<ul>
<li>Simulated groups produce more overlapping calls than both artificial and natural groups</li>
<li>Artificial groups produce more overlapping calls than natural groups</li>
</ul>
</section>
</section>
</section>
<section id="gap-duration" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="gap-duration"><span class="header-section-number">3.4</span> Gap duration</h2>
<section id="gap-variation-of-individual-in-solo-flight-vs-overall-group-flight" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="gap-variation-of-individual-in-solo-flight-vs-overall-group-flight"><span class="header-section-number">3.4.1</span> Gap variation of individual in solo flight vs overall group flight</h3>
<p>Variation measured as the coefficient of variation of gap duration</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>gaps_indiv <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/gaps_by_individual.RDS"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove those in which only one individual called</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/processed/group_call_individual_id_sequence.csv"</span>)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> call_id_seq[<span class="fu">order</span>(call_id_seq<span class="sc">$</span>event, call_id_seq<span class="sc">$</span>start),</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>call_id_seq_list <span class="ot">&lt;-</span> <span class="fu">split</span>(call_id_seq, call_id_seq<span class="sc">$</span>event)</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>unique_callers_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(call_id_seq_list, <span class="cf">function</span>(x) {</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[<span class="fu">order</span>(x<span class="sc">$</span>start), ]</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> x<span class="sc">$</span>indiv</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(id_seq)))</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>    unique.callers <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(id_seq))</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> x<span class="sc">$</span>group[<span class="dv">1</span>], <span class="at">unique.callers =</span> unique.callers)</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>unique_callers_df <span class="ot">&lt;-</span> <span class="fu">do_call</span>(rbind, unique_callers_list)</span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>gaps_indiv <span class="ot">&lt;-</span> gaps_indiv[<span class="sc">!</span>gaps_indiv<span class="sc">$</span>group <span class="sc">%in%</span> unique_callers_df<span class="sc">$</span>group[unique_callers_df<span class="sc">$</span>unique.callers <span class="sc">==</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>], ]</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv <span class="ot">&lt;-</span> gaps_indiv[<span class="fu">grep</span>(<span class="st">"indiv.group"</span>, gaps_indiv<span class="sc">$</span>experiment.type,</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">invert =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>experiment.type[sub_gaps_indiv<span class="sc">$</span>experiment.type <span class="sc">==</span> <span class="st">"mixed-overall.group"</span>] <span class="ot">&lt;-</span> <span class="st">"artificial.group"</span></span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>experiment.type[sub_gaps_indiv<span class="sc">$</span>experiment.type <span class="sc">==</span> <span class="st">"regular-overall.group"</span>] <span class="ot">&lt;-</span> <span class="st">"real.group"</span></span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>type <span class="ot">&lt;-</span> sub_gaps_indiv<span class="sc">$</span>experiment.type</span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(sub_gaps_indiv<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"solo"</span>,</span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"real.group"</span>, <span class="st">"artificial.group"</span>))</span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>group.size.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(sub_gaps_indiv<span class="sc">$</span>group.size, <span class="at">levels =</span> <span class="fu">unique</span>(sub_gaps_indiv<span class="sc">$</span>group.size),</span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>cv_gaps_groups <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gaps <span class="sc">~</span> experiment.type <span class="sc">+</span> group.size <span class="sc">+</span></span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a>    group, <span class="at">data =</span> sub_gaps_indiv, <span class="at">FUN =</span> cv)</span>
<span id="cb98-40"><a href="#cb98-40" aria-hidden="true" tabindex="-1"></a>cv_gaps_groups<span class="sc">$</span>indiv <span class="ot">&lt;-</span> <span class="st">"group"</span></span>
<span id="cb98-41"><a href="#cb98-41" aria-hidden="true" tabindex="-1"></a>cv_gaps_groups <span class="ot">&lt;-</span> cv_gaps_groups[cv_gaps_groups<span class="sc">$</span>experiment.type <span class="sc">!=</span></span>
<span id="cb98-42"><a href="#cb98-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">"solo"</span>, ]</span>
<span id="cb98-43"><a href="#cb98-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-44"><a href="#cb98-44" aria-hidden="true" tabindex="-1"></a>cv_gaps_indiv <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gaps <span class="sc">~</span> indiv <span class="sc">+</span> experiment.type <span class="sc">+</span> group.size <span class="sc">+</span></span>
<span id="cb98-45"><a href="#cb98-45" aria-hidden="true" tabindex="-1"></a>    group, <span class="at">data =</span> sub_gaps_indiv, <span class="at">FUN =</span> cv)</span>
<span id="cb98-46"><a href="#cb98-46" aria-hidden="true" tabindex="-1"></a>cv_gaps_indiv <span class="ot">&lt;-</span> cv_gaps_indiv[cv_gaps_indiv<span class="sc">$</span>experiment.type <span class="sc">==</span> <span class="st">"solo"</span>,</span>
<span id="cb98-47"><a href="#cb98-47" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb98-48"><a href="#cb98-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-49"><a href="#cb98-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-50"><a href="#cb98-50" aria-hidden="true" tabindex="-1"></a><span class="co"># duplicate individuals in artificial group flights</span></span>
<span id="cb98-51"><a href="#cb98-51" aria-hidden="true" tabindex="-1"></a>dup_indivs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(cv_gaps_groups<span class="sc">$</span>group), <span class="cf">function</span>(x) {</span>
<span id="cb98-52"><a href="#cb98-52" aria-hidden="true" tabindex="-1"></a>    ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(gaps_indiv<span class="sc">$</span>indiv[gaps_indiv<span class="sc">$</span>group <span class="sc">==</span> x])</span>
<span id="cb98-53"><a href="#cb98-53" aria-hidden="true" tabindex="-1"></a>    ids <span class="ot">&lt;-</span> ids[ids <span class="sc">!=</span> <span class="st">"group"</span>]</span>
<span id="cb98-54"><a href="#cb98-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-55"><a href="#cb98-55" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> cv_gaps_indiv[cv_gaps_indiv<span class="sc">$</span>indiv <span class="sc">%in%</span> ids, ]</span>
<span id="cb98-56"><a href="#cb98-56" aria-hidden="true" tabindex="-1"></a>    X<span class="sc">$</span>group <span class="ot">&lt;-</span> x</span>
<span id="cb98-57"><a href="#cb98-57" aria-hidden="true" tabindex="-1"></a>    X<span class="sc">$</span>group.size <span class="ot">&lt;-</span> gaps_indiv<span class="sc">$</span>group.size[gaps_indiv<span class="sc">$</span>group <span class="sc">==</span> x][<span class="dv">1</span>]</span>
<span id="cb98-58"><a href="#cb98-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(X)</span>
<span id="cb98-59"><a href="#cb98-59" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb98-60"><a href="#cb98-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-61"><a href="#cb98-61" aria-hidden="true" tabindex="-1"></a>dup_indivs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, dup_indivs)</span>
<span id="cb98-62"><a href="#cb98-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-63"><a href="#cb98-63" aria-hidden="true" tabindex="-1"></a>cv_gaps <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dup_indivs, cv_gaps_groups)</span>
<span id="cb98-64"><a href="#cb98-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-65"><a href="#cb98-65" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cv_gaps)[<span class="fu">ncol</span>(cv_gaps)] <span class="ot">&lt;-</span> <span class="st">"cv.gaps"</span></span>
<span id="cb98-66"><a href="#cb98-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-67"><a href="#cb98-67" aria-hidden="true" tabindex="-1"></a>cv_gaps<span class="sc">$</span>group.size.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(cv_gaps<span class="sc">$</span>group.size, <span class="at">levels =</span> <span class="fu">unique</span>(cv_gaps<span class="sc">$</span>group.size),</span>
<span id="cb98-68"><a href="#cb98-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb98-69"><a href="#cb98-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-70"><a href="#cb98-70" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cv_gaps)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"type"</span></span>
<span id="cb98-71"><a href="#cb98-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-72"><a href="#cb98-72" aria-hidden="true" tabindex="-1"></a>cv_gaps<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(cv_gaps<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"solo"</span>, <span class="st">"real.group"</span>,</span>
<span id="cb98-73"><a href="#cb98-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">"artificial.group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-raw-data-5" class="level4" data-number="3.4.1.1">
<h4 data-number="3.4.1.1" class="anchored" data-anchor-id="plot-raw-data-5"><span class="header-section-number">3.4.1.1</span> Plot raw data</h4>
<p>All group sizes combined:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span> <span class="fu">unique</span>(sub_gaps_indiv<span class="sc">$</span>group.size.f)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>custom_labels <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"group size = "</span>, custom_labels)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(custom_labels) <span class="ot">&lt;-</span> <span class="fu">unique</span>(sub_gaps_indiv<span class="sc">$</span>group.size.f)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cv_gaps, </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">log</span>(cv.gaps <span class="sc">+</span> <span class="dv">1</span>), </span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> type,</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 60)) +</span></span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a>           <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Solo"</span>,</span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">"real.group"</span> <span class="ot">=</span> <span class="st">"Natural group"</span>,</span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Artificial group"</span></span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"log(coefficient of variation</span><span class="sc">\n</span><span class="st">of gap duration)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>By group size:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cv_gaps, </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">log</span>(cv.gaps <span class="sc">+</span> <span class="dv">1</span>), </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> type,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb100-38"><a href="#cb100-38" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb100-39"><a href="#cb100-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb100-40"><a href="#cb100-40" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 60)) +</span></span>
<span id="cb100-41"><a href="#cb100-41" aria-hidden="true" tabindex="-1"></a>           <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb100-42"><a href="#cb100-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Solo"</span>,</span>
<span id="cb100-43"><a href="#cb100-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"real.group"</span> <span class="ot">=</span> <span class="st">"Natural group"</span>,</span>
<span id="cb100-44"><a href="#cb100-44" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Artificial group"</span></span>
<span id="cb100-45"><a href="#cb100-45" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb100-46"><a href="#cb100-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb100-47"><a href="#cb100-47" aria-hidden="true" tabindex="-1"></a>         <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"log(coefficient of variation</span><span class="sc">\n</span><span class="st">of gap duration)"</span>) <span class="sc">+</span></span>
<span id="cb100-48"><a href="#cb100-48" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(</span>
<span id="cb100-49"><a href="#cb100-49" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> group.size,</span>
<span id="cb100-50"><a href="#cb100-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb100-51"><a href="#cb100-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group.size =</span> custom_labels)</span>
<span id="cb100-52"><a href="#cb100-52" aria-hidden="true" tabindex="-1"></a>      ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regression-model-5" class="level4" data-number="3.4.1.2">
<h4 data-number="3.4.1.2" class="anchored" data-anchor-id="regression-model-5"><span class="header-section-number">3.4.1.2</span> Regression model</h4>
<p><span class="math display">\[
\text{log(gap variation + 1)} \sim \text{type} + \text{monotonic(group size)} + (1 \mid \text{group})
\]</span></p>
<p>Response modeled with an normal distribution.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> <span class="fu">log</span>(cv.gaps <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> type <span class="sc">+</span> <span class="fu">mo</span>(group.size.f) <span class="sc">+</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> group), <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> cv_gaps, <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains, <span class="at">file =</span> <span class="st">"./data/processed/cv_gaps_solo_vs_group"</span>,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_refit =</span> <span class="st">"always"</span>)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> <span class="fu">log</span>(cv.gaps <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> group), <span class="at">iter =</span> iter,</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> cv_gaps, <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains,</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cores =</span> chains, <span class="at">file =</span> <span class="st">"./data/processed/null_cv_gaps_solo_vs_group"</span>,</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">file_refit =</span> <span class="st">"always"</span>)</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(null_mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>beepr<span class="sc">::</span><span class="fu">beep</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results-6" class="level5" data-number="3.4.1.2.1">
<h5 data-number="3.4.1.2.1" class="anchored" data-anchor-id="results-6"><span class="header-section-number">3.4.1.2.1</span> Results</h5>
<section id="model-performance-vs-null-model-6" class="level6" data-number="3.4.1.2.1.1">
<h6 data-number="3.4.1.2.1.1" class="anchored" data-anchor-id="model-performance-vs-null-model-6"><span class="header-section-number">3.4.1.2.1.1</span> Model performance vs null model</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/cv_gaps_solo_vs_group.rds"</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/null_cv_gaps_solo_vs_group.rds"</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(mod, null_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         elpd_diff se_diff
mod        0.0       0.0  
null_mod -12.2       4.9  </code></pre>
</div>
</div>
</section>
<section id="model-fit-6" class="level6" data-number="3.4.1.2.1.2">
<h6 data-number="3.4.1.2.1.2" class="anchored" data-anchor-id="model-fit-6"><span class="header-section-number">3.4.1.2.1.2</span> Model fit</h6>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extended_summary</span>(<span class="at">fit =</span> mod, <span class="at">gsub.pattern =</span> <span class="st">"type"</span>, <span class="at">gsub.replacement =</span> <span class="st">"solo_vs_"</span>,</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">remove.intercepts =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">print.name =</span> <span class="cn">FALSE</span>,</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> fill_color, <span class="at">trace.palette =</span> viridis<span class="sc">::</span>mako, <span class="at">beta.prefix =</span> <span class="fu">c</span>(<span class="st">"^b_"</span>,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"^bsp_mo"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
priors
</th>
<th style="text-align:left;">
formula
</th>
<th style="text-align:right;">
iterations
</th>
<th style="text-align:right;">
chains
</th>
<th style="text-align:right;">
thinning
</th>
<th style="text-align:right;">
warmup
</th>
<th style="text-align:left;">
diverg_transitions
</th>
<th style="text-align:left;">
rhats &gt; 1.05
</th>
<th style="text-align:right;">
min_bulk_ESS
</th>
<th style="text-align:right;">
min_tail_ESS
</th>
<th style="text-align:left;">
seed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Intercept-student_t(3, 4.2, 2.5) sd-student_t(3, 0, 2.5) sigma-student_t(3, 0, 2.5) simo-dirichlet(1)
</td>
<td style="text-align:left;">
log(cv.gaps + 1) ~ type + mo(group.size.f) + (1 | group)
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5000
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: red !important;font-size: 12px;">1 (5e-05%)</span>
</td>
<td style="text-align:left;">
<span style="     ">0</span>
</td>
<td style="text-align:right;">
11914.22
</td>
<td style="text-align:right;">
11792.06
</td>
<td style="text-align:left;">
1479252149
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
<th style="text-align:left;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_solo_vs_real.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.340
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.196
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.485
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
24349.40
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
14520.99
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_solo_vs_artificial.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.251
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.115
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.386
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
25461.90
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
15330.95
</td>
</tr>
<tr>
<td style="text-align:left;">
bsp_mogroup.size.f
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
-0.023
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:left;">
<span style="     ">1.001</span>
</td>
<td style="text-align:right;">
11914.22
</td>
<td style="text-align:right;">
11792.06
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/gaps%20per%20group%20solo%20vs%20group%20results%202-1.png" class="img-fluid" width="1152"></p>
</section>
</section>
<section id="contrasts-5" class="level5" data-number="3.4.1.2.2">
<h5 data-number="3.4.1.2.2" class="anchored" data-anchor-id="contrasts-5"><span class="header-section-number">3.4.1.2.2</span> Contrasts</h5>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(<span class="at">fit =</span> mod, <span class="at">predictor =</span> <span class="st">"type"</span>, <span class="at">n.posterior =</span> <span class="dv">2000</span>, <span class="at">level.sep =</span> <span class="st">" VS "</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">html.table =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> fill_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Contrasts
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Est.Error
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
1
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
solo VS real.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.340
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.074
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.196
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.485
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
2
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
solo VS artificial.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.251
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.069
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.115
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.386
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
real.group VS artificial.group
</td>
<td style="text-align:right;">
0.089
</td>
<td style="text-align:right;">
0.097
</td>
<td style="text-align:right;">
-0.102
</td>
<td style="text-align:right;">
0.275
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/gaps%20per%20group%20solo%20vs%20group%20results%20contrasts%202-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="posterior-predictive-checks-6" class="level5" data-number="3.4.1.2.3">
<h5 data-number="3.4.1.2.3" class="anchored" data-anchor-id="posterior-predictive-checks-6"><span class="header-section-number">3.4.1.2.3</span> Posterior predictive checks</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"experiment.type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="takeaways-6" class="level5 unnumbered unlisted alert alert-info">
<h5 class="unnumbered unlisted anchored" data-anchor-id="takeaways-6">Takeaways</h5>
<ul>
<li>Variation in gap duration is larger in both natural and artificial groups compared to solo flights</li>
<li>No difference in gap variation between natural and artificial groups</li>
</ul>
</section>
</section>
</section>
<section id="individual-in-solo-flight-vs-individuals-in-group-flight-1" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="individual-in-solo-flight-vs-individuals-in-group-flight-1"><span class="header-section-number">3.4.2</span> Individual in solo flight vs individuals in group flight</h3>
<section id="plot-raw-data-6" class="level4" data-number="3.4.2.1">
<h4 data-number="3.4.2.1" class="anchored" data-anchor-id="plot-raw-data-6"><span class="header-section-number">3.4.2.1</span> Plot raw data</h4>
<p>All group sizes combined:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv <span class="ot">&lt;-</span> gaps_indiv[<span class="fu">grep</span>(<span class="st">"overall.group"</span>, gaps_indiv<span class="sc">$</span>experiment.type, <span class="at">invert =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>experiment.type[sub_gaps_indiv<span class="sc">$</span>experiment.type <span class="sc">==</span> <span class="st">"mixed-indiv.group"</span>] <span class="ot">&lt;-</span> <span class="st">"artificial.group"</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>experiment.type[sub_gaps_indiv<span class="sc">$</span>experiment.type <span class="sc">==</span> <span class="st">"mixed-indiv.group"</span>] <span class="ot">&lt;-</span> <span class="st">"artificial.group"</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>experiment.type[sub_gaps_indiv<span class="sc">$</span>experiment.type <span class="sc">==</span> <span class="st">"regular-indiv.group"</span>] <span class="ot">&lt;-</span> <span class="st">"real.group"</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>type <span class="ot">&lt;-</span> sub_gaps_indiv<span class="sc">$</span>experiment.type</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(sub_gaps_indiv<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"solo"</span>, <span class="st">"real.group"</span>, <span class="st">"artificial.group"</span>)) </span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>sub_gaps_indiv<span class="sc">$</span>group.size.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(sub_gaps_indiv<span class="sc">$</span>group.size, <span class="at">levels =</span> <span class="fu">unique</span>(sub_gaps_indiv<span class="sc">$</span>group.size), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sub_gaps_indiv,</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> gaps,</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb107-45"><a href="#cb107-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb107-46"><a href="#cb107-46" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb107-50"><a href="#cb107-50" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb107-51"><a href="#cb107-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb107-52"><a href="#cb107-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb107-53"><a href="#cb107-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Type"</span>, <span class="at">y =</span> <span class="st">"Gap duration (s)"</span>) <span class="sc">+</span></span>
<span id="cb107-54"><a href="#cb107-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb107-55"><a href="#cb107-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Solo"</span>,</span>
<span id="cb107-56"><a href="#cb107-56" aria-hidden="true" tabindex="-1"></a>        <span class="st">"real.group"</span> <span class="ot">=</span> <span class="st">"Natural group"</span>,</span>
<span id="cb107-57"><a href="#cb107-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Artificial group"</span></span>
<span id="cb107-58"><a href="#cb107-58" aria-hidden="true" tabindex="-1"></a>      ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>By group size:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sub_gaps_indiv,</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> gaps,</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">40</span>)) <span class="sc">+</span></span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Type"</span>, <span class="at">y =</span> <span class="st">"Gap duration (s)"</span>) <span class="sc">+</span></span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Solo"</span>,</span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">"real.group"</span> <span class="ot">=</span> <span class="st">"Natural group"</span>,</span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Artificial group"</span></span>
<span id="cb108-48"><a href="#cb108-48" aria-hidden="true" tabindex="-1"></a>      ))  <span class="sc">+</span>  <span class="fu">facet_wrap</span>(</span>
<span id="cb108-49"><a href="#cb108-49" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> group.size,</span>
<span id="cb108-50"><a href="#cb108-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb108-51"><a href="#cb108-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group.size =</span> custom_labels)</span>
<span id="cb108-52"><a href="#cb108-52" aria-hidden="true" tabindex="-1"></a>      ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regression-model-6" class="level4" data-number="3.4.2.2">
<h4 data-number="3.4.2.2" class="anchored" data-anchor-id="regression-model-6"><span class="header-section-number">3.4.2.2</span> Regression model</h4>
<p><span class="math display">\[
\text{log(gaps + 1)} \sim \text{type} + \text{monotonic(group size)} + (1 \mid \text{group}) + (1 \mid \text{individual})
\]</span></p>
<p>Response modeled with an exponential distribution.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> <span class="fu">log</span>(gaps <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> type <span class="sc">+</span> <span class="fu">mo</span>(group.size.f) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    indiv) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> group), <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> sub_gaps_indiv,</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains,</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file_refit =</span> <span class="st">"always"</span>,</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">file =</span> <span class="st">"./data/processed/group_gaps_solo_vs_group_group_size_monot"</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(mod, <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> <span class="fu">log</span>(gaps <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> indiv) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> group),</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> sub_gaps_indiv, <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb109-14"><a href="#cb109-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb109-15"><a href="#cb109-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file_refit =</span> <span class="st">"always"</span>, <span class="at">file =</span> <span class="st">"./data/processed/null_group_gaps_solo_vs_group_group_size_monot"</span>)</span>
<span id="cb109-16"><a href="#cb109-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-17"><a href="#cb109-17" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(null_mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb109-18"><a href="#cb109-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-19"><a href="#cb109-19" aria-hidden="true" tabindex="-1"></a>beepr<span class="sc">::</span><span class="fu">beep</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results-7" class="level5" data-number="3.4.2.2.1">
<h5 data-number="3.4.2.2.1" class="anchored" data-anchor-id="results-7"><span class="header-section-number">3.4.2.2.1</span> Results</h5>
</section>
<section id="model-performance-vs-null-model-7" class="level5" data-number="3.4.2.2.2">
<h5 data-number="3.4.2.2.2" class="anchored" data-anchor-id="model-performance-vs-null-model-7"><span class="header-section-number">3.4.2.2.2</span> Model performance vs null model</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/group_gaps_solo_vs_group_group_size_monot.rds"</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/null_group_gaps_solo_vs_group_group_size_monot.rds"</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(mod, null_mod)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         elpd_diff se_diff
mod         0.0       0.0 
null_mod -165.3      24.3 </code></pre>
</div>
</div>
</section>
<section id="model-fit-7" class="level5" data-number="3.4.2.2.3">
<h5 data-number="3.4.2.2.3" class="anchored" data-anchor-id="model-fit-7"><span class="header-section-number">3.4.2.2.3</span> Model fit</h5>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extended_summary</span>(<span class="at">fit =</span> mod, <span class="at">gsub.pattern =</span> <span class="st">"type"</span>, <span class="at">gsub.replacement =</span> <span class="st">"solo_vs_"</span>,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">remove.intercepts =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">print.name =</span> <span class="cn">FALSE</span>,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace.palette =</span> viridis<span class="sc">::</span>mako, <span class="at">fill =</span> fill_color, <span class="at">beta.prefix =</span> <span class="st">"^b_|^bsp_"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
priors
</th>
<th style="text-align:left;">
formula
</th>
<th style="text-align:right;">
iterations
</th>
<th style="text-align:right;">
chains
</th>
<th style="text-align:right;">
thinning
</th>
<th style="text-align:right;">
warmup
</th>
<th style="text-align:left;">
diverg_transitions
</th>
<th style="text-align:left;">
rhats &gt; 1.05
</th>
<th style="text-align:right;">
min_bulk_ESS
</th>
<th style="text-align:right;">
min_tail_ESS
</th>
<th style="text-align:left;">
seed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Intercept-student_t(3, 1.5, 2.5) sd-student_t(3, 0, 2.5) sigma-student_t(3, 0, 2.5) simo-dirichlet(1)
</td>
<td style="text-align:left;">
log(gaps + 1) ~ type + mo(group.size.f) + (1 | indiv) + (1 | group)
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5000
</td>
<td style="text-align:left;">
<span style="     ">0 (0%)</span>
</td>
<td style="text-align:left;">
<span style="     ">0</span>
</td>
<td style="text-align:right;">
10737.22
</td>
<td style="text-align:right;">
13140.68
</td>
<td style="text-align:left;">
1431504020
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
<th style="text-align:left;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_solo_vs_real.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.421
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.368
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.472
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
32664.43
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
16783.83
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
b_solo_vs_artificial.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.488
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.407
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.569
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
<span style="     ">1</span>
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
26529.35
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
15155.39
</td>
</tr>
<tr>
<td style="text-align:left;">
bsp_mogroup.size.f
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
-0.065
</td>
<td style="text-align:right;">
0.072
</td>
<td style="text-align:left;">
<span style="     ">1</span>
</td>
<td style="text-align:right;">
10737.22
</td>
<td style="text-align:right;">
13140.68
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/gaps%20per%20group%20solo%20vs%20group%20results-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="contrasts-6" class="level5" data-number="3.4.2.2.4">
<h5 data-number="3.4.2.2.4" class="anchored" data-anchor-id="contrasts-6"><span class="header-section-number">3.4.2.2.4</span> Contrasts</h5>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(<span class="at">fit =</span> mod, <span class="at">predictor =</span> <span class="st">"type"</span>, <span class="at">n.posterior =</span> <span class="dv">2000</span>, <span class="at">level.sep =</span> <span class="st">" VS "</span>,</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">html.table =</span> <span class="cn">TRUE</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">fill =</span> fill_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Contrasts
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Est.Error
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
1
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
real.group VS solo
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.421
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.027
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.368
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.472
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
real.group VS artificial.group
</td>
<td style="text-align:right;">
-0.067
</td>
<td style="text-align:right;">
0.049
</td>
<td style="text-align:right;">
-0.163
</td>
<td style="text-align:right;">
0.027
</td>
</tr>
<tr>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
3
</td>
<td style="text-align:left;background-color: rgba(56, 170, 172, 38) !important;">
solo VS artificial.group
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.488
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
0.041
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.407
</td>
<td style="text-align:right;background-color: rgba(56, 170, 172, 38) !important;">
-0.569
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/gaps%20per%20group%20solo%20vs%20group%20results%20contrasts-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="posterior-predictive-checks-7" class="level5" data-number="3.4.2.2.5">
<h5 data-number="3.4.2.2.5" class="anchored" data-anchor-id="posterior-predictive-checks-7"><span class="header-section-number">3.4.2.2.5</span> Posterior predictive checks</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="takeaways-7" class="level3 unnumbered unlisted alert alert-info">
<h3 class="unnumbered unlisted anchored" data-anchor-id="takeaways-7">Takeaways</h3>
<ul>
<li>Individual gaps are longer in both natural and artificial groups than in solo flights</li>
<li>No difference in gap duration between natural and artificial groups</li>
<li>Group size does not affects gap duration</li>
</ul>
</section>
</section>
<section id="group-calling-sequence-predictability" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="group-calling-sequence-predictability"><span class="header-section-number">3.5</span> Group calling sequence predictability</h2>
<ul>
<li>Measure as the entropy of transition probabilities of the individual ID in a first order markov chain model</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/processed/group_call_individual_id_sequence.csv"</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> call_id_seq[<span class="fu">order</span>(call_id_seq<span class="sc">$</span>event, call_id_seq<span class="sc">$</span>start),</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>call_id_seq_list <span class="ot">&lt;-</span> <span class="fu">split</span>(call_id_seq, call_id_seq<span class="sc">$</span>event)</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co"># get diversity and entropy</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>entropy_data_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(call_id_seq_list, <span class="cf">function</span>(x) {</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[<span class="fu">order</span>(x<span class="sc">$</span>start), ]</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> x<span class="sc">$</span>indiv</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(id_seq)))</span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>    unique.callers <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(id_seq))</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>    id_seq <span class="ot">&lt;-</span> <span class="fu">paste</span>(id_seq, <span class="at">collapse =</span> <span class="st">""</span>)</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>    entrp <span class="ot">&lt;-</span> <span class="fu">entropy</span>(id_seq)</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>    norm.entrp <span class="ot">&lt;-</span> <span class="fu">normalized_entropy</span>(id_seq)</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>    markov.entropy <span class="ot">&lt;-</span> <span class="fu">markov_entropy</span>(id_seq, <span class="at">normalize =</span> <span class="cn">FALSE</span>)</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>    norm.markov.entropy <span class="ot">&lt;-</span> <span class="fu">markov_entropy</span>(id_seq, <span class="at">normalize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">event =</span> x<span class="sc">$</span>event[<span class="dv">1</span>], <span class="at">group =</span> x<span class="sc">$</span>group[<span class="dv">1</span>], <span class="at">group.size =</span> x<span class="sc">$</span>group.size[<span class="dv">1</span>],</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">experiment =</span> x<span class="sc">$</span>experiment[<span class="dv">1</span>], <span class="at">sequence =</span> id_seq, <span class="at">entropy =</span> entrp,</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">normalized.entropy =</span> norm.entrp, <span class="at">unique.callers =</span> unique.callers,</span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">prop.callers =</span> unique.callers<span class="sc">/</span>x<span class="sc">$</span>group.size[<span class="dv">1</span>], <span class="at">markov.entropy =</span> markov.entropy,</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">norm.markov.entropy =</span> norm.markov.entropy)</span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(out)</span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>seq_entropy_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, entropy_data_list)</span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>seq_entropy_data<span class="sc">$</span>prop.callers[seq_entropy_data<span class="sc">$</span>prop.callers <span class="sc">&gt;=</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.99999</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a><span class="co"># remove those in which only 1 individual called</span></span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>seq_entropy_data <span class="ot">&lt;-</span> seq_entropy_data[seq_entropy_data<span class="sc">$</span>unique.callers <span class="sc">&gt;</span></span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, ]</span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a><span class="co"># cor(seq_entropy_data[, c('entropy', 'normalized.entropy',</span></span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 'unique.callers', 'markov.entropy', 'norm.markov.entropy')],</span></span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a><span class="co"># use = 'pairwise.complete.obs')</span></span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>seq_entropy_data<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(seq_entropy_data<span class="sc">$</span>experiment <span class="sc">==</span> <span class="st">"Regular"</span>,</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Natural"</span>, <span class="st">"Artificial"</span>)</span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a>seq_entropy_data<span class="sc">$</span>group.size.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(seq_entropy_data<span class="sc">$</span>group.size,</span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">unique</span>(seq_entropy_data<span class="sc">$</span>group.size), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plot-raw-data-7" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="plot-raw-data-7"><span class="header-section-number">3.5.1</span> Plot raw data</h3>
<p>All groups combined:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seq_entropy_data,</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> norm.markov.entropy,</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a>      <span class="co">#      scale_x_discrete(labels = c(</span></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "natural" = "Natural",</span></span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "artificial" = "Artificial",</span></span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "simulated" = "Simulated"</span></span>
<span id="cb116-46"><a href="#cb116-46" aria-hidden="true" tabindex="-1"></a>      <span class="co"># )) +</span></span>
<span id="cb116-47"><a href="#cb116-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb116-48"><a href="#cb116-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Normalized markov</span><span class="sc">\n</span><span class="st">transitions entropy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>By group size:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seq_entropy_data[seq_entropy_data<span class="sc">$</span>group.size <span class="sc">&lt;</span> <span class="dv">6</span>, ],</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> norm.markov.entropy,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb117-32"><a href="#cb117-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb117-33"><a href="#cb117-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb117-34"><a href="#cb117-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb117-35"><a href="#cb117-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb117-36"><a href="#cb117-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb117-37"><a href="#cb117-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb117-38"><a href="#cb117-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb117-39"><a href="#cb117-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb117-40"><a href="#cb117-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb117-41"><a href="#cb117-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb117-42"><a href="#cb117-42" aria-hidden="true" tabindex="-1"></a>      <span class="co">#      scale_x_discrete(labels = c(</span></span>
<span id="cb117-43"><a href="#cb117-43" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "natural" = "Natural",</span></span>
<span id="cb117-44"><a href="#cb117-44" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "artificial" = "Artificial",</span></span>
<span id="cb117-45"><a href="#cb117-45" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "simulated" = "Simulated"</span></span>
<span id="cb117-46"><a href="#cb117-46" aria-hidden="true" tabindex="-1"></a>      <span class="co"># )) +</span></span>
<span id="cb117-47"><a href="#cb117-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb117-48"><a href="#cb117-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(</span>
<span id="cb117-49"><a href="#cb117-49" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> group.size,</span>
<span id="cb117-50"><a href="#cb117-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb117-51"><a href="#cb117-51" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb117-52"><a href="#cb117-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Normalized markov</span><span class="sc">\n</span><span class="st">transitions entropy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regression-model-7" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="regression-model-7"><span class="header-section-number">3.5.2</span> Regression model</h3>
<p>Model:</p>
<p><span class="math display">\[
\text{normalize markov transition entropy} \sim \text{type}
\]</span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> norm.markov.entropy <span class="sc">~</span> type, <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> seq_entropy_data, <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(), <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> chains, <span class="at">cores =</span> chains, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file_refit =</span> <span class="st">"always"</span>, <span class="at">file =</span> <span class="st">"./data/processed/entropy_by_experiment_type_group_size_monot"</span>)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(mod, <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> norm.markov.entropy <span class="sc">~</span> <span class="dv">1</span>, <span class="at">iter =</span> iter, <span class="at">thin =</span> <span class="dv">1</span>,</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> seq_entropy_data, <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(), <span class="at">silent =</span> <span class="dv">2</span>,</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">chains =</span> chains, <span class="at">cores =</span> chains, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file_refit =</span> <span class="st">"always"</span>, <span class="at">file =</span> <span class="st">"./data/processed/null_model_entropy_by_experiment_type_group_size_monot"</span>)</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(null_mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results-8" class="level4" data-number="3.5.2.1">
<h4 data-number="3.5.2.1" class="anchored" data-anchor-id="results-8"><span class="header-section-number">3.5.2.1</span> Results</h4>
<section id="model-performance-vs-null-model-8" class="level5" data-number="3.5.2.1.1">
<h5 data-number="3.5.2.1.1" class="anchored" data-anchor-id="model-performance-vs-null-model-8"><span class="header-section-number">3.5.2.1.1</span> Model performance vs null model</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/entropy_by_experiment_type_group_size_monot.rds"</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/null_model_entropy_by_experiment_type_group_size_monot.rds"</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(mod, null_mod)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         elpd_diff se_diff
null_mod  0.0       0.0   
mod      -0.6       0.9   </code></pre>
</div>
</div>
</section>
<section id="model-fit-8" class="level5" data-number="3.5.2.1.2">
<h5 data-number="3.5.2.1.2" class="anchored" data-anchor-id="model-fit-8"><span class="header-section-number">3.5.2.1.2</span> Model fit</h5>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extended_summary</span>(<span class="at">fit =</span> mod, <span class="at">gsub.pattern =</span> <span class="st">"b_type"</span>, <span class="at">gsub.replacement =</span> <span class="st">"Aritificial_vs_"</span>,</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">remove.intercepts =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">print.name =</span> <span class="cn">FALSE</span>,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace.palette =</span> viridis<span class="sc">::</span>mako, <span class="at">fill =</span> fill_color, <span class="at">beta.prefix =</span> <span class="st">"^b_|^bsp_"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
priors
</th>
<th style="text-align:left;">
formula
</th>
<th style="text-align:right;">
iterations
</th>
<th style="text-align:right;">
chains
</th>
<th style="text-align:right;">
thinning
</th>
<th style="text-align:right;">
warmup
</th>
<th style="text-align:left;">
diverg_transitions
</th>
<th style="text-align:left;">
rhats &gt; 1.05
</th>
<th style="text-align:right;">
min_bulk_ESS
</th>
<th style="text-align:right;">
min_tail_ESS
</th>
<th style="text-align:left;">
seed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
coi-beta(1, 1) Intercept-student_t(3, 0, 2.5) phi-gamma(0.01, 0.01) zoi-beta(1, 1)
</td>
<td style="text-align:left;">
norm.markov.entropy ~ type
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5000
</td>
<td style="text-align:left;">
<span style="     ">0 (0%)</span>
</td>
<td style="text-align:left;">
<span style="     ">0</span>
</td>
<td style="text-align:right;">
17934.94
</td>
<td style="text-align:right;">
13326.27
</td>
<td style="text-align:left;">
1241459851
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
<th style="text-align:left;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Aritificial_vs_Natural
</td>
<td style="text-align:right;">
0.209
</td>
<td style="text-align:right;">
-0.253
</td>
<td style="text-align:right;">
0.675
</td>
<td style="text-align:left;">
<span style="     ">1</span>
</td>
<td style="text-align:right;">
17934.94
</td>
<td style="text-align:right;">
13326.27
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="posterior-predictive-checks-8" class="level5" data-number="3.5.2.1.3">
<h5 data-number="3.5.2.1.3" class="anchored" data-anchor-id="posterior-predictive-checks-8"><span class="header-section-number">3.5.2.1.3</span> Posterior predictive checks</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="takeaways-8" class="level3 unnumbered unlisted alert alert-info">
<h3 class="unnumbered unlisted anchored" data-anchor-id="takeaways-8">Takeaways</h3>
<ul>
<li>No difference in predictability between natural and artificial groups</li>
</ul>
</section>
</section>
<section id="number-of-calling-individuals-per-experiment" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="number-of-calling-individuals-per-experiment"><span class="header-section-number">3.6</span> Number of calling individuals per experiment</h2>
<section id="plot-raw-data-8" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="plot-raw-data-8"><span class="header-section-number">3.6.1</span> Plot raw data</h3>
<p>All groups combined:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seq_entropy_data,</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> prop.callers,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true" tabindex="-1"></a>      <span class="co">#      scale_x_discrete(labels = c(</span></span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "natural" = "Natural",</span></span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "artificial" = "Artificial",</span></span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "simulated" = "Simulated"</span></span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true" tabindex="-1"></a>      <span class="co"># )) +</span></span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Proportion of unique callers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in bandwidth_dpi(): Bandwidth calculation failed.
â†’ Falling back to `bandwidth_nrd0()`.
â„¹ This often occurs when a sample contains many duplicates, which suggests that
  a dotplot (e.g., `geom_dots()`) or histogram (e.g., `density_histogram()`,
  `stat_slab(density = 'histogram')`, or `stat_histinterval()`) may better
  represent the data.
Caused by error in `bw.SJ()`:
! sample is too sparse to find TD</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>By group size:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seq_entropy_data[seq_entropy_data<span class="sc">$</span>group.size <span class="sc">&lt;</span> <span class="dv">6</span>, ],</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> prop.callers,</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a>      <span class="co">#      scale_x_discrete(labels = c(</span></span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "natural" = "Natural",</span></span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "artificial" = "Artificial",</span></span>
<span id="cb125-45"><a href="#cb125-45" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "simulated" = "Simulated"</span></span>
<span id="cb125-46"><a href="#cb125-46" aria-hidden="true" tabindex="-1"></a>      <span class="co"># )) +</span></span>
<span id="cb125-47"><a href="#cb125-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb125-48"><a href="#cb125-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(</span>
<span id="cb125-49"><a href="#cb125-49" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> group.size,</span>
<span id="cb125-50"><a href="#cb125-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb125-51"><a href="#cb125-51" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb125-52"><a href="#cb125-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Proporiton of unique callers"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regression-model-8" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="regression-model-8"><span class="header-section-number">3.6.2</span> Regression model</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> prop.callers <span class="sc">~</span> type <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> group.size.f), <span class="at">iter =</span> iter,</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> seq_entropy_data, <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file_refit =</span> <span class="st">"always"</span>, <span class="at">file =</span> <span class="st">"./data/processed/unique.callers_by_experiment_type_group_size_monot"</span>)</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(mod, <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">brm</span>(<span class="at">formula =</span> prop.callers <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> group.size.f), <span class="at">iter =</span> iter,</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">thin =</span> <span class="dv">1</span>, <span class="at">data =</span> seq_entropy_data, <span class="at">family =</span> <span class="fu">zero_one_inflated_beta</span>(),</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">silent =</span> <span class="dv">2</span>, <span class="at">chains =</span> chains, <span class="at">cores =</span> chains, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>,</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_treedepth =</span> <span class="dv">15</span>), <span class="at">file_refit =</span> <span class="st">"always"</span>, <span class="at">file =</span> <span class="st">"./data/processed/null_model_unique.callers_by_experiment_type_group_size_monot"</span>)</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">add_criterion</span>(null_mod, <span class="at">criterion =</span> <span class="st">"loo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="results-9" class="level4" data-number="3.6.2.1">
<h4 data-number="3.6.2.1" class="anchored" data-anchor-id="results-9"><span class="header-section-number">3.6.2.1</span> Results</h4>
<section id="model-performance-vs-null-model-9" class="level5" data-number="3.6.2.1.1">
<h5 data-number="3.6.2.1.1" class="anchored" data-anchor-id="model-performance-vs-null-model-9"><span class="header-section-number">3.6.2.1.1</span> Model performance vs null model</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/unique.callers_by_experiment_type_group_size_monot.rds"</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>null_mod <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/null_model_unique.callers_by_experiment_type_group_size_monot.rds"</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">loo_compare</span>(mod, null_mod)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         elpd_diff se_diff
null_mod  0.0       0.0   
mod      -0.4       0.7   </code></pre>
</div>
</div>
</section>
<section id="model-fit-9" class="level5" data-number="3.6.2.1.2">
<h5 data-number="3.6.2.1.2" class="anchored" data-anchor-id="model-fit-9"><span class="header-section-number">3.6.2.1.2</span> Model fit</h5>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extended_summary</span>(<span class="at">fit =</span> mod, <span class="at">gsub.pattern =</span> <span class="st">"b_type"</span>, <span class="at">gsub.replacement =</span> <span class="st">"Aritificial_vs_"</span>,</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">remove.intercepts =</span> <span class="cn">TRUE</span>, <span class="at">highlight =</span> <span class="cn">TRUE</span>, <span class="at">print.name =</span> <span class="cn">FALSE</span>,</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace.palette =</span> viridis<span class="sc">::</span>mako, <span class="at">fill =</span> fill_color, <span class="at">beta.prefix =</span> <span class="st">"^b_|^bsp_"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
priors
</th>
<th style="text-align:left;">
formula
</th>
<th style="text-align:right;">
iterations
</th>
<th style="text-align:right;">
chains
</th>
<th style="text-align:right;">
thinning
</th>
<th style="text-align:right;">
warmup
</th>
<th style="text-align:left;">
diverg_transitions
</th>
<th style="text-align:left;">
rhats &gt; 1.05
</th>
<th style="text-align:right;">
min_bulk_ESS
</th>
<th style="text-align:right;">
min_tail_ESS
</th>
<th style="text-align:left;">
seed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
coi-beta(1, 1) Intercept-student_t(3, 0, 2.5) phi-gamma(0.01, 0.01) sd-student_t(3, 0, 2.5) zoi-beta(1, 1)
</td>
<td style="text-align:left;">
prop.callers ~ type + (1 | group.size.f)
</td>
<td style="text-align:right;">
10000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5000
</td>
<td style="text-align:left;">
<span style=" font-weight: bold;    color: white !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: red !important;font-size: 12px;">4 (2e-04%)</span>
</td>
<td style="text-align:left;">
<span style="     ">0</span>
</td>
<td style="text-align:right;">
18776.57
</td>
<td style="text-align:right;">
12800.29
</td>
<td style="text-align:left;">
1918215497
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="font-size: 12px; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
l-95% CI
</th>
<th style="text-align:right;">
u-95% CI
</th>
<th style="text-align:left;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Aritificial_vs_Natural
</td>
<td style="text-align:right;">
-0.282
</td>
<td style="text-align:right;">
-0.834
</td>
<td style="text-align:right;">
0.283
</td>
<td style="text-align:left;">
<span style="     ">1</span>
</td>
<td style="text-align:right;">
18776.57
</td>
<td style="text-align:right;">
12800.29
</td>
</tr>
</tbody>
</table>
<p><img src="data_analysis_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="1152"></p>
</section>
<section id="posterior-predictive-checks-9" class="level5" data-number="3.6.2.1.3">
<h5 data-number="3.6.2.1.3" class="anchored" data-anchor-id="posterior-predictive-checks-9"><span class="header-section-number">3.6.2.1.3</span> Posterior predictive checks</h5>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="takeaways-9" class="level3 unnumbered unlisted alert alert-info">
<h3 class="unnumbered unlisted anchored" data-anchor-id="takeaways-9">Takeaways</h3>
<ul>
<li>Similar proportion of calling individuals in natural and artificial groups</li>
</ul>
</section>
<hr>
</section>
</section>
<section id="session-information" class="level1 unnumbered unlisted">
<h1 class="unnumbered unlisted">Session information</h1>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 22.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       

time zone: America/Costa_Rica
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] rstan_2.32.6        StanHeaders_2.32.10 extrafont_0.19     
 [4] ggsignif_0.6.4      metap_1.11          multtest_2.60.0    
 [7] Biobase_2.62.0      BiocGenerics_0.48.1 cowplot_1.1.3      
[10] bayestestR_0.14.0   brmsish_1.0.0       tidybayes_3.0.7    
[13] ggridges_0.5.6      kableExtra_1.4.0    brms_2.22.0        
[16] Rcpp_1.0.14         pbapply_1.7-2       readxl_1.4.3       
[19] knitr_1.49          ggplot2_3.5.1       viridis_0.6.5      
[22] viridisLite_0.4.2  

loaded via a namespace (and not attached):
  [1] Rdpack_2.6.1         mnormt_2.1.1         gridExtra_2.3       
  [4] formatR_1.14         inline_0.3.19        remotes_2.5.0       
  [7] sandwich_3.1-0       rlang_1.1.5          magrittr_2.0.3      
 [10] multcomp_1.4-25      qqconf_1.3.2         matrixStats_1.4.1   
 [13] compiler_4.4.2       mgcv_1.9-1           loo_2.8.0           
 [16] reshape2_1.4.4       systemfonts_1.1.0    vctrs_0.6.5         
 [19] stringr_1.5.1        pkgconfig_2.0.3      arrayhelpers_1.1-0  
 [22] crayon_1.5.3         fastmap_1.2.0        backports_1.5.0     
 [25] labeling_0.4.3       cmdstanr_0.8.1.9000  rmarkdown_2.29      
 [28] ps_1.9.0             purrr_1.0.4          xfun_0.51           
 [31] jsonlite_1.9.0       gghalves_0.1.4       parallel_4.4.2      
 [34] R6_2.6.1             stringi_1.8.4        extrafontdb_1.0     
 [37] mutoss_0.1-13        cellranger_1.1.0     numDeriv_2016.8-1.1 
 [40] estimability_1.5.1   zoo_1.8-12           bayesplot_1.11.1    
 [43] Matrix_1.7-0         splines_4.4.2        tidyselect_1.2.1    
 [46] rstudioapi_0.16.0    abind_1.4-8          yaml_2.3.10         
 [49] codetools_0.2-20     curl_6.2.1           processx_3.8.6      
 [52] pkgbuild_1.4.6       plyr_1.8.9           lattice_0.22-6      
 [55] tibble_3.2.1         withr_3.0.2          bridgesampling_1.1-2
 [58] posterior_1.6.0      coda_0.19-4.1        evaluate_1.0.3      
 [61] survival_3.7-0       sketchy_1.0.5        RcppParallel_5.1.9  
 [64] ggdist_3.3.2         xml2_1.3.6           pillar_1.10.1       
 [67] tensorA_0.36.2.1     packrat_0.9.2        checkmate_2.3.2     
 [70] stats4_4.4.2         insight_0.20.2       sn_2.1.1            
 [73] distributional_0.5.0 generics_0.1.3       mathjaxr_1.6-0      
 [76] rstantools_2.4.0     munsell_0.5.1        scales_1.3.0        
 [79] TFisher_0.2.0        xtable_1.8-4         glue_1.8.0          
 [82] emmeans_1.10.3       tools_4.4.2          xaringanExtra_0.8.0 
 [85] mvtnorm_1.3-1        grid_4.4.2           plotrix_3.8-4       
 [88] tidyr_1.3.1          ape_5.8              QuickJSR_1.4.0      
 [91] Rttf2pt1_1.3.12      rbibutils_2.2.16     colorspace_2.1-1    
 [94] nlme_3.1-165         cli_3.6.4            svUnit_1.0.6        
 [97] svglite_2.1.3        Brobdingnag_1.2-9    dplyr_1.1.4         
[100] V8_4.4.2             gtable_0.3.6         digest_0.6.37       
[103] TH.data_1.1-2        farver_2.1.2         htmlwidgets_1.6.4   
[106] htmltools_0.5.8.1    lifecycle_1.0.4      MASS_7.3-61         </code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb132" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Statistical analysis</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> Behavioral coordination in Spix's disk-winged bats</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> &lt;center&gt;&lt;font size="4"&gt;&lt;a href="https://marce10.github.io/"&gt;Marcelo Araya-Salas, PhD&lt;/a&gt; &amp; &lt;a href="https://www.batcr.com/"&gt;Gloriana Chaverri, PhD&lt;/a&gt;&lt;/font&gt;&lt;/center&gt;</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 5</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc-location:</span><span class="co"> left</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="an">highlight-style:</span><span class="co"> pygments</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: kable</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="co">    css: qmd.css</span></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{r set root directory, echo = FALSE}</span></span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a><span class="in"># set working directory </span></span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_knit$set(root.dir =  "..")</span></span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r add link to github repo, echo = FALSE, results='asis'}</span></span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a><span class="in"># print link to github repo if any</span></span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a><span class="in">if (file.exists("./.git/config")) {</span></span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a><span class="in">  config &lt;- readLines("./.git/config")</span></span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a><span class="in">  url &lt;- grep("url",  config, value = TRUE)</span></span>
<span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a><span class="in">  url &lt;- gsub("\\turl = |.git$", "", url)</span></span>
<span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a><span class="in">  cat("\nSource code and data found at [", url, "](", url, ")", sep = "")</span></span>
<span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-38"><a href="#cb132-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-39"><a href="#cb132-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup style, echo = FALSE, message = FALSE, warning=FALSE}</span></span>
<span id="cb132-40"><a href="#cb132-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-41"><a href="#cb132-41" aria-hidden="true" tabindex="-1"></a><span class="in"># options to customize chunk outputs</span></span>
<span id="cb132-42"><a href="#cb132-42" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(</span></span>
<span id="cb132-43"><a href="#cb132-43" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy.opts = list(width.cutoff = 65), </span></span>
<span id="cb132-44"><a href="#cb132-44" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy = TRUE,</span></span>
<span id="cb132-45"><a href="#cb132-45" aria-hidden="true" tabindex="-1"></a><span class="in">  message = FALSE</span></span>
<span id="cb132-46"><a href="#cb132-46" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb132-47"><a href="#cb132-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-48"><a href="#cb132-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-49"><a href="#cb132-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-50"><a href="#cb132-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-51"><a href="#cb132-51" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb132-52"><a href="#cb132-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-53"><a href="#cb132-53" aria-hidden="true" tabindex="-1"></a><span class="fu"># To do {.unnumbered .unlisted}</span></span>
<span id="cb132-54"><a href="#cb132-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-55"><a href="#cb132-55" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Make sure all estimates are using median and MAP</span>
<span id="cb132-56"><a href="#cb132-56" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Can we back-transform response variables to use intuitive units in the results???</span>
<span id="cb132-57"><a href="#cb132-57" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Make sure all models run for the same number of iterations and number of chains</span>
<span id="cb132-58"><a href="#cb132-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-59"><a href="#cb132-59" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-60"><a href="#cb132-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-61"><a href="#cb132-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-62"><a href="#cb132-62" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- skyblue box --&gt;</span></span>
<span id="cb132-63"><a href="#cb132-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-64"><a href="#cb132-64" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-65"><a href="#cb132-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-66"><a href="#cb132-66" aria-hidden="true" tabindex="-1"></a><span class="fu"># Purpose {.unnumbered .unlisted}</span></span>
<span id="cb132-67"><a href="#cb132-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-68"><a href="#cb132-68" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generate simulated data </span>
<span id="cb132-69"><a href="#cb132-69" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Run statistical analyses</span>
<span id="cb132-70"><a href="#cb132-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-71"><a href="#cb132-71" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb132-72"><a href="#cb132-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-73"><a href="#cb132-73" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load packages and configure global settings {.unnumbered .unlisted}</span></span>
<span id="cb132-74"><a href="#cb132-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-75"><a href="#cb132-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load packages, warning=FALSE, message=FALSE}</span></span>
<span id="cb132-76"><a href="#cb132-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-77"><a href="#cb132-77" aria-hidden="true" tabindex="-1"></a><span class="in"># knitr is require for creating html/pdf/word reports</span></span>
<span id="cb132-78"><a href="#cb132-78" aria-hidden="true" tabindex="-1"></a><span class="in"># formatR is used for soft-wrapping code</span></span>
<span id="cb132-79"><a href="#cb132-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-80"><a href="#cb132-80" aria-hidden="true" tabindex="-1"></a><span class="in"># install/ load packages</span></span>
<span id="cb132-81"><a href="#cb132-81" aria-hidden="true" tabindex="-1"></a><span class="in">sketchy::load_packages(</span></span>
<span id="cb132-82"><a href="#cb132-82" aria-hidden="true" tabindex="-1"></a><span class="in">  packages = c(</span></span>
<span id="cb132-83"><a href="#cb132-83" aria-hidden="true" tabindex="-1"></a><span class="in">    "viridis",</span></span>
<span id="cb132-84"><a href="#cb132-84" aria-hidden="true" tabindex="-1"></a><span class="in">    "ggplot2",</span></span>
<span id="cb132-85"><a href="#cb132-85" aria-hidden="true" tabindex="-1"></a><span class="in">    "knitr",</span></span>
<span id="cb132-86"><a href="#cb132-86" aria-hidden="true" tabindex="-1"></a><span class="in">    "readxl",</span></span>
<span id="cb132-87"><a href="#cb132-87" aria-hidden="true" tabindex="-1"></a><span class="in">    "pbapply",</span></span>
<span id="cb132-88"><a href="#cb132-88" aria-hidden="true" tabindex="-1"></a><span class="in">    "brms",</span></span>
<span id="cb132-89"><a href="#cb132-89" aria-hidden="true" tabindex="-1"></a><span class="in">    "kableExtra",</span></span>
<span id="cb132-90"><a href="#cb132-90" aria-hidden="true" tabindex="-1"></a><span class="in">    "ggridges",</span></span>
<span id="cb132-91"><a href="#cb132-91" aria-hidden="true" tabindex="-1"></a><span class="in">    "tidybayes",</span></span>
<span id="cb132-92"><a href="#cb132-92" aria-hidden="true" tabindex="-1"></a><span class="in">    "brmsish",</span></span>
<span id="cb132-93"><a href="#cb132-93" aria-hidden="true" tabindex="-1"></a><span class="in">    "bayestestR",</span></span>
<span id="cb132-94"><a href="#cb132-94" aria-hidden="true" tabindex="-1"></a><span class="in">    "cowplot",</span></span>
<span id="cb132-95"><a href="#cb132-95" aria-hidden="true" tabindex="-1"></a><span class="in">    bioconductor = "multtest",</span></span>
<span id="cb132-96"><a href="#cb132-96" aria-hidden="true" tabindex="-1"></a><span class="in">    "metap",</span></span>
<span id="cb132-97"><a href="#cb132-97" aria-hidden="true" tabindex="-1"></a><span class="in">    "ggsignif",</span></span>
<span id="cb132-98"><a href="#cb132-98" aria-hidden="true" tabindex="-1"></a><span class="in">    "extrafont"</span></span>
<span id="cb132-99"><a href="#cb132-99" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-100"><a href="#cb132-100" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-101"><a href="#cb132-101" aria-hidden="true" tabindex="-1"></a><span class="in">source("~/Dropbox/R_package_testing/brmsish/R/helpers.R")</span></span>
<span id="cb132-102"><a href="#cb132-102" aria-hidden="true" tabindex="-1"></a><span class="in">source("~/Dropbox/R_package_testing/brmsish/R/draw_extended_summary.R")</span></span>
<span id="cb132-103"><a href="#cb132-103" aria-hidden="true" tabindex="-1"></a><span class="in">source("~/Dropbox/R_package_testing/brmsish/R/extended_summary.R")</span></span>
<span id="cb132-104"><a href="#cb132-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-105"><a href="#cb132-105" aria-hidden="true" tabindex="-1"></a><span class="in">opts_chunk$set(fig.width = 12, fig.height = 8)</span></span>
<span id="cb132-106"><a href="#cb132-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-107"><a href="#cb132-107" aria-hidden="true" tabindex="-1"></a><span class="in">theme_set(theme_classic(base_size = 24))</span></span>
<span id="cb132-108"><a href="#cb132-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-109"><a href="#cb132-109" aria-hidden="true" tabindex="-1"></a><span class="in">fill_color &lt;- viridis::mako(10, alpha = 0.5)[7]</span></span>
<span id="cb132-110"><a href="#cb132-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-111"><a href="#cb132-111" aria-hidden="true" tabindex="-1"></a><span class="in">graph_cols &lt;- mako(4, begin = 0, end = 0.8)</span></span>
<span id="cb132-112"><a href="#cb132-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-113"><a href="#cb132-113" aria-hidden="true" tabindex="-1"></a><span class="in">graph_cols_transp &lt;- mako(4, begin = 0, end = 0.8, alpha = 0.5)</span></span>
<span id="cb132-114"><a href="#cb132-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-115"><a href="#cb132-115" aria-hidden="true" tabindex="-1"></a><span class="in">names(graph_cols_transp)  &lt;- names(graph_cols) &lt;- c("solo", "natural", "artificial", "simulated")</span></span>
<span id="cb132-116"><a href="#cb132-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-117"><a href="#cb132-117" aria-hidden="true" tabindex="-1"></a><span class="in">chains &lt;- 4</span></span>
<span id="cb132-118"><a href="#cb132-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-119"><a href="#cb132-119" aria-hidden="true" tabindex="-1"></a><span class="in">iter &lt;- 10000</span></span>
<span id="cb132-120"><a href="#cb132-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-121"><a href="#cb132-121" aria-hidden="true" tabindex="-1"></a><span class="in">options(brms.backend = "cmdstanr")</span></span>
<span id="cb132-122"><a href="#cb132-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-123"><a href="#cb132-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-124"><a href="#cb132-124" aria-hidden="true" tabindex="-1"></a><span class="fu">## Custom functions {.unnumbered .unlisted}</span></span>
<span id="cb132-125"><a href="#cb132-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb132-126"><a href="#cb132-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-127"><a href="#cb132-127" aria-hidden="true" tabindex="-1"></a><span class="in"># Coefficient of variation</span></span>
<span id="cb132-128"><a href="#cb132-128" aria-hidden="true" tabindex="-1"></a><span class="in">cv &lt;- function(x) sd(x) / mean(x) * 100</span></span>
<span id="cb132-129"><a href="#cb132-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-130"><a href="#cb132-130" aria-hidden="true" tabindex="-1"></a><span class="in"># Function to measure the euclidean distance in 3D space between bats in a group flight trajectory</span></span>
<span id="cb132-131"><a href="#cb132-131" aria-hidden="true" tabindex="-1"></a><span class="in">pairwise_dist &lt;- function(X) {</span></span>
<span id="cb132-132"><a href="#cb132-132" aria-hidden="true" tabindex="-1"></a><span class="in">  # keep only 3D coordinates data</span></span>
<span id="cb132-133"><a href="#cb132-133" aria-hidden="true" tabindex="-1"></a><span class="in">  xyz &lt;- X[, grep("^x|^y|^z", names(X))]</span></span>
<span id="cb132-134"><a href="#cb132-134" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-135"><a href="#cb132-135" aria-hidden="true" tabindex="-1"></a><span class="in">  # remove empty columns</span></span>
<span id="cb132-136"><a href="#cb132-136" aria-hidden="true" tabindex="-1"></a><span class="in">  xyz &lt;- xyz[, sapply(xyz, function(x)</span></span>
<span id="cb132-137"><a href="#cb132-137" aria-hidden="true" tabindex="-1"></a><span class="in">    sum(is.na(x))) &lt; 10]</span></span>
<span id="cb132-138"><a href="#cb132-138" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-139"><a href="#cb132-139" aria-hidden="true" tabindex="-1"></a><span class="in">  # set to long format</span></span>
<span id="cb132-140"><a href="#cb132-140" aria-hidden="true" tabindex="-1"></a><span class="in">  lng_xyz  &lt;-</span></span>
<span id="cb132-141"><a href="#cb132-141" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame(x = stack(xyz[, grep("^x", names(xyz))])[, 1],</span></span>
<span id="cb132-142"><a href="#cb132-142" aria-hidden="true" tabindex="-1"></a><span class="in">               y = stack(xyz[, grep("^y", names(xyz))])[, 1],</span></span>
<span id="cb132-143"><a href="#cb132-143" aria-hidden="true" tabindex="-1"></a><span class="in">               z = stack(xyz[, grep("^z", names(xyz))]))</span></span>
<span id="cb132-144"><a href="#cb132-144" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-145"><a href="#cb132-145" aria-hidden="true" tabindex="-1"></a><span class="in">  names(lng_xyz)[names(lng_xyz) ==  "z.values"] &lt;- "z"</span></span>
<span id="cb132-146"><a href="#cb132-146" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-147"><a href="#cb132-147" aria-hidden="true" tabindex="-1"></a><span class="in">  lng_xyz$ind &lt;- gsub("z_", "", lng_xyz$z.ind)</span></span>
<span id="cb132-148"><a href="#cb132-148" aria-hidden="true" tabindex="-1"></a><span class="in">  lng_xyz$z.ind &lt;- NULL</span></span>
<span id="cb132-149"><a href="#cb132-149" aria-hidden="true" tabindex="-1"></a><span class="in">  # lng_xyz$frame &lt;- X$frame</span></span>
<span id="cb132-150"><a href="#cb132-150" aria-hidden="true" tabindex="-1"></a><span class="in">  lng_xyz$frame &lt;- 1:nrow(X)</span></span>
<span id="cb132-151"><a href="#cb132-151" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-152"><a href="#cb132-152" aria-hidden="true" tabindex="-1"></a><span class="in">  # mean distance among all bats</span></span>
<span id="cb132-153"><a href="#cb132-153" aria-hidden="true" tabindex="-1"></a><span class="in">  obs_dists &lt;-</span></span>
<span id="cb132-154"><a href="#cb132-154" aria-hidden="true" tabindex="-1"></a><span class="in">    sapply(unique(lng_xyz$frame), function(x)</span></span>
<span id="cb132-155"><a href="#cb132-155" aria-hidden="true" tabindex="-1"></a><span class="in">      mean(dist(lng_xyz[lng_xyz$frame == x, c("x", "y", "z")])))</span></span>
<span id="cb132-156"><a href="#cb132-156" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-157"><a href="#cb132-157" aria-hidden="true" tabindex="-1"></a><span class="in">  out &lt;-</span></span>
<span id="cb132-158"><a href="#cb132-158" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame(</span></span>
<span id="cb132-159"><a href="#cb132-159" aria-hidden="true" tabindex="-1"></a><span class="in">      group = X$group[1],</span></span>
<span id="cb132-160"><a href="#cb132-160" aria-hidden="true" tabindex="-1"></a><span class="in">      group.size = length(unique(lng_xyz$ind)),</span></span>
<span id="cb132-161"><a href="#cb132-161" aria-hidden="true" tabindex="-1"></a><span class="in">      distance = obs_dists,</span></span>
<span id="cb132-162"><a href="#cb132-162" aria-hidden="true" tabindex="-1"></a><span class="in">      type = X$type[1],</span></span>
<span id="cb132-163"><a href="#cb132-163" aria-hidden="true" tabindex="-1"></a><span class="in">      frame = 1:nrow(X)</span></span>
<span id="cb132-164"><a href="#cb132-164" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb132-165"><a href="#cb132-165" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-166"><a href="#cb132-166" aria-hidden="true" tabindex="-1"></a><span class="in">  # add group size as factor</span></span>
<span id="cb132-167"><a href="#cb132-167" aria-hidden="true" tabindex="-1"></a><span class="in">  out$group.size.factor &lt;- factor(out$group.size, levels = 1:10, ordered = TRUE)</span></span>
<span id="cb132-168"><a href="#cb132-168" aria-hidden="true" tabindex="-1"></a><span class="in">  return(out)</span></span>
<span id="cb132-169"><a href="#cb132-169" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb132-170"><a href="#cb132-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-171"><a href="#cb132-171" aria-hidden="true" tabindex="-1"></a><span class="in"># function to create simulated data getting one individual trajectory from diferent groups for a total of individual equals to group_sizes[x]</span></span>
<span id="cb132-172"><a href="#cb132-172" aria-hidden="true" tabindex="-1"></a><span class="in">sim_group_traj &lt;- function(group_sizes, seed, trajectories = FALSE) {</span></span>
<span id="cb132-173"><a href="#cb132-173" aria-hidden="true" tabindex="-1"></a><span class="in">  trajs &lt;- indiv_traj_list</span></span>
<span id="cb132-174"><a href="#cb132-174" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-175"><a href="#cb132-175" aria-hidden="true" tabindex="-1"></a><span class="in">  # randomize so each iteration is a different</span></span>
<span id="cb132-176"><a href="#cb132-176" aria-hidden="true" tabindex="-1"></a><span class="in">  set.seed(seed)</span></span>
<span id="cb132-177"><a href="#cb132-177" aria-hidden="true" tabindex="-1"></a><span class="in">  trajs &lt;- sample(trajs)</span></span>
<span id="cb132-178"><a href="#cb132-178" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-179"><a href="#cb132-179" aria-hidden="true" tabindex="-1"></a><span class="in">  dists_list &lt;- list()</span></span>
<span id="cb132-180"><a href="#cb132-180" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-181"><a href="#cb132-181" aria-hidden="true" tabindex="-1"></a><span class="in">  group_num &lt;- 1</span></span>
<span id="cb132-182"><a href="#cb132-182" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-183"><a href="#cb132-183" aria-hidden="true" tabindex="-1"></a><span class="in">  used_trajs &lt;- list()</span></span>
<span id="cb132-184"><a href="#cb132-184" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-185"><a href="#cb132-185" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-186"><a href="#cb132-186" aria-hidden="true" tabindex="-1"></a><span class="in">  for (e in seq_along(group_sizes)) {</span></span>
<span id="cb132-187"><a href="#cb132-187" aria-hidden="true" tabindex="-1"></a><span class="in">    i &lt;- group_sizes[e]</span></span>
<span id="cb132-188"><a href="#cb132-188" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_traj_indx &lt;- which(!duplicated(names(trajs)))[1:i]</span></span>
<span id="cb132-189"><a href="#cb132-189" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-190"><a href="#cb132-190" aria-hidden="true" tabindex="-1"></a><span class="in">    set.seed(group_num + seed)</span></span>
<span id="cb132-191"><a href="#cb132-191" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_trajs &lt;- trajs[sample_traj_indx]</span></span>
<span id="cb132-192"><a href="#cb132-192" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-193"><a href="#cb132-193" aria-hidden="true" tabindex="-1"></a><span class="in">    # force all to have the same number of frames</span></span>
<span id="cb132-194"><a href="#cb132-194" aria-hidden="true" tabindex="-1"></a><span class="in">    min_frames &lt;- min(sapply(sample_trajs, nrow))</span></span>
<span id="cb132-195"><a href="#cb132-195" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-196"><a href="#cb132-196" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_trajs &lt;-</span></span>
<span id="cb132-197"><a href="#cb132-197" aria-hidden="true" tabindex="-1"></a><span class="in">      lapply(sample_trajs, function(x)</span></span>
<span id="cb132-198"><a href="#cb132-198" aria-hidden="true" tabindex="-1"></a><span class="in">        x[1:min_frames, ])</span></span>
<span id="cb132-199"><a href="#cb132-199" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-200"><a href="#cb132-200" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_traj_df &lt;- do_call(cbind, sample_trajs)</span></span>
<span id="cb132-201"><a href="#cb132-201" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-202"><a href="#cb132-202" aria-hidden="true" tabindex="-1"></a><span class="in">    names(sample_traj_df) &lt;-</span></span>
<span id="cb132-203"><a href="#cb132-203" aria-hidden="true" tabindex="-1"></a><span class="in">      paste(c("x", "y", "z"), rep(1:i, 3), sep = "_")</span></span>
<span id="cb132-204"><a href="#cb132-204" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-205"><a href="#cb132-205" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_traj_df$group &lt;- paste("sim", group_num, sep = "-")</span></span>
<span id="cb132-206"><a href="#cb132-206" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_traj_df$type &lt;- "simulated"</span></span>
<span id="cb132-207"><a href="#cb132-207" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-208"><a href="#cb132-208" aria-hidden="true" tabindex="-1"></a><span class="in">    dist_df &lt;- pairwise_dist(sample_traj_df)</span></span>
<span id="cb132-209"><a href="#cb132-209" aria-hidden="true" tabindex="-1"></a><span class="in">    dist_df$type &lt;- "simulated"</span></span>
<span id="cb132-210"><a href="#cb132-210" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-211"><a href="#cb132-211" aria-hidden="true" tabindex="-1"></a><span class="in">    # add to output list</span></span>
<span id="cb132-212"><a href="#cb132-212" aria-hidden="true" tabindex="-1"></a><span class="in">    dists_list[[length(dists_list) + 1]] &lt;- dist_df</span></span>
<span id="cb132-213"><a href="#cb132-213" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-214"><a href="#cb132-214" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove sampled trajectories from trajs based on indices so idnviduals are only used once</span></span>
<span id="cb132-215"><a href="#cb132-215" aria-hidden="true" tabindex="-1"></a><span class="in">    trajs &lt;- trajs[-sample_traj_indx]</span></span>
<span id="cb132-216"><a href="#cb132-216" aria-hidden="true" tabindex="-1"></a><span class="in">    group_num &lt;- group_num + 1</span></span>
<span id="cb132-217"><a href="#cb132-217" aria-hidden="true" tabindex="-1"></a><span class="in">    names(sample_trajs) &lt;- paste("sim", e, 1:length(sample_trajs), sep = "-")</span></span>
<span id="cb132-218"><a href="#cb132-218" aria-hidden="true" tabindex="-1"></a><span class="in">    used_trajs &lt;- c(used_trajs, sample_trajs)</span></span>
<span id="cb132-219"><a href="#cb132-219" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb132-220"><a href="#cb132-220" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-221"><a href="#cb132-221" aria-hidden="true" tabindex="-1"></a><span class="in">  dists_df &lt;- do.call(rbind, dists_list)</span></span>
<span id="cb132-222"><a href="#cb132-222" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-223"><a href="#cb132-223" aria-hidden="true" tabindex="-1"></a><span class="in">  if (!trajectories)</span></span>
<span id="cb132-224"><a href="#cb132-224" aria-hidden="true" tabindex="-1"></a><span class="in">    return(dists_df) else</span></span>
<span id="cb132-225"><a href="#cb132-225" aria-hidden="true" tabindex="-1"></a><span class="in">      return(used_trajs)</span></span>
<span id="cb132-226"><a href="#cb132-226" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb132-227"><a href="#cb132-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-228"><a href="#cb132-228" aria-hidden="true" tabindex="-1"></a><span class="in"># function to simulate group calling from solo calling vectors</span></span>
<span id="cb132-229"><a href="#cb132-229" aria-hidden="true" tabindex="-1"></a><span class="in">sim_group_call &lt;- function(group_sizes, seed) {</span></span>
<span id="cb132-230"><a href="#cb132-230" aria-hidden="true" tabindex="-1"></a><span class="in">  indv_calls &lt;- split(time_calls_indiv, list(time_calls_indiv$year.audio))</span></span>
<span id="cb132-231"><a href="#cb132-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-232"><a href="#cb132-232" aria-hidden="true" tabindex="-1"></a><span class="in">  # randomize so each iteration is a different</span></span>
<span id="cb132-233"><a href="#cb132-233" aria-hidden="true" tabindex="-1"></a><span class="in">  set.seed(seed)</span></span>
<span id="cb132-234"><a href="#cb132-234" aria-hidden="true" tabindex="-1"></a><span class="in">  indv_calls &lt;- sample(indv_calls)</span></span>
<span id="cb132-235"><a href="#cb132-235" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-236"><a href="#cb132-236" aria-hidden="true" tabindex="-1"></a><span class="in">  # dists_list &lt;- list()</span></span>
<span id="cb132-237"><a href="#cb132-237" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-238"><a href="#cb132-238" aria-hidden="true" tabindex="-1"></a><span class="in">  # group_num &lt;- 1</span></span>
<span id="cb132-239"><a href="#cb132-239" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-240"><a href="#cb132-240" aria-hidden="true" tabindex="-1"></a><span class="in">  # used_calls &lt;- list()</span></span>
<span id="cb132-241"><a href="#cb132-241" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-242"><a href="#cb132-242" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-243"><a href="#cb132-243" aria-hidden="true" tabindex="-1"></a><span class="in">  sim_call_list &lt;- lapply(seq_along(group_sizes), function(i) {</span></span>
<span id="cb132-244"><a href="#cb132-244" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-245"><a href="#cb132-245" aria-hidden="true" tabindex="-1"></a><span class="in">    e &lt;- group_sizes[i]</span></span>
<span id="cb132-246"><a href="#cb132-246" aria-hidden="true" tabindex="-1"></a><span class="in">    # set.seed(e + seed)</span></span>
<span id="cb132-247"><a href="#cb132-247" aria-hidden="true" tabindex="-1"></a><span class="in">    sampled_calls &lt;- indv_calls[sample(1:length(indv_calls), e)]</span></span>
<span id="cb132-248"><a href="#cb132-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-249"><a href="#cb132-249" aria-hidden="true" tabindex="-1"></a><span class="in">    clms &lt;- c("start", "end", "indiv", "year.audio")</span></span>
<span id="cb132-250"><a href="#cb132-250" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-251"><a href="#cb132-251" aria-hidden="true" tabindex="-1"></a><span class="in">    sampled_calls &lt;- lapply(sampled_calls, function(x) x[, clms])</span></span>
<span id="cb132-252"><a href="#cb132-252" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-253"><a href="#cb132-253" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_calls_df &lt;- do_call(rbind, sampled_calls)</span></span>
<span id="cb132-254"><a href="#cb132-254" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-255"><a href="#cb132-255" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_calls_df$sound.files &lt;- paste(i, e, sep = "-")</span></span>
<span id="cb132-256"><a href="#cb132-256" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_calls_df$year.audio</span></span>
<span id="cb132-257"><a href="#cb132-257" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-258"><a href="#cb132-258" aria-hidden="true" tabindex="-1"></a><span class="in">    sample_calls_df$group.size &lt;- e</span></span>
<span id="cb132-259"><a href="#cb132-259" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb132-260"><a href="#cb132-260" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-261"><a href="#cb132-261" aria-hidden="true" tabindex="-1"></a><span class="in">    return(sample_calls_df)</span></span>
<span id="cb132-262"><a href="#cb132-262" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb132-263"><a href="#cb132-263" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-264"><a href="#cb132-264" aria-hidden="true" tabindex="-1"></a><span class="in">  sim_call_df &lt;- do.call(rbind, sim_call_list)</span></span>
<span id="cb132-265"><a href="#cb132-265" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-266"><a href="#cb132-266" aria-hidden="true" tabindex="-1"></a><span class="in">      return(sim_call_df)</span></span>
<span id="cb132-267"><a href="#cb132-267" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb132-268"><a href="#cb132-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-269"><a href="#cb132-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-270"><a href="#cb132-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-271"><a href="#cb132-271" aria-hidden="true" tabindex="-1"></a><span class="in"># Function to calculate contrasts based on a brms draws object</span></span>
<span id="cb132-272"><a href="#cb132-272" aria-hidden="true" tabindex="-1"></a><span class="in"># Function to calculate contrasts based on posterior draws and plot the posterior distributions</span></span>
<span id="cb132-273"><a href="#cb132-273" aria-hidden="true" tabindex="-1"></a><span class="in">draws_contrasts &lt;-</span></span>
<span id="cb132-274"><a href="#cb132-274" aria-hidden="true" tabindex="-1"></a><span class="in">  function(draws,</span></span>
<span id="cb132-275"><a href="#cb132-275" aria-hidden="true" tabindex="-1"></a><span class="in">           predictor_name,</span></span>
<span id="cb132-276"><a href="#cb132-276" aria-hidden="true" tabindex="-1"></a><span class="in">           basal_level,</span></span>
<span id="cb132-277"><a href="#cb132-277" aria-hidden="true" tabindex="-1"></a><span class="in">           fill_color = "blue",</span></span>
<span id="cb132-278"><a href="#cb132-278" aria-hidden="true" tabindex="-1"></a><span class="in">           beta.prefix = "^b_") {</span></span>
<span id="cb132-279"><a href="#cb132-279" aria-hidden="true" tabindex="-1"></a><span class="in">    # Extract the model coefficients</span></span>
<span id="cb132-280"><a href="#cb132-280" aria-hidden="true" tabindex="-1"></a><span class="in">    coef_names &lt;- colnames(draws)</span></span>
<span id="cb132-281"><a href="#cb132-281" aria-hidden="true" tabindex="-1"></a><span class="in">    intercept_name &lt;-</span></span>
<span id="cb132-282"><a href="#cb132-282" aria-hidden="true" tabindex="-1"></a><span class="in">      grep("^b_Intercept$", coef_names, value = TRUE)</span></span>
<span id="cb132-283"><a href="#cb132-283" aria-hidden="true" tabindex="-1"></a><span class="in">    group_names &lt;-</span></span>
<span id="cb132-284"><a href="#cb132-284" aria-hidden="true" tabindex="-1"></a><span class="in">      grep(paste0(beta.prefix, predictor_name), coef_names, value = TRUE)</span></span>
<span id="cb132-285"><a href="#cb132-285" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-286"><a href="#cb132-286" aria-hidden="true" tabindex="-1"></a><span class="in">    # Determine the levels of the categorical predictor</span></span>
<span id="cb132-287"><a href="#cb132-287" aria-hidden="true" tabindex="-1"></a><span class="in">    levels &lt;-</span></span>
<span id="cb132-288"><a href="#cb132-288" aria-hidden="true" tabindex="-1"></a><span class="in">      c(basal_level, sub(paste0(beta.prefix, predictor_name), "", group_names))</span></span>
<span id="cb132-289"><a href="#cb132-289" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-290"><a href="#cb132-290" aria-hidden="true" tabindex="-1"></a><span class="in">    # Calculate EMMs for each level</span></span>
<span id="cb132-291"><a href="#cb132-291" aria-hidden="true" tabindex="-1"></a><span class="in">    group_values &lt;- list()</span></span>
<span id="cb132-292"><a href="#cb132-292" aria-hidden="true" tabindex="-1"></a><span class="in">    group_values[[1]] &lt;- draws[[intercept_name]]</span></span>
<span id="cb132-293"><a href="#cb132-293" aria-hidden="true" tabindex="-1"></a><span class="in">    for (i in seq_along(group_names)) {</span></span>
<span id="cb132-294"><a href="#cb132-294" aria-hidden="true" tabindex="-1"></a><span class="in">      group_values[[i + 1]] &lt;-</span></span>
<span id="cb132-295"><a href="#cb132-295" aria-hidden="true" tabindex="-1"></a><span class="in">        draws[[intercept_name]] + draws[[group_names[i]]]</span></span>
<span id="cb132-296"><a href="#cb132-296" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb132-297"><a href="#cb132-297" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-298"><a href="#cb132-298" aria-hidden="true" tabindex="-1"></a><span class="in">    # Compute pairwise contrasts</span></span>
<span id="cb132-299"><a href="#cb132-299" aria-hidden="true" tabindex="-1"></a><span class="in">    contrast_list &lt;- list()</span></span>
<span id="cb132-300"><a href="#cb132-300" aria-hidden="true" tabindex="-1"></a><span class="in">    contrast_names &lt;-</span></span>
<span id="cb132-301"><a href="#cb132-301" aria-hidden="true" tabindex="-1"></a><span class="in">      combn(levels, 2, function(x)</span></span>
<span id="cb132-302"><a href="#cb132-302" aria-hidden="true" tabindex="-1"></a><span class="in">        paste(x[2], "-", x[1]))</span></span>
<span id="cb132-303"><a href="#cb132-303" aria-hidden="true" tabindex="-1"></a><span class="in">    for (i in 1:length(contrast_names)) {</span></span>
<span id="cb132-304"><a href="#cb132-304" aria-hidden="true" tabindex="-1"></a><span class="in">      contrast_list[[i]] &lt;-</span></span>
<span id="cb132-305"><a href="#cb132-305" aria-hidden="true" tabindex="-1"></a><span class="in">        group_values[[which(levels == strsplit(contrast_names[i], " - ")[[1]][2])]] -</span></span>
<span id="cb132-306"><a href="#cb132-306" aria-hidden="true" tabindex="-1"></a><span class="in">        group_values[[which(levels == strsplit(contrast_names[i], " - ")[[1]][1])]]</span></span>
<span id="cb132-307"><a href="#cb132-307" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb132-308"><a href="#cb132-308" aria-hidden="true" tabindex="-1"></a><span class="in">    names(contrast_list) &lt;- contrast_names</span></span>
<span id="cb132-309"><a href="#cb132-309" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-310"><a href="#cb132-310" aria-hidden="true" tabindex="-1"></a><span class="in">    # Function to summarize contrasts</span></span>
<span id="cb132-311"><a href="#cb132-311" aria-hidden="true" tabindex="-1"></a><span class="in">    summarize_contrast &lt;- function(contrast) {</span></span>
<span id="cb132-312"><a href="#cb132-312" aria-hidden="true" tabindex="-1"></a><span class="in">      mean_contrast &lt;- mean(contrast)</span></span>
<span id="cb132-313"><a href="#cb132-313" aria-hidden="true" tabindex="-1"></a><span class="in">      lower_contrast &lt;- quantile(contrast, 0.025)</span></span>
<span id="cb132-314"><a href="#cb132-314" aria-hidden="true" tabindex="-1"></a><span class="in">      upper_contrast &lt;- quantile(contrast, 0.975)</span></span>
<span id="cb132-315"><a href="#cb132-315" aria-hidden="true" tabindex="-1"></a><span class="in">      return(c(</span></span>
<span id="cb132-316"><a href="#cb132-316" aria-hidden="true" tabindex="-1"></a><span class="in">        mean = mean_contrast,</span></span>
<span id="cb132-317"><a href="#cb132-317" aria-hidden="true" tabindex="-1"></a><span class="in">        lower = lower_contrast,</span></span>
<span id="cb132-318"><a href="#cb132-318" aria-hidden="true" tabindex="-1"></a><span class="in">        upper = upper_contrast</span></span>
<span id="cb132-319"><a href="#cb132-319" aria-hidden="true" tabindex="-1"></a><span class="in">      ))</span></span>
<span id="cb132-320"><a href="#cb132-320" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb132-321"><a href="#cb132-321" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-322"><a href="#cb132-322" aria-hidden="true" tabindex="-1"></a><span class="in">    # Summarize each contrast</span></span>
<span id="cb132-323"><a href="#cb132-323" aria-hidden="true" tabindex="-1"></a><span class="in">    summary_contrasts &lt;-</span></span>
<span id="cb132-324"><a href="#cb132-324" aria-hidden="true" tabindex="-1"></a><span class="in">      sapply(contrast_list, summarize_contrast, simplify = "array")</span></span>
<span id="cb132-325"><a href="#cb132-325" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-326"><a href="#cb132-326" aria-hidden="true" tabindex="-1"></a><span class="in">    # Convert summary to a data frame for plotting</span></span>
<span id="cb132-327"><a href="#cb132-327" aria-hidden="true" tabindex="-1"></a><span class="in">    contrast_summary_df &lt;- data.frame(</span></span>
<span id="cb132-328"><a href="#cb132-328" aria-hidden="true" tabindex="-1"></a><span class="in">      Contrast = rep(names(contrast_list), each = 3),</span></span>
<span id="cb132-329"><a href="#cb132-329" aria-hidden="true" tabindex="-1"></a><span class="in">      Statistic = rep(c("Mean", "Lower", "Upper"), times = length(contrast_list)),</span></span>
<span id="cb132-330"><a href="#cb132-330" aria-hidden="true" tabindex="-1"></a><span class="in">      Value = as.vector(summary_contrasts)</span></span>
<span id="cb132-331"><a href="#cb132-331" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb132-332"><a href="#cb132-332" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-333"><a href="#cb132-333" aria-hidden="true" tabindex="-1"></a><span class="in">    # flip summary</span></span>
<span id="cb132-334"><a href="#cb132-334" aria-hidden="true" tabindex="-1"></a><span class="in">    summary_contrasts &lt;- t(summary_contrasts)</span></span>
<span id="cb132-335"><a href="#cb132-335" aria-hidden="true" tabindex="-1"></a><span class="in">    colnames(summary_contrasts) &lt;- c("est", "l-95% CI", "u-95% CI")</span></span>
<span id="cb132-336"><a href="#cb132-336" aria-hidden="true" tabindex="-1"></a><span class="in">    summary_contrasts &lt;- html_format_coef_table(as.data.frame(summary_contrasts), fill = fill_color,  highlight = TRUE)</span></span>
<span id="cb132-337"><a href="#cb132-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-338"><a href="#cb132-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-339"><a href="#cb132-339" aria-hidden="true" tabindex="-1"></a><span class="in">    # Plot the posterior distributions of contrasts</span></span>
<span id="cb132-340"><a href="#cb132-340" aria-hidden="true" tabindex="-1"></a><span class="in">    contrast_df &lt;-</span></span>
<span id="cb132-341"><a href="#cb132-341" aria-hidden="true" tabindex="-1"></a><span class="in">      do.call(rbind, lapply(names(contrast_list), function(name) {</span></span>
<span id="cb132-342"><a href="#cb132-342" aria-hidden="true" tabindex="-1"></a><span class="in">        data.frame(Contrast = name, Value = contrast_list[[name]])</span></span>
<span id="cb132-343"><a href="#cb132-343" aria-hidden="true" tabindex="-1"></a><span class="in">      }))</span></span>
<span id="cb132-344"><a href="#cb132-344" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-345"><a href="#cb132-345" aria-hidden="true" tabindex="-1"></a><span class="in">    p &lt;- ggplot(contrast_df, aes(x = Value)) +</span></span>
<span id="cb132-346"><a href="#cb132-346" aria-hidden="true" tabindex="-1"></a><span class="in">      geom_density(alpha = 0.6,</span></span>
<span id="cb132-347"><a href="#cb132-347" aria-hidden="true" tabindex="-1"></a><span class="in">                   fill = fill_color,</span></span>
<span id="cb132-348"><a href="#cb132-348" aria-hidden="true" tabindex="-1"></a><span class="in">                   color = fill_color) +</span></span>
<span id="cb132-349"><a href="#cb132-349" aria-hidden="true" tabindex="-1"></a><span class="in">      geom_vline(xintercept = 0, linetype = "dotted") +</span></span>
<span id="cb132-350"><a href="#cb132-350" aria-hidden="true" tabindex="-1"></a><span class="in">      facet_wrap(~ Contrast, scales = "free_y", ncol = 1) +</span></span>
<span id="cb132-351"><a href="#cb132-351" aria-hidden="true" tabindex="-1"></a><span class="in">      theme_minimal() +</span></span>
<span id="cb132-352"><a href="#cb132-352" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(</span></span>
<span id="cb132-353"><a href="#cb132-353" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.title.y = element_blank(),</span></span>
<span id="cb132-354"><a href="#cb132-354" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.text.y = element_blank(),</span></span>
<span id="cb132-355"><a href="#cb132-355" aria-hidden="true" tabindex="-1"></a><span class="in">        axis.ticks.y = element_blank(),</span></span>
<span id="cb132-356"><a href="#cb132-356" aria-hidden="true" tabindex="-1"></a><span class="in">        plot.title = element_blank()</span></span>
<span id="cb132-357"><a href="#cb132-357" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb132-358"><a href="#cb132-358" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-359"><a href="#cb132-359" aria-hidden="true" tabindex="-1"></a><span class="in">    results &lt;- list(plot = p,</span></span>
<span id="cb132-360"><a href="#cb132-360" aria-hidden="true" tabindex="-1"></a><span class="in">                    contrasts = summary_contrasts)</span></span>
<span id="cb132-361"><a href="#cb132-361" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-362"><a href="#cb132-362" aria-hidden="true" tabindex="-1"></a><span class="in">    return(results)</span></span>
<span id="cb132-363"><a href="#cb132-363" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb132-364"><a href="#cb132-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-365"><a href="#cb132-365" aria-hidden="true" tabindex="-1"></a><span class="in"># to create several posterior predictive check plots out of a brms fit</span></span>
<span id="cb132-366"><a href="#cb132-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-367"><a href="#cb132-367" aria-hidden="true" tabindex="-1"></a><span class="in">custom_ppc &lt;- function(fit, group = NULL, ndraws = 30) {</span></span>
<span id="cb132-368"><a href="#cb132-368" aria-hidden="true" tabindex="-1"></a><span class="in">  by_group  &lt;- if (!is.null(group)){</span></span>
<span id="cb132-369"><a href="#cb132-369" aria-hidden="true" tabindex="-1"></a><span class="in">    TRUE </span></span>
<span id="cb132-370"><a href="#cb132-370" aria-hidden="true" tabindex="-1"></a><span class="in">    } else</span></span>
<span id="cb132-371"><a href="#cb132-371" aria-hidden="true" tabindex="-1"></a><span class="in">    FALSE</span></span>
<span id="cb132-372"><a href="#cb132-372" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-373"><a href="#cb132-373" aria-hidden="true" tabindex="-1"></a><span class="in">  if (by_group)</span></span>
<span id="cb132-374"><a href="#cb132-374" aria-hidden="true" tabindex="-1"></a><span class="in">    by_group  &lt;-  if (any(names(fit$data) == group)){</span></span>
<span id="cb132-375"><a href="#cb132-375" aria-hidden="true" tabindex="-1"></a><span class="in">      TRUE</span></span>
<span id="cb132-376"><a href="#cb132-376" aria-hidden="true" tabindex="-1"></a><span class="in">      } else</span></span>
<span id="cb132-377"><a href="#cb132-377" aria-hidden="true" tabindex="-1"></a><span class="in">    FALSE</span></span>
<span id="cb132-378"><a href="#cb132-378" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-379"><a href="#cb132-379" aria-hidden="true" tabindex="-1"></a><span class="in">  if (by_group)</span></span>
<span id="cb132-380"><a href="#cb132-380" aria-hidden="true" tabindex="-1"></a><span class="in">    by_group &lt;-</span></span>
<span id="cb132-381"><a href="#cb132-381" aria-hidden="true" tabindex="-1"></a><span class="in">      if (is.character(fit$data[, group]) |</span></span>
<span id="cb132-382"><a href="#cb132-382" aria-hidden="true" tabindex="-1"></a><span class="in">          is.factor(fit$data[, group])){</span></span>
<span id="cb132-383"><a href="#cb132-383" aria-hidden="true" tabindex="-1"></a><span class="in">        TRUE</span></span>
<span id="cb132-384"><a href="#cb132-384" aria-hidden="true" tabindex="-1"></a><span class="in">        } else</span></span>
<span id="cb132-385"><a href="#cb132-385" aria-hidden="true" tabindex="-1"></a><span class="in">    FALSE</span></span>
<span id="cb132-386"><a href="#cb132-386" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-387"><a href="#cb132-387" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-388"><a href="#cb132-388" aria-hidden="true" tabindex="-1"></a><span class="in">  if (by_group) {</span></span>
<span id="cb132-389"><a href="#cb132-389" aria-hidden="true" tabindex="-1"></a><span class="in">    ppc_dens &lt;- pp_check(fit,</span></span>
<span id="cb132-390"><a href="#cb132-390" aria-hidden="true" tabindex="-1"></a><span class="in">                         ndraws = ndraws,</span></span>
<span id="cb132-391"><a href="#cb132-391" aria-hidden="true" tabindex="-1"></a><span class="in">                         type = 'dens_overlay_grouped',</span></span>
<span id="cb132-392"><a href="#cb132-392" aria-hidden="true" tabindex="-1"></a><span class="in">                         group = group)</span></span>
<span id="cb132-393"><a href="#cb132-393" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-394"><a href="#cb132-394" aria-hidden="true" tabindex="-1"></a><span class="in">    pp_mean &lt;- pp_check(</span></span>
<span id="cb132-395"><a href="#cb132-395" aria-hidden="true" tabindex="-1"></a><span class="in">      fit,</span></span>
<span id="cb132-396"><a href="#cb132-396" aria-hidden="true" tabindex="-1"></a><span class="in">      type = "stat_grouped",</span></span>
<span id="cb132-397"><a href="#cb132-397" aria-hidden="true" tabindex="-1"></a><span class="in">      stat = "mean",</span></span>
<span id="cb132-398"><a href="#cb132-398" aria-hidden="true" tabindex="-1"></a><span class="in">      group = group,</span></span>
<span id="cb132-399"><a href="#cb132-399" aria-hidden="true" tabindex="-1"></a><span class="in">      ndraws = ndraws</span></span>
<span id="cb132-400"><a href="#cb132-400" aria-hidden="true" tabindex="-1"></a><span class="in">    )  + theme_classic()</span></span>
<span id="cb132-401"><a href="#cb132-401" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-402"><a href="#cb132-402" aria-hidden="true" tabindex="-1"></a><span class="in">    pp_scat &lt;- pp_check(fit,</span></span>
<span id="cb132-403"><a href="#cb132-403" aria-hidden="true" tabindex="-1"></a><span class="in">                        type = "scatter_avg",</span></span>
<span id="cb132-404"><a href="#cb132-404" aria-hidden="true" tabindex="-1"></a><span class="in">                        # group = group,</span></span>
<span id="cb132-405"><a href="#cb132-405" aria-hidden="true" tabindex="-1"></a><span class="in">                        ndraws = ndraws)</span></span>
<span id="cb132-406"><a href="#cb132-406" aria-hidden="true" tabindex="-1"></a><span class="in">  } else {</span></span>
<span id="cb132-407"><a href="#cb132-407" aria-hidden="true" tabindex="-1"></a><span class="in">    ppc_dens &lt;- pp_check(fit,</span></span>
<span id="cb132-408"><a href="#cb132-408" aria-hidden="true" tabindex="-1"></a><span class="in">                         ndraws = ndraws,</span></span>
<span id="cb132-409"><a href="#cb132-409" aria-hidden="true" tabindex="-1"></a><span class="in">                         type = 'dens_overlay')</span></span>
<span id="cb132-410"><a href="#cb132-410" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-411"><a href="#cb132-411" aria-hidden="true" tabindex="-1"></a><span class="in">    pp_mean &lt;- pp_check(fit,</span></span>
<span id="cb132-412"><a href="#cb132-412" aria-hidden="true" tabindex="-1"></a><span class="in">                        type = "stat",</span></span>
<span id="cb132-413"><a href="#cb132-413" aria-hidden="true" tabindex="-1"></a><span class="in">                        stat = "mean",</span></span>
<span id="cb132-414"><a href="#cb132-414" aria-hidden="true" tabindex="-1"></a><span class="in">                        ndraws = ndraws) + theme_classic()</span></span>
<span id="cb132-415"><a href="#cb132-415" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-416"><a href="#cb132-416" aria-hidden="true" tabindex="-1"></a><span class="in">    pp_scat &lt;-  pp_check(fit,</span></span>
<span id="cb132-417"><a href="#cb132-417" aria-hidden="true" tabindex="-1"></a><span class="in">                         type = "scatter_avg",</span></span>
<span id="cb132-418"><a href="#cb132-418" aria-hidden="true" tabindex="-1"></a><span class="in">                         ndraws = ndraws)</span></span>
<span id="cb132-419"><a href="#cb132-419" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb132-420"><a href="#cb132-420" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-421"><a href="#cb132-421" aria-hidden="true" tabindex="-1"></a><span class="in">  pp_stat2 &lt;- pp_check(fit, type = "stat_2d", ndraws = ndraws)</span></span>
<span id="cb132-422"><a href="#cb132-422" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-423"><a href="#cb132-423" aria-hidden="true" tabindex="-1"></a><span class="in">  pp_plot_list &lt;-</span></span>
<span id="cb132-424"><a href="#cb132-424" aria-hidden="true" tabindex="-1"></a><span class="in">    list(ppc_dens, pp_mean, pp_scat,  pp_stat2)</span></span>
<span id="cb132-425"><a href="#cb132-425" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-426"><a href="#cb132-426" aria-hidden="true" tabindex="-1"></a><span class="in">  pp_plot_list[c(1, 3:4)] &lt;-</span></span>
<span id="cb132-427"><a href="#cb132-427" aria-hidden="true" tabindex="-1"></a><span class="in">    lapply(pp_plot_list[c(1, 3:4)], function(x)</span></span>
<span id="cb132-428"><a href="#cb132-428" aria-hidden="true" tabindex="-1"></a><span class="in">      x  + scale_color_viridis_d(</span></span>
<span id="cb132-429"><a href="#cb132-429" aria-hidden="true" tabindex="-1"></a><span class="in">        begin = 0.3,</span></span>
<span id="cb132-430"><a href="#cb132-430" aria-hidden="true" tabindex="-1"></a><span class="in">        end = 0.8,</span></span>
<span id="cb132-431"><a href="#cb132-431" aria-hidden="true" tabindex="-1"></a><span class="in">        alpha = 0.5,</span></span>
<span id="cb132-432"><a href="#cb132-432" aria-hidden="true" tabindex="-1"></a><span class="in">        option = "mako",</span></span>
<span id="cb132-433"><a href="#cb132-433" aria-hidden="true" tabindex="-1"></a><span class="in">      ) + scale_fill_viridis_d(</span></span>
<span id="cb132-434"><a href="#cb132-434" aria-hidden="true" tabindex="-1"></a><span class="in">        begin = 0.3,</span></span>
<span id="cb132-435"><a href="#cb132-435" aria-hidden="true" tabindex="-1"></a><span class="in">        end = 0.8,</span></span>
<span id="cb132-436"><a href="#cb132-436" aria-hidden="true" tabindex="-1"></a><span class="in">        alpha = 0.5,</span></span>
<span id="cb132-437"><a href="#cb132-437" aria-hidden="true" tabindex="-1"></a><span class="in">        option = "mako"</span></span>
<span id="cb132-438"><a href="#cb132-438" aria-hidden="true" tabindex="-1"></a><span class="in">      ) + theme_classic())</span></span>
<span id="cb132-439"><a href="#cb132-439" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-440"><a href="#cb132-440" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-441"><a href="#cb132-441" aria-hidden="true" tabindex="-1"></a><span class="in">  ppc_plot &lt;- plot_grid(plotlist = pp_plot_list, ncol = 2)</span></span>
<span id="cb132-442"><a href="#cb132-442" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-443"><a href="#cb132-443" aria-hidden="true" tabindex="-1"></a><span class="in">  print(ppc_plot)</span></span>
<span id="cb132-444"><a href="#cb132-444" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb132-445"><a href="#cb132-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-446"><a href="#cb132-446" aria-hidden="true" tabindex="-1"></a><span class="in">## caller sequence features</span></span>
<span id="cb132-447"><a href="#cb132-447" aria-hidden="true" tabindex="-1"></a><span class="in"># Function to calculate entropy</span></span>
<span id="cb132-448"><a href="#cb132-448" aria-hidden="true" tabindex="-1"></a><span class="in">entropy &lt;- function(sequence) {</span></span>
<span id="cb132-449"><a href="#cb132-449" aria-hidden="true" tabindex="-1"></a><span class="in">  freq &lt;- table(strsplit(sequence, NULL)[[1]])  # Frequency of each letter</span></span>
<span id="cb132-450"><a href="#cb132-450" aria-hidden="true" tabindex="-1"></a><span class="in">  prob &lt;- freq / sum(freq)  # Probability of each letter</span></span>
<span id="cb132-451"><a href="#cb132-451" aria-hidden="true" tabindex="-1"></a><span class="in">  entropy_value &lt;- -sum(prob * log2(prob))  # Shannon entropy</span></span>
<span id="cb132-452"><a href="#cb132-452" aria-hidden="true" tabindex="-1"></a><span class="in">  return(entropy_value)</span></span>
<span id="cb132-453"><a href="#cb132-453" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb132-454"><a href="#cb132-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-455"><a href="#cb132-455" aria-hidden="true" tabindex="-1"></a><span class="in"># Function to calculate normalized entropy</span></span>
<span id="cb132-456"><a href="#cb132-456" aria-hidden="true" tabindex="-1"></a><span class="in">normalized_entropy &lt;- function(sequence) {</span></span>
<span id="cb132-457"><a href="#cb132-457" aria-hidden="true" tabindex="-1"></a><span class="in">  H &lt;- entropy(sequence)</span></span>
<span id="cb132-458"><a href="#cb132-458" aria-hidden="true" tabindex="-1"></a><span class="in">  unique_elements &lt;- length(unique(strsplit(sequence, NULL)[[1]]))</span></span>
<span id="cb132-459"><a href="#cb132-459" aria-hidden="true" tabindex="-1"></a><span class="in">  max_entropy &lt;- log2(unique_elements)</span></span>
<span id="cb132-460"><a href="#cb132-460" aria-hidden="true" tabindex="-1"></a><span class="in">  H_norm &lt;- H / max_entropy</span></span>
<span id="cb132-461"><a href="#cb132-461" aria-hidden="true" tabindex="-1"></a><span class="in">  return(H_norm)</span></span>
<span id="cb132-462"><a href="#cb132-462" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb132-463"><a href="#cb132-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-464"><a href="#cb132-464" aria-hidden="true" tabindex="-1"></a><span class="in"># Function to calculate entropy of a probability distribution</span></span>
<span id="cb132-465"><a href="#cb132-465" aria-hidden="true" tabindex="-1"></a><span class="in">entropy2 &lt;- function(probs) {</span></span>
<span id="cb132-466"><a href="#cb132-466" aria-hidden="true" tabindex="-1"></a><span class="in">  non_zero_probs &lt;- probs[probs &gt; 0]  # Ignore zero probabilities</span></span>
<span id="cb132-467"><a href="#cb132-467" aria-hidden="true" tabindex="-1"></a><span class="in">  H &lt;- -sum(non_zero_probs * log2(non_zero_probs))</span></span>
<span id="cb132-468"><a href="#cb132-468" aria-hidden="true" tabindex="-1"></a><span class="in">  return(H)</span></span>
<span id="cb132-469"><a href="#cb132-469" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb132-470"><a href="#cb132-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-471"><a href="#cb132-471" aria-hidden="true" tabindex="-1"></a><span class="in"># Function to create a Markov model and calculate average entropy</span></span>
<span id="cb132-472"><a href="#cb132-472" aria-hidden="true" tabindex="-1"></a><span class="in">markov_entropy &lt;- function(sequence, normalize = FALSE) {</span></span>
<span id="cb132-473"><a href="#cb132-473" aria-hidden="true" tabindex="-1"></a><span class="in">  states &lt;- strsplit(sequence, NULL)[[1]]</span></span>
<span id="cb132-474"><a href="#cb132-474" aria-hidden="true" tabindex="-1"></a><span class="in">  transitions &lt;- table(head(states, -1), tail(states, -1))  # Transition counts</span></span>
<span id="cb132-475"><a href="#cb132-475" aria-hidden="true" tabindex="-1"></a><span class="in">  transition_probs &lt;- prop.table(transitions, 1)  # Row-wise probabilities</span></span>
<span id="cb132-476"><a href="#cb132-476" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-477"><a href="#cb132-477" aria-hidden="true" tabindex="-1"></a><span class="in">  # Calculate entropy for each row (state) in the transition matrix</span></span>
<span id="cb132-478"><a href="#cb132-478" aria-hidden="true" tabindex="-1"></a><span class="in">  state_entropies &lt;- apply(transition_probs, 1, entropy2)</span></span>
<span id="cb132-479"><a href="#cb132-479" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-480"><a href="#cb132-480" aria-hidden="true" tabindex="-1"></a><span class="in">  # Average entropy across all states</span></span>
<span id="cb132-481"><a href="#cb132-481" aria-hidden="true" tabindex="-1"></a><span class="in">  avg_entropy &lt;- mean(state_entropies, na.rm = TRUE)</span></span>
<span id="cb132-482"><a href="#cb132-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-483"><a href="#cb132-483" aria-hidden="true" tabindex="-1"></a><span class="in">  if (normalize) avg_entropy &lt;- avg_entropy / log2(length(unique(states)))</span></span>
<span id="cb132-484"><a href="#cb132-484" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-485"><a href="#cb132-485" aria-hidden="true" tabindex="-1"></a><span class="in">  return(avg_entropy)</span></span>
<span id="cb132-486"><a href="#cb132-486" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb132-487"><a href="#cb132-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-488"><a href="#cb132-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-489"><a href="#cb132-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-490"><a href="#cb132-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-491"><a href="#cb132-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-492"><a href="#cb132-492" aria-hidden="true" tabindex="-1"></a><span class="fu"># Flight coordination</span></span>
<span id="cb132-493"><a href="#cb132-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-494"><a href="#cb132-494" aria-hidden="true" tabindex="-1"></a><span class="fu">## Descriptive stats</span></span>
<span id="cb132-495"><a href="#cb132-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-496"><a href="#cb132-496" aria-hidden="true" tabindex="-1"></a>Read data:</span>
<span id="cb132-497"><a href="#cb132-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r read 50 point video tracking data}</span></span>
<span id="cb132-498"><a href="#cb132-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-499"><a href="#cb132-499" aria-hidden="true" tabindex="-1"></a><span class="in">group_traj &lt;- read.csv( "./data/raw/flight_trajectories_by_group.csv")</span></span>
<span id="cb132-500"><a href="#cb132-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-501"><a href="#cb132-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-502"><a href="#cb132-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-503"><a href="#cb132-503" aria-hidden="true" tabindex="-1"></a>Number of trails: <span class="in">`r length(unique(group_traj$video))`</span></span>
<span id="cb132-504"><a href="#cb132-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-505"><a href="#cb132-505" aria-hidden="true" tabindex="-1"></a>Group sizes:</span>
<span id="cb132-508"><a href="#cb132-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-509"><a href="#cb132-509" aria-hidden="true" tabindex="-1"></a><span class="co"># get number of individuals per group</span></span>
<span id="cb132-510"><a href="#cb132-510" aria-hidden="true" tabindex="-1"></a>n_per_group <span class="ot">&lt;-</span></span>
<span id="cb132-511"><a href="#cb132-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(<span class="fu">unique</span>(group_traj<span class="sc">$</span>group), <span class="at">USE.NAMES =</span> <span class="cn">FALSE</span>, <span class="cf">function</span>(x) {</span>
<span id="cb132-512"><a href="#cb132-512" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get those for that group</span></span>
<span id="cb132-513"><a href="#cb132-513" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> group_traj[group_traj<span class="sc">$</span>group <span class="sc">==</span> x,]</span>
<span id="cb132-514"><a href="#cb132-514" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-515"><a href="#cb132-515" aria-hidden="true" tabindex="-1"></a>    <span class="co"># count number of individuals (No NAs)</span></span>
<span id="cb132-516"><a href="#cb132-516" aria-hidden="true" tabindex="-1"></a>    n_indiv <span class="ot">&lt;-</span> (<span class="fu">sum</span>(<span class="sc">!</span><span class="fu">sapply</span>(X, anyNA)) <span class="sc">-</span> <span class="dv">3</span>) <span class="sc">/</span> <span class="dv">3</span></span>
<span id="cb132-517"><a href="#cb132-517" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb132-518"><a href="#cb132-518" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(n_indiv)</span>
<span id="cb132-519"><a href="#cb132-519" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb132-520"><a href="#cb132-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-521"><a href="#cb132-521" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(n_per_group)</span>
<span id="cb132-522"><a href="#cb132-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-523"><a href="#cb132-523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-524"><a href="#cb132-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-525"><a href="#cb132-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-526"><a href="#cb132-526" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compute pairwise distances for natural and artificial groups</span></span>
<span id="cb132-527"><a href="#cb132-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r randomization test, eval = TRUE}</span></span>
<span id="cb132-528"><a href="#cb132-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-529"><a href="#cb132-529" aria-hidden="true" tabindex="-1"></a><span class="in">pairwise_dists_list &lt;-</span></span>
<span id="cb132-530"><a href="#cb132-530" aria-hidden="true" tabindex="-1"></a><span class="in">  sapply(split(group_traj, group_traj$group), pairwise_dist, simplify = FALSE)</span></span>
<span id="cb132-531"><a href="#cb132-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-532"><a href="#cb132-532" aria-hidden="true" tabindex="-1"></a><span class="in">pairwise_dists &lt;- do.call(rbind, pairwise_dists_list)</span></span>
<span id="cb132-533"><a href="#cb132-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-534"><a href="#cb132-534" aria-hidden="true" tabindex="-1"></a><span class="in"># remove those with unlikely distance</span></span>
<span id="cb132-535"><a href="#cb132-535" aria-hidden="true" tabindex="-1"></a><span class="in">pairwise_dists &lt;- pairwise_dists[pairwise_dists$distance &gt; 0.1 &amp; pairwise_dists$distance &lt; 7, ]</span></span>
<span id="cb132-536"><a href="#cb132-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-537"><a href="#cb132-537" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-538"><a href="#cb132-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-539"><a href="#cb132-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-540"><a href="#cb132-540" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generate simulated group flight trajectories</span></span>
<span id="cb132-541"><a href="#cb132-541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb132-542"><a href="#cb132-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-543"><a href="#cb132-543" aria-hidden="true" tabindex="-1"></a><span class="in">## split into single individual trajectories</span></span>
<span id="cb132-544"><a href="#cb132-544" aria-hidden="true" tabindex="-1"></a><span class="in"># split in a list</span></span>
<span id="cb132-545"><a href="#cb132-545" aria-hidden="true" tabindex="-1"></a><span class="in">split_group_traj &lt;- split(group_traj, group_traj$group)</span></span>
<span id="cb132-546"><a href="#cb132-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-547"><a href="#cb132-547" aria-hidden="true" tabindex="-1"></a><span class="in"># get single individual trajectores</span></span>
<span id="cb132-548"><a href="#cb132-548" aria-hidden="true" tabindex="-1"></a><span class="in">indiv_traj_list &lt;- lapply(split_group_traj, function(x) {</span></span>
<span id="cb132-549"><a href="#cb132-549" aria-hidden="true" tabindex="-1"></a><span class="in">  x &lt;- x[, sapply(x, function(x)</span></span>
<span id="cb132-550"><a href="#cb132-550" aria-hidden="true" tabindex="-1"></a><span class="in">    sum(is.na(x))) &lt; 10]</span></span>
<span id="cb132-551"><a href="#cb132-551" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-552"><a href="#cb132-552" aria-hidden="true" tabindex="-1"></a><span class="in">  # get number of individuals</span></span>
<span id="cb132-553"><a href="#cb132-553" aria-hidden="true" tabindex="-1"></a><span class="in">  suppressWarnings(indv_num &lt;-</span></span>
<span id="cb132-554"><a href="#cb132-554" aria-hidden="true" tabindex="-1"></a><span class="in">                     unique(na.omit(as.numeric(</span></span>
<span id="cb132-555"><a href="#cb132-555" aria-hidden="true" tabindex="-1"></a><span class="in">                       gsub(".*?([0-9]+).*", "\\1", names(x))</span></span>
<span id="cb132-556"><a href="#cb132-556" aria-hidden="true" tabindex="-1"></a><span class="in">                     ))))</span></span>
<span id="cb132-557"><a href="#cb132-557" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-558"><a href="#cb132-558" aria-hidden="true" tabindex="-1"></a><span class="in">  indiv_trajs &lt;- lapply(indv_num, function(y)</span></span>
<span id="cb132-559"><a href="#cb132-559" aria-hidden="true" tabindex="-1"></a><span class="in">    x[, grep(y, names(x))])</span></span>
<span id="cb132-560"><a href="#cb132-560" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-561"><a href="#cb132-561" aria-hidden="true" tabindex="-1"></a><span class="in">  return(indiv_trajs)</span></span>
<span id="cb132-562"><a href="#cb132-562" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-563"><a href="#cb132-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-564"><a href="#cb132-564" aria-hidden="true" tabindex="-1"></a><span class="in">indiv_traj_list &lt;-</span></span>
<span id="cb132-565"><a href="#cb132-565" aria-hidden="true" tabindex="-1"></a><span class="in">  unlist(indiv_traj_list, recursive = FALSE, use.names = TRUE)</span></span>
<span id="cb132-566"><a href="#cb132-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-567"><a href="#cb132-567" aria-hidden="true" tabindex="-1"></a><span class="in"># remove last character of the list names so all have the original group name</span></span>
<span id="cb132-568"><a href="#cb132-568" aria-hidden="true" tabindex="-1"></a><span class="in">names(indiv_traj_list) &lt;- gsub(".$", "", names(indiv_traj_list))</span></span>
<span id="cb132-569"><a href="#cb132-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-570"><a href="#cb132-570" aria-hidden="true" tabindex="-1"></a><span class="in"># mean number of individuals per group size in original data</span></span>
<span id="cb132-571"><a href="#cb132-571" aria-hidden="true" tabindex="-1"></a><span class="in">mean_n_indiv &lt;- floor(mean(table(n_per_group)))</span></span>
<span id="cb132-572"><a href="#cb132-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-573"><a href="#cb132-573" aria-hidden="true" tabindex="-1"></a><span class="in">group_sizes &lt;- as.numeric(names(table(n_per_group)))</span></span>
<span id="cb132-574"><a href="#cb132-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-575"><a href="#cb132-575" aria-hidden="true" tabindex="-1"></a><span class="in">group_sizes &lt;- rep(group_sizes, each = mean_n_indiv)</span></span>
<span id="cb132-576"><a href="#cb132-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-577"><a href="#cb132-577" aria-hidden="true" tabindex="-1"></a><span class="in">sim_dists &lt;-</span></span>
<span id="cb132-578"><a href="#cb132-578" aria-hidden="true" tabindex="-1"></a><span class="in">  lapply(1:30, function(x) sim_group_traj(group_sizes, seed = x))</span></span>
<span id="cb132-579"><a href="#cb132-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-580"><a href="#cb132-580" aria-hidden="true" tabindex="-1"></a><span class="in">sim_trajs_list &lt;-</span></span>
<span id="cb132-581"><a href="#cb132-581" aria-hidden="true" tabindex="-1"></a><span class="in">  lapply(1:30, function(x) sim_group_traj(group_sizes, seed = x, trajectories = TRUE))</span></span>
<span id="cb132-582"><a href="#cb132-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-583"><a href="#cb132-583" aria-hidden="true" tabindex="-1"></a><span class="in"># remove those with unlikely distance</span></span>
<span id="cb132-584"><a href="#cb132-584" aria-hidden="true" tabindex="-1"></a><span class="in">sim_dists &lt;- lapply(sim_dists, function(x) {</span></span>
<span id="cb132-585"><a href="#cb132-585" aria-hidden="true" tabindex="-1"></a><span class="in">  x &lt;- x[x$distance &gt; 0.1 &amp; x$distance &lt; 7.81,]</span></span>
<span id="cb132-586"><a href="#cb132-586" aria-hidden="true" tabindex="-1"></a><span class="in">  return(x)</span></span>
<span id="cb132-587"><a href="#cb132-587" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-588"><a href="#cb132-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-589"><a href="#cb132-589" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-590"><a href="#cb132-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-591"><a href="#cb132-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-592"><a href="#cb132-592" aria-hidden="true" tabindex="-1"></a><span class="fu">## Describe data</span></span>
<span id="cb132-593"><a href="#cb132-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-594"><a href="#cb132-594" aria-hidden="true" tabindex="-1"></a>Mean distance between individuals in a group flight:</span>
<span id="cb132-597"><a href="#cb132-597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-598"><a href="#cb132-598" aria-hidden="true" tabindex="-1"></a>sim_dists_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, sim_dists)</span>
<span id="cb132-599"><a href="#cb132-599" aria-hidden="true" tabindex="-1"></a><span class="co"># mean distance by group type</span></span>
<span id="cb132-600"><a href="#cb132-600" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, sim_dists_df, mean)</span>
<span id="cb132-601"><a href="#cb132-601" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, sim_dists_df, sd)<span class="sc">$</span>distance</span>
<span id="cb132-602"><a href="#cb132-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-603"><a href="#cb132-603" aria-hidden="true" tabindex="-1"></a><span class="co"># mean distance by group type</span></span>
<span id="cb132-604"><a href="#cb132-604" aria-hidden="true" tabindex="-1"></a>agg2 <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, pairwise_dists, mean)</span>
<span id="cb132-605"><a href="#cb132-605" aria-hidden="true" tabindex="-1"></a>agg2<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, pairwise_dists, sd)<span class="sc">$</span>distance</span>
<span id="cb132-606"><a href="#cb132-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-607"><a href="#cb132-607" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(agg,agg2)</span>
<span id="cb132-608"><a href="#cb132-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-609"><a href="#cb132-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-610"><a href="#cb132-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-611"><a href="#cb132-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-612"><a href="#cb132-612" aria-hidden="true" tabindex="-1"></a>Closest distance between individuals in a group flight:</span>
<span id="cb132-615"><a href="#cb132-615" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-616"><a href="#cb132-616" aria-hidden="true" tabindex="-1"></a>sim_dists_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, sim_dists)</span>
<span id="cb132-617"><a href="#cb132-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-618"><a href="#cb132-618" aria-hidden="true" tabindex="-1"></a><span class="co"># mean distance by group type</span></span>
<span id="cb132-619"><a href="#cb132-619" aria-hidden="true" tabindex="-1"></a>agg_min <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type <span class="sc">+</span> group, sim_dists_df, min)</span>
<span id="cb132-620"><a href="#cb132-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-621"><a href="#cb132-621" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, agg_min, mean)</span>
<span id="cb132-622"><a href="#cb132-622" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, agg_min, sd)<span class="sc">$</span>distance</span>
<span id="cb132-623"><a href="#cb132-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-624"><a href="#cb132-624" aria-hidden="true" tabindex="-1"></a><span class="co"># mean distance by group type</span></span>
<span id="cb132-625"><a href="#cb132-625" aria-hidden="true" tabindex="-1"></a>agg_min2 <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type <span class="sc">+</span> group, pairwise_dists, min)</span>
<span id="cb132-626"><a href="#cb132-626" aria-hidden="true" tabindex="-1"></a>agg2 <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, agg_min2, mean)</span>
<span id="cb132-627"><a href="#cb132-627" aria-hidden="true" tabindex="-1"></a>agg2<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(distance <span class="sc">~</span> type, agg_min2, sd)<span class="sc">$</span>distance</span>
<span id="cb132-628"><a href="#cb132-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-629"><a href="#cb132-629" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(agg,agg2)</span>
<span id="cb132-630"><a href="#cb132-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-631"><a href="#cb132-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-632"><a href="#cb132-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-633"><a href="#cb132-633" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot raw data</span></span>
<span id="cb132-634"><a href="#cb132-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-635"><a href="#cb132-635" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reduce dimensionality</span></span>
<span id="cb132-636"><a href="#cb132-636" aria-hidden="true" tabindex="-1"></a><span class="fu">## Generate simulated group flight trajectories</span></span>
<span id="cb132-637"><a href="#cb132-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, warning=FALSE}</span></span>
<span id="cb132-638"><a href="#cb132-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-639"><a href="#cb132-639" aria-hidden="true" tabindex="-1"></a><span class="in">## split into single individual trajectories</span></span>
<span id="cb132-640"><a href="#cb132-640" aria-hidden="true" tabindex="-1"></a><span class="in"># split in a list</span></span>
<span id="cb132-641"><a href="#cb132-641" aria-hidden="true" tabindex="-1"></a><span class="in">split_group_traj &lt;- split(group_traj, group_traj$group)</span></span>
<span id="cb132-642"><a href="#cb132-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-643"><a href="#cb132-643" aria-hidden="true" tabindex="-1"></a><span class="in"># pca fun</span></span>
<span id="cb132-644"><a href="#cb132-644" aria-hidden="true" tabindex="-1"></a><span class="in">fun1 &lt;- function(x) prcomp(x, center = FALSE, scale. = FALSE)$x[,1]</span></span>
<span id="cb132-645"><a href="#cb132-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-646"><a href="#cb132-646" aria-hidden="true" tabindex="-1"></a><span class="in"># horizontal plane fun</span></span>
<span id="cb132-647"><a href="#cb132-647" aria-hidden="true" tabindex="-1"></a><span class="in"># fun1 &lt;- function(x) x[,3]</span></span>
<span id="cb132-648"><a href="#cb132-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-649"><a href="#cb132-649" aria-hidden="true" tabindex="-1"></a><span class="in">indiv_traj_pc1 &lt;- lapply(indiv_traj_list, fun1)</span></span>
<span id="cb132-650"><a href="#cb132-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-651"><a href="#cb132-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-652"><a href="#cb132-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-653"><a href="#cb132-653" aria-hidden="true" tabindex="-1"></a><span class="in">pca_list &lt;- lapply(unique(names(indiv_traj_pc1)), function(x){</span></span>
<span id="cb132-654"><a href="#cb132-654" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-655"><a href="#cb132-655" aria-hidden="true" tabindex="-1"></a><span class="in">  pca_df &lt;- data.frame(indiv_traj_pc1[names(indiv_traj_pc1) == x])</span></span>
<span id="cb132-656"><a href="#cb132-656" aria-hidden="true" tabindex="-1"></a><span class="in">  names(pca_df) &lt;- paste0("ind", 1:ncol(pca_df))</span></span>
<span id="cb132-657"><a href="#cb132-657" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-658"><a href="#cb132-658" aria-hidden="true" tabindex="-1"></a><span class="in">  stacked_pca_df &lt;- stack(pca_df)</span></span>
<span id="cb132-659"><a href="#cb132-659" aria-hidden="true" tabindex="-1"></a><span class="in">  stacked_pca_df$frame &lt;- 1:nrow(pca_df)</span></span>
<span id="cb132-660"><a href="#cb132-660" aria-hidden="true" tabindex="-1"></a><span class="in">  stacked_pca_df$group &lt;- x </span></span>
<span id="cb132-661"><a href="#cb132-661" aria-hidden="true" tabindex="-1"></a><span class="in">  stacked_pca_df$group.size &lt;- ncol(pca_df)</span></span>
<span id="cb132-662"><a href="#cb132-662" aria-hidden="true" tabindex="-1"></a><span class="in">  return(stacked_pca_df)</span></span>
<span id="cb132-663"><a href="#cb132-663" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-664"><a href="#cb132-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-665"><a href="#cb132-665" aria-hidden="true" tabindex="-1"></a><span class="in">pca_df &lt;- do.call(rbind, pca_list)</span></span>
<span id="cb132-666"><a href="#cb132-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-667"><a href="#cb132-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-668"><a href="#cb132-668" aria-hidden="true" tabindex="-1"></a><span class="in"># for simulated data</span></span>
<span id="cb132-669"><a href="#cb132-669" aria-hidden="true" tabindex="-1"></a><span class="in">sim_traj_pc1 &lt;- lapply(sim_trajs_list[[1]], function(x) x[,3])</span></span>
<span id="cb132-670"><a href="#cb132-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-671"><a href="#cb132-671" aria-hidden="true" tabindex="-1"></a><span class="in"># pca_sim_list &lt;- lapply(unique, function(x){</span></span>
<span id="cb132-672"><a href="#cb132-672" aria-hidden="true" tabindex="-1"></a><span class="in">pca_sim_list &lt;- lapply(paste("sim", 1:30, "", sep = "-"), function(x){</span></span>
<span id="cb132-673"><a href="#cb132-673" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-674"><a href="#cb132-674" aria-hidden="true" tabindex="-1"></a><span class="in">  pca_df &lt;- data.frame(sim_traj_pc1[grep(pattern = x, names(sim_traj_pc1))])</span></span>
<span id="cb132-675"><a href="#cb132-675" aria-hidden="true" tabindex="-1"></a><span class="in">  names(pca_df) &lt;- paste0("ind", 1:ncol(pca_df))</span></span>
<span id="cb132-676"><a href="#cb132-676" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-677"><a href="#cb132-677" aria-hidden="true" tabindex="-1"></a><span class="in">  stacked_pca_df &lt;- stack(pca_df)</span></span>
<span id="cb132-678"><a href="#cb132-678" aria-hidden="true" tabindex="-1"></a><span class="in">  stacked_pca_df$frame &lt;- 1:nrow(pca_df)</span></span>
<span id="cb132-679"><a href="#cb132-679" aria-hidden="true" tabindex="-1"></a><span class="in">  stacked_pca_df$group &lt;- x </span></span>
<span id="cb132-680"><a href="#cb132-680" aria-hidden="true" tabindex="-1"></a><span class="in">  stacked_pca_df$group.size &lt;- ncol(pca_df)</span></span>
<span id="cb132-681"><a href="#cb132-681" aria-hidden="true" tabindex="-1"></a><span class="in">  return(stacked_pca_df)</span></span>
<span id="cb132-682"><a href="#cb132-682" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-683"><a href="#cb132-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-684"><a href="#cb132-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-685"><a href="#cb132-685" aria-hidden="true" tabindex="-1"></a><span class="in">pca_sim_df &lt;- do.call(rbind, pca_sim_list)</span></span>
<span id="cb132-686"><a href="#cb132-686" aria-hidden="true" tabindex="-1"></a><span class="in">pca_sim_df$type &lt;- "simulated"</span></span>
<span id="cb132-687"><a href="#cb132-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-688"><a href="#cb132-688" aria-hidden="true" tabindex="-1"></a><span class="in">pca_df$type &lt;- sapply(pca_df$group, function(x) pairwise_dists$type[group_traj$group == x][1])</span></span>
<span id="cb132-689"><a href="#cb132-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-690"><a href="#cb132-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-691"><a href="#cb132-691" aria-hidden="true" tabindex="-1"></a><span class="in">#bind</span></span>
<span id="cb132-692"><a href="#cb132-692" aria-hidden="true" tabindex="-1"></a><span class="in">pca_df &lt;- rbind(pca_df, pca_sim_df)</span></span>
<span id="cb132-693"><a href="#cb132-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-694"><a href="#cb132-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-695"><a href="#cb132-695" aria-hidden="true" tabindex="-1"></a><span class="in"># order groups by type</span></span>
<span id="cb132-696"><a href="#cb132-696" aria-hidden="true" tabindex="-1"></a><span class="in">pca_df$group &lt;- factor(pca_df$group, levels = unique(pca_df$group[order(pca_df$type)]))</span></span>
<span id="cb132-697"><a href="#cb132-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-698"><a href="#cb132-698" aria-hidden="true" tabindex="-1"></a><span class="in">pca_df &lt;- pca_df[complete.cases(pca_df), ]</span></span>
<span id="cb132-699"><a href="#cb132-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-700"><a href="#cb132-700" aria-hidden="true" tabindex="-1"></a><span class="in">pca_df$type &lt;- factor(pca_df$type, levels = c("natural", "artificial", "simulated"))</span></span>
<span id="cb132-701"><a href="#cb132-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-702"><a href="#cb132-702" aria-hidden="true" tabindex="-1"></a><span class="in"># table(pca_df$type, pca_df$group.size)</span></span>
<span id="cb132-703"><a href="#cb132-703" aria-hidden="true" tabindex="-1"></a><span class="in">#get 3 names of group for each type level</span></span>
<span id="cb132-704"><a href="#cb132-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-705"><a href="#cb132-705" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb132-706"><a href="#cb132-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-707"><a href="#cb132-707" aria-hidden="true" tabindex="-1"></a><span class="in">selected_groups &lt;- lapply(unique(pca_df$type), function(x) {</span></span>
<span id="cb132-708"><a href="#cb132-708" aria-hidden="true" tabindex="-1"></a><span class="in">  unique(pca_df$group[pca_df$type == x &amp; pca_df$group.size == 4])[1:3]</span></span>
<span id="cb132-709"><a href="#cb132-709" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-710"><a href="#cb132-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-711"><a href="#cb132-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-712"><a href="#cb132-712" aria-hidden="true" tabindex="-1"></a><span class="in">pca_df &lt;- pca_df[pca_df$frame &lt; 26, ]</span></span>
<span id="cb132-713"><a href="#cb132-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-714"><a href="#cb132-714" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(pca_df[pca_df$group %in% unlist(selected_groups), ], aes(x = frame, y = values, group = ind, color = type)) + </span></span>
<span id="cb132-715"><a href="#cb132-715" aria-hidden="true" tabindex="-1"></a><span class="in">  # geom_point() + </span></span>
<span id="cb132-716"><a href="#cb132-716" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_smooth(se = FALSE, span = 0.3) + </span></span>
<span id="cb132-717"><a href="#cb132-717" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic() + </span></span>
<span id="cb132-718"><a href="#cb132-718" aria-hidden="true" tabindex="-1"></a><span class="in">  # theme(legend.position = "none") + </span></span>
<span id="cb132-719"><a href="#cb132-719" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Frame", y = "Horizontal plane\nposition (m)") +</span></span>
<span id="cb132-720"><a href="#cb132-720" aria-hidden="true" tabindex="-1"></a><span class="in">  # ylim(c = c(-3, 3)) +</span></span>
<span id="cb132-721"><a href="#cb132-721" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap( dir = "v",</span></span>
<span id="cb132-722"><a href="#cb132-722" aria-hidden="true" tabindex="-1"></a><span class="in">        type~ group, #scales = "free_y",</span></span>
<span id="cb132-723"><a href="#cb132-723" aria-hidden="true" tabindex="-1"></a><span class="in">        ncol = 3) +</span></span>
<span id="cb132-724"><a href="#cb132-724" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb132-725"><a href="#cb132-725" aria-hidden="true" tabindex="-1"></a><span class="in">  strip.background = element_blank(),</span></span>
<span id="cb132-726"><a href="#cb132-726" aria-hidden="true" tabindex="-1"></a><span class="in">  strip.text.x = element_blank()</span></span>
<span id="cb132-727"><a href="#cb132-727" aria-hidden="true" tabindex="-1"></a><span class="in">) +</span></span>
<span id="cb132-728"><a href="#cb132-728" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_color_viridis_d(option = "G",</span></span>
<span id="cb132-729"><a href="#cb132-729" aria-hidden="true" tabindex="-1"></a><span class="in">                           end = 0.8,</span></span>
<span id="cb132-730"><a href="#cb132-730" aria-hidden="true" tabindex="-1"></a><span class="in">                           alpha = 0.6)</span></span>
<span id="cb132-731"><a href="#cb132-731" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb132-732"><a href="#cb132-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-733"><a href="#cb132-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-734"><a href="#cb132-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-735"><a href="#cb132-735" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-736"><a href="#cb132-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-737"><a href="#cb132-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-738"><a href="#cb132-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-739"><a href="#cb132-739" aria-hidden="true" tabindex="-1"></a><span class="fu">### Raw distances</span></span>
<span id="cb132-740"><a href="#cb132-740" aria-hidden="true" tabindex="-1"></a>All group sizes combined:</span>
<span id="cb132-741"><a href="#cb132-741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-742"><a href="#cb132-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-743"><a href="#cb132-743" aria-hidden="true" tabindex="-1"></a><span class="in"># add original data to simulated data and calculate proximity</span></span>
<span id="cb132-744"><a href="#cb132-744" aria-hidden="true" tabindex="-1"></a><span class="in">nat_sim_dist_list &lt;- lapply(sim_dists, function(x) {</span></span>
<span id="cb132-745"><a href="#cb132-745" aria-hidden="true" tabindex="-1"></a><span class="in">  return(rbind(x, pairwise_dists))</span></span>
<span id="cb132-746"><a href="#cb132-746" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-747"><a href="#cb132-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-748"><a href="#cb132-748" aria-hidden="true" tabindex="-1"></a><span class="in"># remove distances above 10 m</span></span>
<span id="cb132-749"><a href="#cb132-749" aria-hidden="true" tabindex="-1"></a><span class="in">nat_sim_dist_list &lt;- lapply(nat_sim_dist_list, function(x) {</span></span>
<span id="cb132-750"><a href="#cb132-750" aria-hidden="true" tabindex="-1"></a><span class="in">  x &lt;- x[x$distance &lt; 10, ]</span></span>
<span id="cb132-751"><a href="#cb132-751" aria-hidden="true" tabindex="-1"></a><span class="in">  x$type &lt;-</span></span>
<span id="cb132-752"><a href="#cb132-752" aria-hidden="true" tabindex="-1"></a><span class="in">    factor(x$type, levels = c("natural", "artificial", "simulated"))</span></span>
<span id="cb132-753"><a href="#cb132-753" aria-hidden="true" tabindex="-1"></a><span class="in">  return(x)</span></span>
<span id="cb132-754"><a href="#cb132-754" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-755"><a href="#cb132-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-756"><a href="#cb132-756" aria-hidden="true" tabindex="-1"></a><span class="in">dat_all &lt;- dat &lt;- nat_sim_dist_list[[1]]</span></span>
<span id="cb132-757"><a href="#cb132-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-758"><a href="#cb132-758" aria-hidden="true" tabindex="-1"></a><span class="in">dat_all$group.size &lt;- "All sizes"</span></span>
<span id="cb132-759"><a href="#cb132-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-760"><a href="#cb132-760" aria-hidden="true" tabindex="-1"></a><span class="in">dat &lt;- rbind(dat, dat_all)</span></span>
<span id="cb132-761"><a href="#cb132-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-762"><a href="#cb132-762" aria-hidden="true" tabindex="-1"></a><span class="in">dat$group.size.factor &lt;-</span></span>
<span id="cb132-763"><a href="#cb132-763" aria-hidden="true" tabindex="-1"></a><span class="in">  factor(dat$group.size, levels = c(1:10, "All sizes"))</span></span>
<span id="cb132-764"><a href="#cb132-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-765"><a href="#cb132-765" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps &lt;-</span></span>
<span id="cb132-766"><a href="#cb132-766" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(group ~ group.size.factor + type, dat, function(x)</span></span>
<span id="cb132-767"><a href="#cb132-767" aria-hidden="true" tabindex="-1"></a><span class="in">    length(unique(x)))</span></span>
<span id="cb132-768"><a href="#cb132-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-769"><a href="#cb132-769" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$frames &lt;-</span></span>
<span id="cb132-770"><a href="#cb132-770" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(group ~ group.size.factor + type, dat, function(x)</span></span>
<span id="cb132-771"><a href="#cb132-771" aria-hidden="true" tabindex="-1"></a><span class="in">    length(x))$group</span></span>
<span id="cb132-772"><a href="#cb132-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-773"><a href="#cb132-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-774"><a href="#cb132-774" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$indivs &lt;-</span></span>
<span id="cb132-775"><a href="#cb132-775" aria-hidden="true" tabindex="-1"></a><span class="in">  n_grps$group * as.numeric(as.character(n_grps$group.size.factor))</span></span>
<span id="cb132-776"><a href="#cb132-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-777"><a href="#cb132-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-778"><a href="#cb132-778" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$group.size.factor &lt;- factor(n_grps$group.size.factor)</span></span>
<span id="cb132-779"><a href="#cb132-779" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$distance &lt;-</span></span>
<span id="cb132-780"><a href="#cb132-780" aria-hidden="true" tabindex="-1"></a><span class="in">  ifelse(n_grps$group.size.factor %in% 2:3,-1.2,-0.9)</span></span>
<span id="cb132-781"><a href="#cb132-781" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$distance[1] &lt;- -0.8</span></span>
<span id="cb132-782"><a href="#cb132-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-783"><a href="#cb132-783" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$indivs[n_grps$group.size.factor == "All sizes"] &lt;-</span></span>
<span id="cb132-784"><a href="#cb132-784" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(indivs ~ type, n_grps, sum)$indivs</span></span>
<span id="cb132-785"><a href="#cb132-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-786"><a href="#cb132-786" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$n.labels &lt;-</span></span>
<span id="cb132-787"><a href="#cb132-787" aria-hidden="true" tabindex="-1"></a><span class="in">  paste0(n_grps$group, " / ", n_grps$indivs, " / ", n_grps$frames)</span></span>
<span id="cb132-788"><a href="#cb132-788" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$n.labels[1] &lt;-</span></span>
<span id="cb132-789"><a href="#cb132-789" aria-hidden="true" tabindex="-1"></a><span class="in">  " n = 3 groups /\n 6 individuals /\n 149 frames"</span></span>
<span id="cb132-790"><a href="#cb132-790" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$n.labels[6] &lt;-</span></span>
<span id="cb132-791"><a href="#cb132-791" aria-hidden="true" tabindex="-1"></a><span class="in">  " n = 18 groups /\n 74 individuals /\n 888 frames"</span></span>
<span id="cb132-792"><a href="#cb132-792" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$distance[6] &lt;- -0.3</span></span>
<span id="cb132-793"><a href="#cb132-793" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$distance[c(11, 17)] &lt;- -0.4</span></span>
<span id="cb132-794"><a href="#cb132-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-795"><a href="#cb132-795" aria-hidden="true" tabindex="-1"></a><span class="in">custom_labels &lt;- unique(nat_sim_dist_list[[1]]$group.size)</span></span>
<span id="cb132-796"><a href="#cb132-796" aria-hidden="true" tabindex="-1"></a><span class="in">custom_labels &lt;-</span></span>
<span id="cb132-797"><a href="#cb132-797" aria-hidden="true" tabindex="-1"></a><span class="in">  paste(c("Group size = ", rep("", 5)), custom_labels)</span></span>
<span id="cb132-798"><a href="#cb132-798" aria-hidden="true" tabindex="-1"></a><span class="in">names(custom_labels) &lt;- unique(nat_sim_dist_list[[1]]$group.size)</span></span>
<span id="cb132-799"><a href="#cb132-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-800"><a href="#cb132-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-801"><a href="#cb132-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-802"><a href="#cb132-802" aria-hidden="true" tabindex="-1"></a><span class="in">custom_labels &lt;- unique(dat$group.size)</span></span>
<span id="cb132-803"><a href="#cb132-803" aria-hidden="true" tabindex="-1"></a><span class="in">custom_labels &lt;-</span></span>
<span id="cb132-804"><a href="#cb132-804" aria-hidden="true" tabindex="-1"></a><span class="in">  paste(c("Group size = ", rep("", 5)), custom_labels)</span></span>
<span id="cb132-805"><a href="#cb132-805" aria-hidden="true" tabindex="-1"></a><span class="in">names(custom_labels) &lt;- unique(dat$group.size)</span></span>
<span id="cb132-806"><a href="#cb132-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-807"><a href="#cb132-807" aria-hidden="true" tabindex="-1"></a><span class="in"># mean distance by group type</span></span>
<span id="cb132-808"><a href="#cb132-808" aria-hidden="true" tabindex="-1"></a><span class="in">agg_gp &lt;-</span></span>
<span id="cb132-809"><a href="#cb132-809" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(distance ~ type + group + group.size.factor, dat, mean)</span></span>
<span id="cb132-810"><a href="#cb132-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-811"><a href="#cb132-811" aria-hidden="true" tabindex="-1"></a><span class="in">agg_gp$group.size.factor &lt;- factor(agg_gp$group.size.factor)</span></span>
<span id="cb132-812"><a href="#cb132-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-813"><a href="#cb132-813" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-814"><a href="#cb132-814" aria-hidden="true" tabindex="-1"></a><span class="in">gg_all &lt;- ggplot(dat[dat$group.size == "All sizes", ],</span></span>
<span id="cb132-815"><a href="#cb132-815" aria-hidden="true" tabindex="-1"></a><span class="in">                 aes(</span></span>
<span id="cb132-816"><a href="#cb132-816" aria-hidden="true" tabindex="-1"></a><span class="in">                   y = distance,</span></span>
<span id="cb132-817"><a href="#cb132-817" aria-hidden="true" tabindex="-1"></a><span class="in">                   x = type,</span></span>
<span id="cb132-818"><a href="#cb132-818" aria-hidden="true" tabindex="-1"></a><span class="in">                   color = type,</span></span>
<span id="cb132-819"><a href="#cb132-819" aria-hidden="true" tabindex="-1"></a><span class="in">                   fill = type</span></span>
<span id="cb132-820"><a href="#cb132-820" aria-hidden="true" tabindex="-1"></a><span class="in">                 )) +</span></span>
<span id="cb132-821"><a href="#cb132-821" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_signif(</span></span>
<span id="cb132-822"><a href="#cb132-822" aria-hidden="true" tabindex="-1"></a><span class="in">    y_position = c(4.35, 4.75),</span></span>
<span id="cb132-823"><a href="#cb132-823" aria-hidden="true" tabindex="-1"></a><span class="in">    xmin = c(1, 1),</span></span>
<span id="cb132-824"><a href="#cb132-824" aria-hidden="true" tabindex="-1"></a><span class="in">    xmax = c(2, 3),</span></span>
<span id="cb132-825"><a href="#cb132-825" aria-hidden="true" tabindex="-1"></a><span class="in">    annotation = c('beta:0.32~ (0.19 - 0.45)', 'beta:0.36~ (0.24 - 0.47)'), </span></span>
<span id="cb132-826"><a href="#cb132-826" aria-hidden="true" tabindex="-1"></a><span class="in">    parse = TRUE,</span></span>
<span id="cb132-827"><a href="#cb132-827" aria-hidden="true" tabindex="-1"></a><span class="in">    tip_length = 0.02,</span></span>
<span id="cb132-828"><a href="#cb132-828" aria-hidden="true" tabindex="-1"></a><span class="in">    textsize = 3,</span></span>
<span id="cb132-829"><a href="#cb132-829" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 0.5,</span></span>
<span id="cb132-830"><a href="#cb132-830" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "gray60",</span></span>
<span id="cb132-831"><a href="#cb132-831" aria-hidden="true" tabindex="-1"></a><span class="in">    vjust = 0.2</span></span>
<span id="cb132-832"><a href="#cb132-832" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-833"><a href="#cb132-833" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-834"><a href="#cb132-834" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-835"><a href="#cb132-835" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-836"><a href="#cb132-836" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-837"><a href="#cb132-837" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-838"><a href="#cb132-838" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-839"><a href="#cb132-839" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-840"><a href="#cb132-840" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-841"><a href="#cb132-841" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-842"><a href="#cb132-842" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-843"><a href="#cb132-843" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-844"><a href="#cb132-844" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-845"><a href="#cb132-845" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-846"><a href="#cb132-846" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-847"><a href="#cb132-847" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-848"><a href="#cb132-848" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-849"><a href="#cb132-849" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-850"><a href="#cb132-850" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(</span></span>
<span id="cb132-851"><a href="#cb132-851" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = adjustcolor("orange", alpha.f = 0.1),</span></span>
<span id="cb132-852"><a href="#cb132-852" aria-hidden="true" tabindex="-1"></a><span class="in">    data = agg_gp[!agg_gp$group.size %in% 2:5,],</span></span>
<span id="cb132-853"><a href="#cb132-853" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(y = distance, x = type),</span></span>
<span id="cb132-854"><a href="#cb132-854" aria-hidden="true" tabindex="-1"></a><span class="in">    color = adjustcolor("orange", alpha.f = 0.6),</span></span>
<span id="cb132-855"><a href="#cb132-855" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .1,</span></span>
<span id="cb132-856"><a href="#cb132-856" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-857"><a href="#cb132-857" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA</span></span>
<span id="cb132-858"><a href="#cb132-858" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-859"><a href="#cb132-859" aria-hidden="true" tabindex="-1"></a><span class="in">  # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-860"><a href="#cb132-860" aria-hidden="true" tabindex="-1"></a><span class="in">  gghalves::geom_half_point(</span></span>
<span id="cb132-861"><a href="#cb132-861" aria-hidden="true" tabindex="-1"></a><span class="in">    # color = fill_color,</span></span>
<span id="cb132-862"><a href="#cb132-862" aria-hidden="true" tabindex="-1"></a><span class="in">    # draw jitter on the left</span></span>
<span id="cb132-863"><a href="#cb132-863" aria-hidden="true" tabindex="-1"></a><span class="in">    side = "l",</span></span>
<span id="cb132-864"><a href="#cb132-864" aria-hidden="true" tabindex="-1"></a><span class="in">    # control range of jitter</span></span>
<span id="cb132-865"><a href="#cb132-865" aria-hidden="true" tabindex="-1"></a><span class="in">    range_scale = .4,</span></span>
<span id="cb132-866"><a href="#cb132-866" aria-hidden="true" tabindex="-1"></a><span class="in">    # add some transparency</span></span>
<span id="cb132-867"><a href="#cb132-867" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = .5,</span></span>
<span id="cb132-868"><a href="#cb132-868" aria-hidden="true" tabindex="-1"></a><span class="in">    transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-869"><a href="#cb132-869" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-870"><a href="#cb132-870" aria-hidden="true" tabindex="-1"></a><span class="in">  # scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-871"><a href="#cb132-871" aria-hidden="true" tabindex="-1"></a><span class="in">  # scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-872"><a href="#cb132-872" aria-hidden="true" tabindex="-1"></a><span class="in">  #                      end = 0.8,</span></span>
<span id="cb132-873"><a href="#cb132-873" aria-hidden="true" tabindex="-1"></a><span class="in">  #                      alpha = 0.6) +</span></span>
<span id="cb132-874"><a href="#cb132-874" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values = graph_cols[2:4]) +</span></span>
<span id="cb132-875"><a href="#cb132-875" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = graph_cols_transp[2:4]) +</span></span>
<span id="cb132-876"><a href="#cb132-876" aria-hidden="true" tabindex="-1"></a><span class="in">  gghalves::geom_half_point(</span></span>
<span id="cb132-877"><a href="#cb132-877" aria-hidden="true" tabindex="-1"></a><span class="in">    data = agg_gp[agg_gp$group.size != "All sizes", ],</span></span>
<span id="cb132-878"><a href="#cb132-878" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(y = distance, x = type),</span></span>
<span id="cb132-879"><a href="#cb132-879" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "orange",</span></span>
<span id="cb132-880"><a href="#cb132-880" aria-hidden="true" tabindex="-1"></a><span class="in">    # draw jitter on the left</span></span>
<span id="cb132-881"><a href="#cb132-881" aria-hidden="true" tabindex="-1"></a><span class="in">    side = "l",</span></span>
<span id="cb132-882"><a href="#cb132-882" aria-hidden="true" tabindex="-1"></a><span class="in">    pch = 20,</span></span>
<span id="cb132-883"><a href="#cb132-883" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 4,</span></span>
<span id="cb132-884"><a href="#cb132-884" aria-hidden="true" tabindex="-1"></a><span class="in">    # control range of jitter</span></span>
<span id="cb132-885"><a href="#cb132-885" aria-hidden="true" tabindex="-1"></a><span class="in">    range_scale = .4,</span></span>
<span id="cb132-886"><a href="#cb132-886" aria-hidden="true" tabindex="-1"></a><span class="in">    # add some transparency</span></span>
<span id="cb132-887"><a href="#cb132-887" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = .5,</span></span>
<span id="cb132-888"><a href="#cb132-888" aria-hidden="true" tabindex="-1"></a><span class="in">    transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-889"><a href="#cb132-889" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-890"><a href="#cb132-890" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(c(-0.4, 4.8)) +</span></span>
<span id="cb132-891"><a href="#cb132-891" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c(</span></span>
<span id="cb132-892"><a href="#cb132-892" aria-hidden="true" tabindex="-1"></a><span class="in">    "natural" = "Natural",</span></span>
<span id="cb132-893"><a href="#cb132-893" aria-hidden="true" tabindex="-1"></a><span class="in">    "artificial" = "Artificial",</span></span>
<span id="cb132-894"><a href="#cb132-894" aria-hidden="true" tabindex="-1"></a><span class="in">    "simulated" = "Simulated"</span></span>
<span id="cb132-895"><a href="#cb132-895" aria-hidden="true" tabindex="-1"></a><span class="in">  )) +</span></span>
<span id="cb132-896"><a href="#cb132-896" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none") +</span></span>
<span id="cb132-897"><a href="#cb132-897" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Flight type", y = "Distance (m)") +</span></span>
<span id="cb132-898"><a href="#cb132-898" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ group.size,</span></span>
<span id="cb132-899"><a href="#cb132-899" aria-hidden="true" tabindex="-1"></a><span class="in">             ncol = 1,</span></span>
<span id="cb132-900"><a href="#cb132-900" aria-hidden="true" tabindex="-1"></a><span class="in">             labeller = labeller(group.size = c("All sizes" = "All group sizes"))) +</span></span>
<span id="cb132-901"><a href="#cb132-901" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(lineheight = 0.8,</span></span>
<span id="cb132-902"><a href="#cb132-902" aria-hidden="true" tabindex="-1"></a><span class="in">    data = n_grps[!n_grps$group.size.factor %in% 2:6, ],</span></span>
<span id="cb132-903"><a href="#cb132-903" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(y = distance, x = type, label = n.labels),</span></span>
<span id="cb132-904"><a href="#cb132-904" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "gray60",</span></span>
<span id="cb132-905"><a href="#cb132-905" aria-hidden="true" tabindex="-1"></a><span class="in">    nudge_x = 0,</span></span>
<span id="cb132-906"><a href="#cb132-906" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 3</span></span>
<span id="cb132-907"><a href="#cb132-907" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-908"><a href="#cb132-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-909"><a href="#cb132-909" aria-hidden="true" tabindex="-1"></a><span class="in"># add significance</span></span>
<span id="cb132-910"><a href="#cb132-910" aria-hidden="true" tabindex="-1"></a><span class="in">gg_all</span></span>
<span id="cb132-911"><a href="#cb132-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-912"><a href="#cb132-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-913"><a href="#cb132-913" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-914"><a href="#cb132-914" aria-hidden="true" tabindex="-1"></a><span class="in">gg_gs &lt;- ggplot(dat[dat$group.size %in% 2:5,],</span></span>
<span id="cb132-915"><a href="#cb132-915" aria-hidden="true" tabindex="-1"></a><span class="in">                aes(</span></span>
<span id="cb132-916"><a href="#cb132-916" aria-hidden="true" tabindex="-1"></a><span class="in">                  y = distance,</span></span>
<span id="cb132-917"><a href="#cb132-917" aria-hidden="true" tabindex="-1"></a><span class="in">                  x = type,</span></span>
<span id="cb132-918"><a href="#cb132-918" aria-hidden="true" tabindex="-1"></a><span class="in">                  color = type,</span></span>
<span id="cb132-919"><a href="#cb132-919" aria-hidden="true" tabindex="-1"></a><span class="in">                  fill = type</span></span>
<span id="cb132-920"><a href="#cb132-920" aria-hidden="true" tabindex="-1"></a><span class="in">                )) +</span></span>
<span id="cb132-921"><a href="#cb132-921" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-922"><a href="#cb132-922" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-923"><a href="#cb132-923" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-924"><a href="#cb132-924" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.6,</span></span>
<span id="cb132-925"><a href="#cb132-925" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-926"><a href="#cb132-926" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-927"><a href="#cb132-927" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-928"><a href="#cb132-928" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-929"><a href="#cb132-929" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-930"><a href="#cb132-930" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-931"><a href="#cb132-931" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-932"><a href="#cb132-932" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-933"><a href="#cb132-933" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-934"><a href="#cb132-934" aria-hidden="true" tabindex="-1"></a><span class="in">  # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-935"><a href="#cb132-935" aria-hidden="true" tabindex="-1"></a><span class="in">  gghalves::geom_half_point(</span></span>
<span id="cb132-936"><a href="#cb132-936" aria-hidden="true" tabindex="-1"></a><span class="in">    # color = fill_color,</span></span>
<span id="cb132-937"><a href="#cb132-937" aria-hidden="true" tabindex="-1"></a><span class="in">    # draw jitter on the left</span></span>
<span id="cb132-938"><a href="#cb132-938" aria-hidden="true" tabindex="-1"></a><span class="in">    side = "l",</span></span>
<span id="cb132-939"><a href="#cb132-939" aria-hidden="true" tabindex="-1"></a><span class="in">    # control range of jitter</span></span>
<span id="cb132-940"><a href="#cb132-940" aria-hidden="true" tabindex="-1"></a><span class="in">    range_scale = .4,</span></span>
<span id="cb132-941"><a href="#cb132-941" aria-hidden="true" tabindex="-1"></a><span class="in">    # add some transparency</span></span>
<span id="cb132-942"><a href="#cb132-942" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = .3,</span></span>
<span id="cb132-943"><a href="#cb132-943" aria-hidden="true" tabindex="-1"></a><span class="in">    transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-944"><a href="#cb132-944" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-945"><a href="#cb132-945" aria-hidden="true" tabindex="-1"></a><span class="in">  # scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-946"><a href="#cb132-946" aria-hidden="true" tabindex="-1"></a><span class="in">  # scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-947"><a href="#cb132-947" aria-hidden="true" tabindex="-1"></a><span class="in">  #                      end = 0.8,</span></span>
<span id="cb132-948"><a href="#cb132-948" aria-hidden="true" tabindex="-1"></a><span class="in">  #                      alpha = 0.6) +</span></span>
<span id="cb132-949"><a href="#cb132-949" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = graph_cols[2:4]) +</span></span>
<span id="cb132-950"><a href="#cb132-950" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = graph_cols_transp[2:4]) +</span></span>
<span id="cb132-951"><a href="#cb132-951" aria-hidden="true" tabindex="-1"></a><span class="in">  gghalves::geom_half_point(</span></span>
<span id="cb132-952"><a href="#cb132-952" aria-hidden="true" tabindex="-1"></a><span class="in">    data = agg_gp[agg_gp$group.size %in% 2:5, ],</span></span>
<span id="cb132-953"><a href="#cb132-953" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(y = distance, x = type),</span></span>
<span id="cb132-954"><a href="#cb132-954" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "orange",</span></span>
<span id="cb132-955"><a href="#cb132-955" aria-hidden="true" tabindex="-1"></a><span class="in">    # draw jitter on the left</span></span>
<span id="cb132-956"><a href="#cb132-956" aria-hidden="true" tabindex="-1"></a><span class="in">    side = "l",</span></span>
<span id="cb132-957"><a href="#cb132-957" aria-hidden="true" tabindex="-1"></a><span class="in">    pch = 20,</span></span>
<span id="cb132-958"><a href="#cb132-958" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 4,</span></span>
<span id="cb132-959"><a href="#cb132-959" aria-hidden="true" tabindex="-1"></a><span class="in">    # control range of jitter</span></span>
<span id="cb132-960"><a href="#cb132-960" aria-hidden="true" tabindex="-1"></a><span class="in">    range_scale = .4,</span></span>
<span id="cb132-961"><a href="#cb132-961" aria-hidden="true" tabindex="-1"></a><span class="in">    # add some transparency</span></span>
<span id="cb132-962"><a href="#cb132-962" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = .5,</span></span>
<span id="cb132-963"><a href="#cb132-963" aria-hidden="true" tabindex="-1"></a><span class="in">    transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-964"><a href="#cb132-964" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-965"><a href="#cb132-965" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-966"><a href="#cb132-966" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-967"><a href="#cb132-967" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-968"><a href="#cb132-968" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-969"><a href="#cb132-969" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(</span></span>
<span id="cb132-970"><a href="#cb132-970" aria-hidden="true" tabindex="-1"></a><span class="in">     fill = adjustcolor("orange", alpha.f = 0.1),</span></span>
<span id="cb132-971"><a href="#cb132-971" aria-hidden="true" tabindex="-1"></a><span class="in">    data = agg_gp[agg_gp$group.size %in% 2:5, ],</span></span>
<span id="cb132-972"><a href="#cb132-972" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(y = distance, x = type),</span></span>
<span id="cb132-973"><a href="#cb132-973" aria-hidden="true" tabindex="-1"></a><span class="in">    color = adjustcolor("orange", alpha.f = 0.6),</span></span>
<span id="cb132-974"><a href="#cb132-974" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .1,</span></span>
<span id="cb132-975"><a href="#cb132-975" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-976"><a href="#cb132-976" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA</span></span>
<span id="cb132-977"><a href="#cb132-977" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-978"><a href="#cb132-978" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(c(-1.2, 4.8)) +</span></span>
<span id="cb132-979"><a href="#cb132-979" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c(</span></span>
<span id="cb132-980"><a href="#cb132-980" aria-hidden="true" tabindex="-1"></a><span class="in">    "natural" = "Natural",</span></span>
<span id="cb132-981"><a href="#cb132-981" aria-hidden="true" tabindex="-1"></a><span class="in">    "artificial" = "Artificial",</span></span>
<span id="cb132-982"><a href="#cb132-982" aria-hidden="true" tabindex="-1"></a><span class="in">    "simulated" = "Simulated"</span></span>
<span id="cb132-983"><a href="#cb132-983" aria-hidden="true" tabindex="-1"></a><span class="in">  )) +</span></span>
<span id="cb132-984"><a href="#cb132-984" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none") +</span></span>
<span id="cb132-985"><a href="#cb132-985" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(</span></span>
<span id="cb132-986"><a href="#cb132-986" aria-hidden="true" tabindex="-1"></a><span class="in">    ~ group.size.factor,</span></span>
<span id="cb132-987"><a href="#cb132-987" aria-hidden="true" tabindex="-1"></a><span class="in">    ncol = 2,</span></span>
<span id="cb132-988"><a href="#cb132-988" aria-hidden="true" tabindex="-1"></a><span class="in">    labeller = labeller(group.size.factor = custom_labels)</span></span>
<span id="cb132-989"><a href="#cb132-989" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-990"><a href="#cb132-990" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Flight type", y = "Pairwise flight distance (m)") +</span></span>
<span id="cb132-991"><a href="#cb132-991" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(lineheight = 0.8,</span></span>
<span id="cb132-992"><a href="#cb132-992" aria-hidden="true" tabindex="-1"></a><span class="in">    data = n_grps[n_grps$group.size.factor %in% 2:5, ],</span></span>
<span id="cb132-993"><a href="#cb132-993" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(y = distance, x = type, label = n.labels),</span></span>
<span id="cb132-994"><a href="#cb132-994" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "gray60",</span></span>
<span id="cb132-995"><a href="#cb132-995" aria-hidden="true" tabindex="-1"></a><span class="in">    nudge_x = 0,</span></span>
<span id="cb132-996"><a href="#cb132-996" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 2.3</span></span>
<span id="cb132-997"><a href="#cb132-997" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-998"><a href="#cb132-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-999"><a href="#cb132-999" aria-hidden="true" tabindex="-1"></a><span class="in"># gg_gs</span></span>
<span id="cb132-1000"><a href="#cb132-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1001"><a href="#cb132-1001" aria-hidden="true" tabindex="-1"></a><span class="in">pg &lt;-</span></span>
<span id="cb132-1002"><a href="#cb132-1002" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_grid(</span></span>
<span id="cb132-1003"><a href="#cb132-1003" aria-hidden="true" tabindex="-1"></a><span class="in">    gg_gs + theme_classic(base_size = 15) + theme(</span></span>
<span id="cb132-1004"><a href="#cb132-1004" aria-hidden="true" tabindex="-1"></a><span class="in">      legend.position = "none",</span></span>
<span id="cb132-1005"><a href="#cb132-1005" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.text.x = element_text(angle = 45, hjust = 1),</span></span>
<span id="cb132-1006"><a href="#cb132-1006" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.title.x = element_blank()</span></span>
<span id="cb132-1007"><a href="#cb132-1007" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb132-1008"><a href="#cb132-1008" aria-hidden="true" tabindex="-1"></a><span class="in">    gg_all + theme_classic(base_size = 15) + theme(legend.position = "none", axis.title.y = element_blank()) + labs(x = ""),</span></span>
<span id="cb132-1009"><a href="#cb132-1009" aria-hidden="true" tabindex="-1"></a><span class="in">    ncol = 2</span></span>
<span id="cb132-1010"><a href="#cb132-1010" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-1011"><a href="#cb132-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1012"><a href="#cb132-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1013"><a href="#cb132-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1014"><a href="#cb132-1014" aria-hidden="true" tabindex="-1"></a><span class="in"># Add a common x-axis label</span></span>
<span id="cb132-1015"><a href="#cb132-1015" aria-hidden="true" tabindex="-1"></a><span class="in">pg &lt;- ggdraw(pg) +</span></span>
<span id="cb132-1016"><a href="#cb132-1016" aria-hidden="true" tabindex="-1"></a><span class="in">  draw_label(</span></span>
<span id="cb132-1017"><a href="#cb132-1017" aria-hidden="true" tabindex="-1"></a><span class="in">    "Group type",</span></span>
<span id="cb132-1018"><a href="#cb132-1018" aria-hidden="true" tabindex="-1"></a><span class="in">    x = 0.51,</span></span>
<span id="cb132-1019"><a href="#cb132-1019" aria-hidden="true" tabindex="-1"></a><span class="in">    y = 0.02,</span></span>
<span id="cb132-1020"><a href="#cb132-1020" aria-hidden="true" tabindex="-1"></a><span class="in">    vjust = 0,</span></span>
<span id="cb132-1021"><a href="#cb132-1021" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 15</span></span>
<span id="cb132-1022"><a href="#cb132-1022" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-1023"><a href="#cb132-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1024"><a href="#cb132-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1025"><a href="#cb132-1025" aria-hidden="true" tabindex="-1"></a><span class="in">hedFont &lt;- "Arial"</span></span>
<span id="cb132-1026"><a href="#cb132-1026" aria-hidden="true" tabindex="-1"></a><span class="in">pg &lt;- pg + </span></span>
<span id="cb132-1027"><a href="#cb132-1027" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(plot.title = element_text(size = 20, family = hedFont, face = "bold"))</span></span>
<span id="cb132-1028"><a href="#cb132-1028" aria-hidden="true" tabindex="-1"></a><span class="in">                                           </span></span>
<span id="cb132-1029"><a href="#cb132-1029" aria-hidden="true" tabindex="-1"></a><span class="in">pg</span></span>
<span id="cb132-1030"><a href="#cb132-1030" aria-hidden="true" tabindex="-1"></a><span class="in">                                           </span></span>
<span id="cb132-1031"><a href="#cb132-1031" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(</span></span>
<span id="cb132-1032"><a href="#cb132-1032" aria-hidden="true" tabindex="-1"></a><span class="in">  "./output/flight_coordination_5_panels.png",</span></span>
<span id="cb132-1033"><a href="#cb132-1033" aria-hidden="true" tabindex="-1"></a><span class="in">  pg,</span></span>
<span id="cb132-1034"><a href="#cb132-1034" aria-hidden="true" tabindex="-1"></a><span class="in">  grDevices::png,</span></span>
<span id="cb132-1035"><a href="#cb132-1035" aria-hidden="true" tabindex="-1"></a><span class="in">  width = 9,</span></span>
<span id="cb132-1036"><a href="#cb132-1036" aria-hidden="true" tabindex="-1"></a><span class="in">  height = 4,</span></span>
<span id="cb132-1037"><a href="#cb132-1037" aria-hidden="true" tabindex="-1"></a><span class="in">  dpi = 300</span></span>
<span id="cb132-1038"><a href="#cb132-1038" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-1039"><a href="#cb132-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1040"><a href="#cb132-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1041"><a href="#cb132-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1042"><a href="#cb132-1042" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression model</span></span>
<span id="cb132-1043"><a href="#cb132-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1044"><a href="#cb132-1044" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Add the group roost entry data to each simulated set and run a bayesian mixed effects model coordination on roost entry for each data set </span>
<span id="cb132-1045"><a href="#cb132-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1046"><a href="#cb132-1046" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The mean pairwise spatial distance between individuals at each frame was used as the response variable, while group type (natural, artificial or simulated) was used as predictor</span>
<span id="cb132-1047"><a href="#cb132-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1048"><a href="#cb132-1048" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Group ID and group size were included as varying effects. </span>
<span id="cb132-1049"><a href="#cb132-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1050"><a href="#cb132-1050" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The posterior distributions from the 30 models were combined into a single model fit for statistical inference</span>
<span id="cb132-1051"><a href="#cb132-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1052"><a href="#cb132-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1053"><a href="#cb132-1053" aria-hidden="true" tabindex="-1"></a>Model:</span>
<span id="cb132-1054"><a href="#cb132-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1055"><a href="#cb132-1055" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-1056"><a href="#cb132-1056" aria-hidden="true" tabindex="-1"></a>\text{mean pairwise distance} \sim \text{type} + \text{monotonic(group size)} + (1 \mid \text{group}) + \text{arma(frame)}</span>
<span id="cb132-1057"><a href="#cb132-1057" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-1058"><a href="#cb132-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1059"><a href="#cb132-1059" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  flight coordination regression, eval = FALSE}</span></span>
<span id="cb132-1060"><a href="#cb132-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1061"><a href="#cb132-1061" aria-hidden="true" tabindex="-1"></a><span class="in">mods_flight_coord &lt;- brm_multiple(</span></span>
<span id="cb132-1062"><a href="#cb132-1062" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = distance ~ type + mo(group.size.factor) + ar(p = 2, time = frame, gr = group),</span></span>
<span id="cb132-1063"><a href="#cb132-1063" aria-hidden="true" tabindex="-1"></a><span class="in">  iter = iter,</span></span>
<span id="cb132-1064"><a href="#cb132-1064" aria-hidden="true" tabindex="-1"></a><span class="in">  thin = 1,</span></span>
<span id="cb132-1065"><a href="#cb132-1065" aria-hidden="true" tabindex="-1"></a><span class="in">  data = nat_sim_dist_list,</span></span>
<span id="cb132-1066"><a href="#cb132-1066" aria-hidden="true" tabindex="-1"></a><span class="in">  family = gaussian(),</span></span>
<span id="cb132-1067"><a href="#cb132-1067" aria-hidden="true" tabindex="-1"></a><span class="in">  silent = 2,</span></span>
<span id="cb132-1068"><a href="#cb132-1068" aria-hidden="true" tabindex="-1"></a><span class="in">  chains = chains,</span></span>
<span id="cb132-1069"><a href="#cb132-1069" aria-hidden="true" tabindex="-1"></a><span class="in">  backend = "cmdstanr",</span></span>
<span id="cb132-1070"><a href="#cb132-1070" aria-hidden="true" tabindex="-1"></a><span class="in">  # only works if cmdstanr package is installed</span></span>
<span id="cb132-1071"><a href="#cb132-1071" aria-hidden="true" tabindex="-1"></a><span class="in">  cores = chains,</span></span>
<span id="cb132-1072"><a href="#cb132-1072" aria-hidden="true" tabindex="-1"></a><span class="in">  combine = FALSE,</span></span>
<span id="cb132-1073"><a href="#cb132-1073" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(adapt_delta = 0.99, max_treedepth = 15)</span></span>
<span id="cb132-1074"><a href="#cb132-1074" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-1075"><a href="#cb132-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1076"><a href="#cb132-1076" aria-hidden="true" tabindex="-1"></a><span class="in">custom_ppc(fit = mods_flight_coord[[1]], group = "type")</span></span>
<span id="cb132-1077"><a href="#cb132-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1078"><a href="#cb132-1078" aria-hidden="true" tabindex="-1"></a><span class="in">mods_flight_coord &lt;- pblapply(mods_flight_coord,  function(x) add_criterion(x, criterion = c("loo")))</span></span>
<span id="cb132-1079"><a href="#cb132-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1080"><a href="#cb132-1080" aria-hidden="true" tabindex="-1"></a><span class="in">saveRDS(mods_flight_coord,</span></span>
<span id="cb132-1081"><a href="#cb132-1081" aria-hidden="true" tabindex="-1"></a><span class="in">        "./data/processed/model_list_flight_coordination_monotonic.RDS")</span></span>
<span id="cb132-1082"><a href="#cb132-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1083"><a href="#cb132-1083" aria-hidden="true" tabindex="-1"></a><span class="in">null_mods_flight_coord &lt;- brm_multiple(</span></span>
<span id="cb132-1084"><a href="#cb132-1084" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = distance ~ 1 + ar(p = 2, time = frame, gr = group),</span></span>
<span id="cb132-1085"><a href="#cb132-1085" aria-hidden="true" tabindex="-1"></a><span class="in">  iter = iter,</span></span>
<span id="cb132-1086"><a href="#cb132-1086" aria-hidden="true" tabindex="-1"></a><span class="in">  thin = 1,</span></span>
<span id="cb132-1087"><a href="#cb132-1087" aria-hidden="true" tabindex="-1"></a><span class="in">  data = nat_sim_dist_list,</span></span>
<span id="cb132-1088"><a href="#cb132-1088" aria-hidden="true" tabindex="-1"></a><span class="in">  family = gaussian(),</span></span>
<span id="cb132-1089"><a href="#cb132-1089" aria-hidden="true" tabindex="-1"></a><span class="in">  silent = 2,</span></span>
<span id="cb132-1090"><a href="#cb132-1090" aria-hidden="true" tabindex="-1"></a><span class="in">  chains = chains,</span></span>
<span id="cb132-1091"><a href="#cb132-1091" aria-hidden="true" tabindex="-1"></a><span class="in">  backend = "cmdstanr",</span></span>
<span id="cb132-1092"><a href="#cb132-1092" aria-hidden="true" tabindex="-1"></a><span class="in">  # only works if cmdstanr package is installed</span></span>
<span id="cb132-1093"><a href="#cb132-1093" aria-hidden="true" tabindex="-1"></a><span class="in">  cores = chains,</span></span>
<span id="cb132-1094"><a href="#cb132-1094" aria-hidden="true" tabindex="-1"></a><span class="in">  combine = FALSE,</span></span>
<span id="cb132-1095"><a href="#cb132-1095" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(adapt_delta = 0.99, max_treedepth = 15)</span></span>
<span id="cb132-1096"><a href="#cb132-1096" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-1097"><a href="#cb132-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1098"><a href="#cb132-1098" aria-hidden="true" tabindex="-1"></a><span class="in">null_mods_flight_coord &lt;- pblapply(null_mods_flight_coord,  function(x) add_criterion(x, criterion = c("loo")))</span></span>
<span id="cb132-1099"><a href="#cb132-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1100"><a href="#cb132-1100" aria-hidden="true" tabindex="-1"></a><span class="in">saveRDS(null_mods_flight_coord,</span></span>
<span id="cb132-1101"><a href="#cb132-1101" aria-hidden="true" tabindex="-1"></a><span class="in">        "./data/processed/nullmodel_list_flight_coordination_monotonic.RDS")</span></span>
<span id="cb132-1102"><a href="#cb132-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1103"><a href="#cb132-1103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1104"><a href="#cb132-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1105"><a href="#cb132-1105" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb132-1106"><a href="#cb132-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1107"><a href="#cb132-1107" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model performance vs null model </span></span>
<span id="cb132-1108"><a href="#cb132-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1109"><a href="#cb132-1109" aria-hidden="true" tabindex="-1"></a>Mean ELPD and associated standard deviation  between each model and its correspondent null model:</span>
<span id="cb132-1110"><a href="#cb132-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  regression null model comparison flight coordination}</span></span>
<span id="cb132-1111"><a href="#cb132-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1112"><a href="#cb132-1112" aria-hidden="true" tabindex="-1"></a><span class="in">mods_flight_coord &lt;- readRDS("./data/processed/model_list_flight_coordination_monotonic.RDS")</span></span>
<span id="cb132-1113"><a href="#cb132-1113" aria-hidden="true" tabindex="-1"></a><span class="in">null_mods_flight_coord &lt;- readRDS("./data/processed/nullmodel_list_flight_coordination_monotonic.RDS")</span></span>
<span id="cb132-1114"><a href="#cb132-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1115"><a href="#cb132-1115" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diffs &lt;- </span></span>
<span id="cb132-1116"><a href="#cb132-1116" aria-hidden="true" tabindex="-1"></a><span class="in">lapply(seq_along(mods_flight_coord), function(x)</span></span>
<span id="cb132-1117"><a href="#cb132-1117" aria-hidden="true" tabindex="-1"></a><span class="in">  loo::loo_compare(mods_flight_coord[[x]], null_mods_flight_coord[[x]])</span></span>
<span id="cb132-1118"><a href="#cb132-1118" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-1119"><a href="#cb132-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1120"><a href="#cb132-1120" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff &lt;- do.call(rbind, loo_diffs)</span></span>
<span id="cb132-1121"><a href="#cb132-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1122"><a href="#cb132-1122" aria-hidden="true" tabindex="-1"></a><span class="in">rows &lt;- rownames(loo_diff)</span></span>
<span id="cb132-1123"><a href="#cb132-1123" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff &lt;- as.data.frame(loo_diff)</span></span>
<span id="cb132-1124"><a href="#cb132-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1125"><a href="#cb132-1125" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff$model &lt;- rows</span></span>
<span id="cb132-1126"><a href="#cb132-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1127"><a href="#cb132-1127" aria-hidden="true" tabindex="-1"></a><span class="in">aggregate(cbind(elpd_diff, se_diff) ~ model, loo_diff, mean)</span></span>
<span id="cb132-1128"><a href="#cb132-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1129"><a href="#cb132-1129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1130"><a href="#cb132-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1131"><a href="#cb132-1131" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model fit</span></span>
<span id="cb132-1132"><a href="#cb132-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r regression results flight coordination, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-1133"><a href="#cb132-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1134"><a href="#cb132-1134" aria-hidden="true" tabindex="-1"></a><span class="in"># average model</span></span>
<span id="cb132-1135"><a href="#cb132-1135" aria-hidden="true" tabindex="-1"></a><span class="in">avrg_call &lt;-</span></span>
<span id="cb132-1136"><a href="#cb132-1136" aria-hidden="true" tabindex="-1"></a><span class="in">  paste0("posterior_average(",</span></span>
<span id="cb132-1137"><a href="#cb132-1137" aria-hidden="true" tabindex="-1"></a><span class="in">         paste0(paste0(</span></span>
<span id="cb132-1138"><a href="#cb132-1138" aria-hidden="true" tabindex="-1"></a><span class="in">           "mods_flight_coord[[", 1:length(mods_flight_coord), "]]"</span></span>
<span id="cb132-1139"><a href="#cb132-1139" aria-hidden="true" tabindex="-1"></a><span class="in">         ), collapse = ", "),</span></span>
<span id="cb132-1140"><a href="#cb132-1140" aria-hidden="true" tabindex="-1"></a><span class="in">         ", weights = 'loo')")</span></span>
<span id="cb132-1141"><a href="#cb132-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1142"><a href="#cb132-1142" aria-hidden="true" tabindex="-1"></a><span class="in">average_model_draws &lt;- eval(parse(text = avrg_call))</span></span>
<span id="cb132-1143"><a href="#cb132-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1144"><a href="#cb132-1144" aria-hidden="true" tabindex="-1"></a><span class="in">draw_extended_summary(average_model_draws,</span></span>
<span id="cb132-1145"><a href="#cb132-1145" aria-hidden="true" tabindex="-1"></a><span class="in">                      highlight = TRUE,</span></span>
<span id="cb132-1146"><a href="#cb132-1146" aria-hidden="true" tabindex="-1"></a><span class="in">                      fill = fill_color,</span></span>
<span id="cb132-1147"><a href="#cb132-1147" aria-hidden="true" tabindex="-1"></a><span class="in">                      beta.prefix = c("^b_", "^bsp_mo")</span></span>
<span id="cb132-1148"><a href="#cb132-1148" aria-hidden="true" tabindex="-1"></a><span class="in">                      )</span></span>
<span id="cb132-1149"><a href="#cb132-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1150"><a href="#cb132-1150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1151"><a href="#cb132-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1152"><a href="#cb132-1152" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Contrasts</span></span>
<span id="cb132-1153"><a href="#cb132-1153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r regresion contrasts flight coordination, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-1154"><a href="#cb132-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1155"><a href="#cb132-1155" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts &lt;-</span></span>
<span id="cb132-1156"><a href="#cb132-1156" aria-hidden="true" tabindex="-1"></a><span class="in">  draws_contrasts(draws = average_model_draws, predictor_name = "type", basal_level = "natural",</span></span>
<span id="cb132-1157"><a href="#cb132-1157" aria-hidden="true" tabindex="-1"></a><span class="in">                  fill_color = fill_color)</span></span>
<span id="cb132-1158"><a href="#cb132-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1159"><a href="#cb132-1159" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts$contrasts</span></span>
<span id="cb132-1160"><a href="#cb132-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1161"><a href="#cb132-1161" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts$plot + theme_classic()</span></span>
<span id="cb132-1162"><a href="#cb132-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1163"><a href="#cb132-1163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1164"><a href="#cb132-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1165"><a href="#cb132-1165" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Posterior predictive checks</span></span>
<span id="cb132-1168"><a href="#cb132-1168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-1169"><a href="#cb132-1169" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="fu">readRDS</span>(<span class="st">"./data/processed/model_list_flight_coordination.RDS"</span>)[[<span class="dv">1</span>]], <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb132-1170"><a href="#cb132-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1171"><a href="#cb132-1171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1172"><a href="#cb132-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1173"><a href="#cb132-1173" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-1174"><a href="#cb132-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1175"><a href="#cb132-1175" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb132-1176"><a href="#cb132-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1177"><a href="#cb132-1177" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Flight coordination is higher in natural groups than in artificial and simulated groups</span>
<span id="cb132-1178"><a href="#cb132-1178" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Flight coordination is similar in artificial and simulated groups</span>
<span id="cb132-1179"><a href="#cb132-1179" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Flight distance between individuals increases with group size</span>
<span id="cb132-1180"><a href="#cb132-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1181"><a href="#cb132-1181" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-1182"><a href="#cb132-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1183"><a href="#cb132-1183" aria-hidden="true" tabindex="-1"></a><span class="fu"># Roost entry coordination</span></span>
<span id="cb132-1184"><a href="#cb132-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1185"><a href="#cb132-1185" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data description</span></span>
<span id="cb132-1186"><a href="#cb132-1186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data description, eval = TRUE}</span></span>
<span id="cb132-1187"><a href="#cb132-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1188"><a href="#cb132-1188" aria-hidden="true" tabindex="-1"></a><span class="in">dat &lt;-</span></span>
<span id="cb132-1189"><a href="#cb132-1189" aria-hidden="true" tabindex="-1"></a><span class="in">  as.data.frame(read_excel(path = "./data/raw/Anexo 1_Entrada a refugios-2022.xlsx"))</span></span>
<span id="cb132-1190"><a href="#cb132-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1191"><a href="#cb132-1191" aria-hidden="true" tabindex="-1"></a><span class="in">dat$entry.time &lt;- as.numeric(dat$`Tiempo real`)</span></span>
<span id="cb132-1192"><a href="#cb132-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1193"><a href="#cb132-1193" aria-hidden="true" tabindex="-1"></a><span class="in"># remove missing data</span></span>
<span id="cb132-1194"><a href="#cb132-1194" aria-hidden="true" tabindex="-1"></a><span class="in">dat &lt;- dat[!is.na(dat$entry.time), ]</span></span>
<span id="cb132-1195"><a href="#cb132-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1196"><a href="#cb132-1196" aria-hidden="true" tabindex="-1"></a><span class="in"># rename treatment levels</span></span>
<span id="cb132-1197"><a href="#cb132-1197" aria-hidden="true" tabindex="-1"></a><span class="in">dat$type &lt;- dat$`Tipo grupo`</span></span>
<span id="cb132-1198"><a href="#cb132-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1199"><a href="#cb132-1199" aria-hidden="true" tabindex="-1"></a><span class="in">dat$type[dat$type == "Real"] &lt;- "Natural"</span></span>
<span id="cb132-1200"><a href="#cb132-1200" aria-hidden="true" tabindex="-1"></a><span class="in">dat$type[dat$type == "Mixto"] &lt;- "Artificial"</span></span>
<span id="cb132-1201"><a href="#cb132-1201" aria-hidden="true" tabindex="-1"></a><span class="in">dat$group &lt;- dat$Grupo</span></span>
<span id="cb132-1202"><a href="#cb132-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1203"><a href="#cb132-1203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1204"><a href="#cb132-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1205"><a href="#cb132-1205" aria-hidden="true" tabindex="-1"></a>Number of individuals per type:</span>
<span id="cb132-1206"><a href="#cb132-1206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data description 2, eval = TRUE}</span></span>
<span id="cb132-1207"><a href="#cb132-1207" aria-hidden="true" tabindex="-1"></a><span class="in">table(dat$type)</span></span>
<span id="cb132-1208"><a href="#cb132-1208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1209"><a href="#cb132-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1210"><a href="#cb132-1210" aria-hidden="true" tabindex="-1"></a>Number of individuals per type removing missing data (NAs and Inf):</span>
<span id="cb132-1211"><a href="#cb132-1211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data description 3, eval = TRUE}</span></span>
<span id="cb132-1212"><a href="#cb132-1212" aria-hidden="true" tabindex="-1"></a><span class="in">(table(dat$type[!is.infinite(dat$entry.time) &amp; !is.na(dat$entry.time)]))</span></span>
<span id="cb132-1213"><a href="#cb132-1213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1214"><a href="#cb132-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1215"><a href="#cb132-1215" aria-hidden="true" tabindex="-1"></a>Individuals per experiment:</span>
<span id="cb132-1216"><a href="#cb132-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data description 4, eval = TRUE}</span></span>
<span id="cb132-1217"><a href="#cb132-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1218"><a href="#cb132-1218" aria-hidden="true" tabindex="-1"></a><span class="in">ind_per_video &lt;- table(dat$Video[dat$type != "Individual"])</span></span>
<span id="cb132-1219"><a href="#cb132-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1220"><a href="#cb132-1220" aria-hidden="true" tabindex="-1"></a><span class="in">table(ind_per_video)</span></span>
<span id="cb132-1221"><a href="#cb132-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1222"><a href="#cb132-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1223"><a href="#cb132-1223" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimating roost entry time lapse</span></span>
<span id="cb132-1224"><a href="#cb132-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1225"><a href="#cb132-1225" aria-hidden="true" tabindex="-1"></a>Calculate time lapse between the first individual to enter the roost for each group: </span>
<span id="cb132-1226"><a href="#cb132-1226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Entry time difference plot, eval = TRUE}</span></span>
<span id="cb132-1227"><a href="#cb132-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1228"><a href="#cb132-1228" aria-hidden="true" tabindex="-1"></a><span class="in">group_dat &lt;-</span></span>
<span id="cb132-1229"><a href="#cb132-1229" aria-hidden="true" tabindex="-1"></a><span class="in">  dat[!is.infinite(dat$entry.time) &amp;</span></span>
<span id="cb132-1230"><a href="#cb132-1230" aria-hidden="true" tabindex="-1"></a><span class="in">        !is.na(dat$entry.time) &amp; dat$type != "Individual",]</span></span>
<span id="cb132-1231"><a href="#cb132-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1232"><a href="#cb132-1232" aria-hidden="true" tabindex="-1"></a><span class="in"># get time difference  between entries</span></span>
<span id="cb132-1233"><a href="#cb132-1233" aria-hidden="true" tabindex="-1"></a><span class="in">group_dat_l &lt;- lapply(unique(group_dat$group), function(x) {</span></span>
<span id="cb132-1234"><a href="#cb132-1234" aria-hidden="true" tabindex="-1"></a><span class="in">  # print(x)</span></span>
<span id="cb132-1235"><a href="#cb132-1235" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- group_dat[group_dat$group == x,]</span></span>
<span id="cb132-1236"><a href="#cb132-1236" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- X[!is.na(X$entry.time), ]</span></span>
<span id="cb132-1237"><a href="#cb132-1237" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- X[order(X$entry.time), ]</span></span>
<span id="cb132-1238"><a href="#cb132-1238" aria-hidden="true" tabindex="-1"></a><span class="in">  # X$entry.time.diff &lt;- X$entry.time - min(X$entry.time)</span></span>
<span id="cb132-1239"><a href="#cb132-1239" aria-hidden="true" tabindex="-1"></a><span class="in">  X$entry.time.diff &lt;- c(NA, X$entry.time[-1] - X$entry.time[-nrow(X)])</span></span>
<span id="cb132-1240"><a href="#cb132-1240" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- X[!is.na(X$entry.time.diff), ]</span></span>
<span id="cb132-1241"><a href="#cb132-1241" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1242"><a href="#cb132-1242" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1243"><a href="#cb132-1243" aria-hidden="true" tabindex="-1"></a><span class="in">  # add 1 milisecond to 0 </span></span>
<span id="cb132-1244"><a href="#cb132-1244" aria-hidden="true" tabindex="-1"></a><span class="in">  X$entry.time.diff[X$entry.time.diff == 0] &lt;- NA</span></span>
<span id="cb132-1245"><a href="#cb132-1245" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1246"><a href="#cb132-1246" aria-hidden="true" tabindex="-1"></a><span class="in">  X$group.size &lt;- if (nrow(X) &gt; 0)</span></span>
<span id="cb132-1247"><a href="#cb132-1247" aria-hidden="true" tabindex="-1"></a><span class="in">    nrow(X) - 1</span></span>
<span id="cb132-1248"><a href="#cb132-1248" aria-hidden="true" tabindex="-1"></a><span class="in">  else</span></span>
<span id="cb132-1249"><a href="#cb132-1249" aria-hidden="true" tabindex="-1"></a><span class="in">    vector()</span></span>
<span id="cb132-1250"><a href="#cb132-1250" aria-hidden="true" tabindex="-1"></a><span class="in">  return(X)</span></span>
<span id="cb132-1251"><a href="#cb132-1251" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-1252"><a href="#cb132-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1253"><a href="#cb132-1253" aria-hidden="true" tabindex="-1"></a><span class="in">group_dat &lt;- do.call(rbind, group_dat_l)</span></span>
<span id="cb132-1254"><a href="#cb132-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1255"><a href="#cb132-1255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1256"><a href="#cb132-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1257"><a href="#cb132-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulating entry time lapse data</span></span>
<span id="cb132-1258"><a href="#cb132-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1259"><a href="#cb132-1259" aria-hidden="true" tabindex="-1"></a>Simulated 30 data sets, each one with a number of simulated groups for each group size (2 to 5 individuals) similar to those in the natural group data. This approach allowed us to propagate uncertainty from random group simulations into our statistical inference.</span>
<span id="cb132-1260"><a href="#cb132-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1261"><a href="#cb132-1261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Simulation entry time difference, eval = TRUE}</span></span>
<span id="cb132-1262"><a href="#cb132-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1263"><a href="#cb132-1263" aria-hidden="true" tabindex="-1"></a><span class="in">group_dat &lt;-</span></span>
<span id="cb132-1264"><a href="#cb132-1264" aria-hidden="true" tabindex="-1"></a><span class="in">  dat[!is.infinite(dat$entry.time) &amp;</span></span>
<span id="cb132-1265"><a href="#cb132-1265" aria-hidden="true" tabindex="-1"></a><span class="in">        !is.na(dat$entry.time) &amp; dat$type != "Individual",]</span></span>
<span id="cb132-1266"><a href="#cb132-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1267"><a href="#cb132-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1268"><a href="#cb132-1268" aria-hidden="true" tabindex="-1"></a><span class="in"># get difference to first entry</span></span>
<span id="cb132-1269"><a href="#cb132-1269" aria-hidden="true" tabindex="-1"></a><span class="in">group_dat_l &lt;- lapply(unique(group_dat$group), function(x) {</span></span>
<span id="cb132-1270"><a href="#cb132-1270" aria-hidden="true" tabindex="-1"></a><span class="in">  # print(x)</span></span>
<span id="cb132-1271"><a href="#cb132-1271" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- group_dat[group_dat$group == x,]</span></span>
<span id="cb132-1272"><a href="#cb132-1272" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- X[!is.na(X$entry.time), ]</span></span>
<span id="cb132-1273"><a href="#cb132-1273" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- X[order(X$entry.time), ]</span></span>
<span id="cb132-1274"><a href="#cb132-1274" aria-hidden="true" tabindex="-1"></a><span class="in">  # X$entry.time.diff &lt;- X$entry.time - min(X$entry.time)</span></span>
<span id="cb132-1275"><a href="#cb132-1275" aria-hidden="true" tabindex="-1"></a><span class="in">  X$entry.time.diff &lt;- c(NA, X$entry.time[-1] - X$entry.time[-nrow(X)])</span></span>
<span id="cb132-1276"><a href="#cb132-1276" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- X[!is.na(X$entry.time.diff), ]</span></span>
<span id="cb132-1277"><a href="#cb132-1277" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1278"><a href="#cb132-1278" aria-hidden="true" tabindex="-1"></a><span class="in">  X$group.size &lt;- if (nrow(X) &gt; 0)</span></span>
<span id="cb132-1279"><a href="#cb132-1279" aria-hidden="true" tabindex="-1"></a><span class="in">    nrow(X) + 1</span></span>
<span id="cb132-1280"><a href="#cb132-1280" aria-hidden="true" tabindex="-1"></a><span class="in">  else</span></span>
<span id="cb132-1281"><a href="#cb132-1281" aria-hidden="true" tabindex="-1"></a><span class="in">    vector()</span></span>
<span id="cb132-1282"><a href="#cb132-1282" aria-hidden="true" tabindex="-1"></a><span class="in">  return(X)</span></span>
<span id="cb132-1283"><a href="#cb132-1283" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-1284"><a href="#cb132-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1285"><a href="#cb132-1285" aria-hidden="true" tabindex="-1"></a><span class="in">group_dat &lt;- do.call(rbind, group_dat_l)</span></span>
<span id="cb132-1286"><a href="#cb132-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1287"><a href="#cb132-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1288"><a href="#cb132-1288" aria-hidden="true" tabindex="-1"></a><span class="in">group_dat$type &lt;-</span></span>
<span id="cb132-1289"><a href="#cb132-1289" aria-hidden="true" tabindex="-1"></a><span class="in">  factor(group_dat$type, levels = c("Artificial", "Natural", "Simulated"))</span></span>
<span id="cb132-1290"><a href="#cb132-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1291"><a href="#cb132-1291" aria-hidden="true" tabindex="-1"></a><span class="in"># make random groups from individual flights</span></span>
<span id="cb132-1292"><a href="#cb132-1292" aria-hidden="true" tabindex="-1"></a><span class="in">indiv_dat &lt;-</span></span>
<span id="cb132-1293"><a href="#cb132-1293" aria-hidden="true" tabindex="-1"></a><span class="in">  dat[!is.infinite(dat$entry.time) &amp;</span></span>
<span id="cb132-1294"><a href="#cb132-1294" aria-hidden="true" tabindex="-1"></a><span class="in">        !is.na(dat$entry.time) &amp; dat$type == "Individual",]</span></span>
<span id="cb132-1295"><a href="#cb132-1295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1296"><a href="#cb132-1296" aria-hidden="true" tabindex="-1"></a><span class="in">indivs &lt;- unique(indiv_dat$Individuo)</span></span>
<span id="cb132-1297"><a href="#cb132-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1298"><a href="#cb132-1298" aria-hidden="true" tabindex="-1"></a><span class="in">group_sizes &lt;- group_dat$group.size[!duplicated(group_dat$Video)]</span></span>
<span id="cb132-1299"><a href="#cb132-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1300"><a href="#cb132-1300" aria-hidden="true" tabindex="-1"></a><span class="in"># use only group sizes 2:5</span></span>
<span id="cb132-1301"><a href="#cb132-1301" aria-hidden="true" tabindex="-1"></a><span class="in">group_sizes &lt;- group_sizes[group_sizes &lt;= 5]</span></span>
<span id="cb132-1302"><a href="#cb132-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1303"><a href="#cb132-1303" aria-hidden="true" tabindex="-1"></a><span class="in">table(group_sizes)</span></span>
<span id="cb132-1304"><a href="#cb132-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1305"><a href="#cb132-1305" aria-hidden="true" tabindex="-1"></a><span class="in"># simulate group entries</span></span>
<span id="cb132-1306"><a href="#cb132-1306" aria-hidden="true" tabindex="-1"></a><span class="in">sim_groups_l &lt;- pblapply(1:30, cl = 10, function(x) {</span></span>
<span id="cb132-1307"><a href="#cb132-1307" aria-hidden="true" tabindex="-1"></a><span class="in">  # randomize order of distribution of individuals per experiment</span></span>
<span id="cb132-1308"><a href="#cb132-1308" aria-hidden="true" tabindex="-1"></a><span class="in">  set.seed(x)</span></span>
<span id="cb132-1309"><a href="#cb132-1309" aria-hidden="true" tabindex="-1"></a><span class="in">  g_size &lt;- sample((group_sizes), length(group_sizes) / 2)</span></span>
<span id="cb132-1310"><a href="#cb132-1310" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1311"><a href="#cb132-1311" aria-hidden="true" tabindex="-1"></a><span class="in">  # sampled_indivs &lt;- sample(indivs, sum(g_size), replace = TRUE)</span></span>
<span id="cb132-1312"><a href="#cb132-1312" aria-hidden="true" tabindex="-1"></a><span class="in">  names(g_size) &lt;- paste("sim", x, 1:length(g_size), sep = "-")</span></span>
<span id="cb132-1313"><a href="#cb132-1313" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1314"><a href="#cb132-1314" aria-hidden="true" tabindex="-1"></a><span class="in">  # indivs_split &lt;-</span></span>
<span id="cb132-1315"><a href="#cb132-1315" aria-hidden="true" tabindex="-1"></a><span class="in">  #   split(sampled_indivs, f = unlist(sapply(seq_along(g_size), function(x)</span></span>
<span id="cb132-1316"><a href="#cb132-1316" aria-hidden="true" tabindex="-1"></a><span class="in">  #     rep(names(g_size)[x], g_size[x]))))</span></span>
<span id="cb132-1317"><a href="#cb132-1317" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1318"><a href="#cb132-1318" aria-hidden="true" tabindex="-1"></a><span class="in">  set.seed(x)</span></span>
<span id="cb132-1319"><a href="#cb132-1319" aria-hidden="true" tabindex="-1"></a><span class="in">  indivs_split &lt;- lapply(g_size, function(w) sample(indivs, w))</span></span>
<span id="cb132-1320"><a href="#cb132-1320" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1321"><a href="#cb132-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1322"><a href="#cb132-1322" aria-hidden="true" tabindex="-1"></a><span class="in">  sub_sim_groups_l &lt;- lapply(1:length(indivs_split), function(y) {</span></span>
<span id="cb132-1323"><a href="#cb132-1323" aria-hidden="true" tabindex="-1"></a><span class="in">    sim_group &lt;- indiv_dat[indiv_dat$Individuo %in% indivs_split[[y]],]</span></span>
<span id="cb132-1324"><a href="#cb132-1324" aria-hidden="true" tabindex="-1"></a><span class="in">    sim_group$group &lt;- names(g_size)[y]</span></span>
<span id="cb132-1325"><a href="#cb132-1325" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-1326"><a href="#cb132-1326" aria-hidden="true" tabindex="-1"></a><span class="in">     sim_group &lt;- sim_group[!is.na(sim_group$entry.time), ]</span></span>
<span id="cb132-1327"><a href="#cb132-1327" aria-hidden="true" tabindex="-1"></a><span class="in">  sim_group &lt;- sim_group[order(sim_group$entry.time), ]</span></span>
<span id="cb132-1328"><a href="#cb132-1328" aria-hidden="true" tabindex="-1"></a><span class="in">  # sim_group$entry.time.diff &lt;- sim_group$entry.time - min(sim_group$entry.time)</span></span>
<span id="cb132-1329"><a href="#cb132-1329" aria-hidden="true" tabindex="-1"></a><span class="in">  sim_group$entry.time.diff &lt;- c(NA, sim_group$entry.time[-1] - sim_group$entry.time[-nrow(sim_group)])</span></span>
<span id="cb132-1330"><a href="#cb132-1330" aria-hidden="true" tabindex="-1"></a><span class="in">  sim_group &lt;- sim_group[!is.na(sim_group$entry.time.diff), ]</span></span>
<span id="cb132-1331"><a href="#cb132-1331" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb132-1332"><a href="#cb132-1332" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-1333"><a href="#cb132-1333" aria-hidden="true" tabindex="-1"></a><span class="in">  sim_group$entry.time.diff[sim_group$entry.time.diff &gt; 300] &lt;- 300</span></span>
<span id="cb132-1334"><a href="#cb132-1334" aria-hidden="true" tabindex="-1"></a><span class="in">    # sim_group$entry.time.diff &lt;-</span></span>
<span id="cb132-1335"><a href="#cb132-1335" aria-hidden="true" tabindex="-1"></a><span class="in">    #   sim_group$entry.time - min(sim_group$entry.time)</span></span>
<span id="cb132-1336"><a href="#cb132-1336" aria-hidden="true" tabindex="-1"></a><span class="in">    # sim_group &lt;- sim_group[-which.min(sim_group$entry.time.diff),]</span></span>
<span id="cb132-1337"><a href="#cb132-1337" aria-hidden="true" tabindex="-1"></a><span class="in">    sim_group$group.size &lt;- nrow(sim_group) + 1</span></span>
<span id="cb132-1338"><a href="#cb132-1338" aria-hidden="true" tabindex="-1"></a><span class="in">    sim_group$type &lt;- factor("Simulated")</span></span>
<span id="cb132-1339"><a href="#cb132-1339" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-1340"><a href="#cb132-1340" aria-hidden="true" tabindex="-1"></a><span class="in">    return(sim_group)</span></span>
<span id="cb132-1341"><a href="#cb132-1341" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb132-1342"><a href="#cb132-1342" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1343"><a href="#cb132-1343" aria-hidden="true" tabindex="-1"></a><span class="in">  sub_sim_groups &lt;- do.call(rbind, sub_sim_groups_l)</span></span>
<span id="cb132-1344"><a href="#cb132-1344" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1345"><a href="#cb132-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1346"><a href="#cb132-1346" aria-hidden="true" tabindex="-1"></a><span class="in">  # bind excluding first individual</span></span>
<span id="cb132-1347"><a href="#cb132-1347" aria-hidden="true" tabindex="-1"></a><span class="in">  out &lt;-</span></span>
<span id="cb132-1348"><a href="#cb132-1348" aria-hidden="true" tabindex="-1"></a><span class="in">    rbind(sub_sim_groups, group_dat[group_dat$group.size %in% 2:5 &amp;</span></span>
<span id="cb132-1349"><a href="#cb132-1349" aria-hidden="true" tabindex="-1"></a><span class="in">                                      group_dat$entry.time.diff &gt; 0.001,])</span></span>
<span id="cb132-1350"><a href="#cb132-1350" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-1351"><a href="#cb132-1351" aria-hidden="true" tabindex="-1"></a><span class="in">  return(out)</span></span>
<span id="cb132-1352"><a href="#cb132-1352" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-1353"><a href="#cb132-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1354"><a href="#cb132-1354" aria-hidden="true" tabindex="-1"></a><span class="in">sim_group_n &lt;-</span></span>
<span id="cb132-1355"><a href="#cb132-1355" aria-hidden="true" tabindex="-1"></a><span class="in">  sapply(sim_groups_l, function(x)</span></span>
<span id="cb132-1356"><a href="#cb132-1356" aria-hidden="true" tabindex="-1"></a><span class="in">    length(unique(x$group[x$type == "Simulated"])))</span></span>
<span id="cb132-1357"><a href="#cb132-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1358"><a href="#cb132-1358" aria-hidden="true" tabindex="-1"></a><span class="in">all(sim_group_n == 4)</span></span>
<span id="cb132-1359"><a href="#cb132-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1360"><a href="#cb132-1360" aria-hidden="true" tabindex="-1"></a><span class="in">sim_group_dat &lt;-</span></span>
<span id="cb132-1361"><a href="#cb132-1361" aria-hidden="true" tabindex="-1"></a><span class="in">  do.call(rbind, lapply(sim_groups_l, function(x)</span></span>
<span id="cb132-1362"><a href="#cb132-1362" aria-hidden="true" tabindex="-1"></a><span class="in">    x[x$type == "Simulated",]))</span></span>
<span id="cb132-1363"><a href="#cb132-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1364"><a href="#cb132-1364" aria-hidden="true" tabindex="-1"></a><span class="in">sim_group_dat &lt;- rbind(sim_group_dat, group_dat)</span></span>
<span id="cb132-1365"><a href="#cb132-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1366"><a href="#cb132-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1367"><a href="#cb132-1367" aria-hidden="true" tabindex="-1"></a><span class="in"># also make group.size.factor</span></span>
<span id="cb132-1368"><a href="#cb132-1368" aria-hidden="true" tabindex="-1"></a><span class="in">sim_groups_l &lt;- lapply(sim_groups_l, function(x) {</span></span>
<span id="cb132-1369"><a href="#cb132-1369" aria-hidden="true" tabindex="-1"></a><span class="in">  x$type &lt;- factor(x$type, levels = c("Natural", "Artificial", "Simulated"))</span></span>
<span id="cb132-1370"><a href="#cb132-1370" aria-hidden="true" tabindex="-1"></a><span class="in">  x$group.size.factor &lt;- factor(x$group.size)</span></span>
<span id="cb132-1371"><a href="#cb132-1371" aria-hidden="true" tabindex="-1"></a><span class="in">  return(x)</span></span>
<span id="cb132-1372"><a href="#cb132-1372" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-1373"><a href="#cb132-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1374"><a href="#cb132-1374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1375"><a href="#cb132-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1376"><a href="#cb132-1376" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plot raw data</span></span>
<span id="cb132-1377"><a href="#cb132-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1378"><a href="#cb132-1378" aria-hidden="true" tabindex="-1"></a>All group sizes combined:</span>
<span id="cb132-1379"><a href="#cb132-1379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-1380"><a href="#cb132-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1381"><a href="#cb132-1381" aria-hidden="true" tabindex="-1"></a><span class="in"># custom_labels &lt;- unique(sim_groups_l[[3]]$group.size)</span></span>
<span id="cb132-1382"><a href="#cb132-1382" aria-hidden="true" tabindex="-1"></a><span class="in"># custom_labels &lt;- paste("group size = ", custom_labels)</span></span>
<span id="cb132-1383"><a href="#cb132-1383" aria-hidden="true" tabindex="-1"></a><span class="in"># names(custom_labels) &lt;- unique(sim_groups_l[[3]]$group.size)</span></span>
<span id="cb132-1384"><a href="#cb132-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1385"><a href="#cb132-1385" aria-hidden="true" tabindex="-1"></a><span class="in"># table(call_rate_by_group$group.size, call_rate_by_group$type)</span></span>
<span id="cb132-1386"><a href="#cb132-1386" aria-hidden="true" tabindex="-1"></a><span class="in">cols &lt;- graph_cols[2:4]</span></span>
<span id="cb132-1387"><a href="#cb132-1387" aria-hidden="true" tabindex="-1"></a><span class="in">cols_transp &lt;- graph_cols_transp[2:4]</span></span>
<span id="cb132-1388"><a href="#cb132-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1389"><a href="#cb132-1389" aria-hidden="true" tabindex="-1"></a><span class="in">names(cols) &lt;- names(cols_transp) &lt;- c("Natural", "Artificial", "Simulated")</span></span>
<span id="cb132-1390"><a href="#cb132-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1391"><a href="#cb132-1391" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-1392"><a href="#cb132-1392" aria-hidden="true" tabindex="-1"></a><span class="in">gg_entry &lt;- ggplot(sim_groups_l[[1]],</span></span>
<span id="cb132-1393"><a href="#cb132-1393" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(</span></span>
<span id="cb132-1394"><a href="#cb132-1394" aria-hidden="true" tabindex="-1"></a><span class="in">         y = entry.time.diff,</span></span>
<span id="cb132-1395"><a href="#cb132-1395" aria-hidden="true" tabindex="-1"></a><span class="in">         x = type,</span></span>
<span id="cb132-1396"><a href="#cb132-1396" aria-hidden="true" tabindex="-1"></a><span class="in">         color = type,</span></span>
<span id="cb132-1397"><a href="#cb132-1397" aria-hidden="true" tabindex="-1"></a><span class="in">         fill = type</span></span>
<span id="cb132-1398"><a href="#cb132-1398" aria-hidden="true" tabindex="-1"></a><span class="in">       )) +</span></span>
<span id="cb132-1399"><a href="#cb132-1399" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-1400"><a href="#cb132-1400" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-1401"><a href="#cb132-1401" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-1402"><a href="#cb132-1402" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-1403"><a href="#cb132-1403" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-1404"><a href="#cb132-1404" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-1405"><a href="#cb132-1405" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-1406"><a href="#cb132-1406" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-1407"><a href="#cb132-1407" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-1408"><a href="#cb132-1408" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-1409"><a href="#cb132-1409" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-1410"><a href="#cb132-1410" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-1411"><a href="#cb132-1411" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-1412"><a href="#cb132-1412" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-1413"><a href="#cb132-1413" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-1414"><a href="#cb132-1414" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-1415"><a href="#cb132-1415" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-1416"><a href="#cb132-1416" aria-hidden="true" tabindex="-1"></a><span class="in">    # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-1417"><a href="#cb132-1417" aria-hidden="true" tabindex="-1"></a><span class="in">    gghalves::geom_half_point(</span></span>
<span id="cb132-1418"><a href="#cb132-1418" aria-hidden="true" tabindex="-1"></a><span class="in">      # color = fill_color,</span></span>
<span id="cb132-1419"><a href="#cb132-1419" aria-hidden="true" tabindex="-1"></a><span class="in">      # draw jitter on the left</span></span>
<span id="cb132-1420"><a href="#cb132-1420" aria-hidden="true" tabindex="-1"></a><span class="in">      side = "l",</span></span>
<span id="cb132-1421"><a href="#cb132-1421" aria-hidden="true" tabindex="-1"></a><span class="in">      # control range of jitter</span></span>
<span id="cb132-1422"><a href="#cb132-1422" aria-hidden="true" tabindex="-1"></a><span class="in">      range_scale = .4,</span></span>
<span id="cb132-1423"><a href="#cb132-1423" aria-hidden="true" tabindex="-1"></a><span class="in">      # add some transparency</span></span>
<span id="cb132-1424"><a href="#cb132-1424" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = .5,</span></span>
<span id="cb132-1425"><a href="#cb132-1425" aria-hidden="true" tabindex="-1"></a><span class="in">      transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-1426"><a href="#cb132-1426" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb132-1427"><a href="#cb132-1427" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values = cols) +</span></span>
<span id="cb132-1428"><a href="#cb132-1428" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = cols_transp) +</span></span>
<span id="cb132-1429"><a href="#cb132-1429" aria-hidden="true" tabindex="-1"></a><span class="in">        # scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-1430"><a href="#cb132-1430" aria-hidden="true" tabindex="-1"></a><span class="in">      # scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-1431"><a href="#cb132-1431" aria-hidden="true" tabindex="-1"></a><span class="in">      #                      end = 0.8,</span></span>
<span id="cb132-1432"><a href="#cb132-1432" aria-hidden="true" tabindex="-1"></a><span class="in">      #                      alpha = 0.6) +</span></span>
<span id="cb132-1433"><a href="#cb132-1433" aria-hidden="true" tabindex="-1"></a><span class="in">      # ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb132-1434"><a href="#cb132-1434" aria-hidden="true" tabindex="-1"></a><span class="in">           scale_x_discrete(labels = c(</span></span>
<span id="cb132-1435"><a href="#cb132-1435" aria-hidden="true" tabindex="-1"></a><span class="in">        "natural" = "Natural",</span></span>
<span id="cb132-1436"><a href="#cb132-1436" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial" = "Artificial",</span></span>
<span id="cb132-1437"><a href="#cb132-1437" aria-hidden="true" tabindex="-1"></a><span class="in">        "simulated" = "Simulated"</span></span>
<span id="cb132-1438"><a href="#cb132-1438" aria-hidden="true" tabindex="-1"></a><span class="in">      )) +</span></span>
<span id="cb132-1439"><a href="#cb132-1439" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "none") +</span></span>
<span id="cb132-1440"><a href="#cb132-1440" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Group type", y = "Time difference (s)")</span></span>
<span id="cb132-1441"><a href="#cb132-1441" aria-hidden="true" tabindex="-1"></a><span class="in">   </span></span>
<span id="cb132-1442"><a href="#cb132-1442" aria-hidden="true" tabindex="-1"></a><span class="in">agg_grp_time &lt;- aggregate(entry.time.diff ~ type + group, sim_groups_l[[1]], mean)</span></span>
<span id="cb132-1443"><a href="#cb132-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1444"><a href="#cb132-1444" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps &lt;-</span></span>
<span id="cb132-1445"><a href="#cb132-1445" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(group ~ type + group.size, sim_groups_l[[1]], function(x)</span></span>
<span id="cb132-1446"><a href="#cb132-1446" aria-hidden="true" tabindex="-1"></a><span class="in">    length(unique(x)))</span></span>
<span id="cb132-1447"><a href="#cb132-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1448"><a href="#cb132-1448" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$indivs &lt;-</span></span>
<span id="cb132-1449"><a href="#cb132-1449" aria-hidden="true" tabindex="-1"></a><span class="in">  n_grps$group * n_grps$group.size</span></span>
<span id="cb132-1450"><a href="#cb132-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1451"><a href="#cb132-1451" aria-hidden="true" tabindex="-1"></a><span class="in">agg_grps &lt;- aggregate(group ~ type, n_grps, sum)</span></span>
<span id="cb132-1452"><a href="#cb132-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1453"><a href="#cb132-1453" aria-hidden="true" tabindex="-1"></a><span class="in">agg_grps$indivs &lt;- aggregate(indivs ~ type, n_grps, sum)$indivs</span></span>
<span id="cb132-1454"><a href="#cb132-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1455"><a href="#cb132-1455" aria-hidden="true" tabindex="-1"></a><span class="in">agg_grps$n.labels &lt;-</span></span>
<span id="cb132-1456"><a href="#cb132-1456" aria-hidden="true" tabindex="-1"></a><span class="in">  paste0(agg_grps$group, " / ", agg_grps$indivs)</span></span>
<span id="cb132-1457"><a href="#cb132-1457" aria-hidden="true" tabindex="-1"></a><span class="in">agg_grps$n.labels[1] &lt;-</span></span>
<span id="cb132-1458"><a href="#cb132-1458" aria-hidden="true" tabindex="-1"></a><span class="in">  " n = 13 groups /\n 50 individuals"</span></span>
<span id="cb132-1459"><a href="#cb132-1459" aria-hidden="true" tabindex="-1"></a><span class="in">agg_grps$distance &lt;- -15</span></span>
<span id="cb132-1460"><a href="#cb132-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1461"><a href="#cb132-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1462"><a href="#cb132-1462" aria-hidden="true" tabindex="-1"></a><span class="in">gg_entry &lt;- gg_entry + ylim(c(-20, 210)) +</span></span>
<span id="cb132-1463"><a href="#cb132-1463" aria-hidden="true" tabindex="-1"></a><span class="in">     geom_signif(</span></span>
<span id="cb132-1464"><a href="#cb132-1464" aria-hidden="true" tabindex="-1"></a><span class="in">    y_position = c(170, 190, 210),</span></span>
<span id="cb132-1465"><a href="#cb132-1465" aria-hidden="true" tabindex="-1"></a><span class="in">    xmin = c(1, 1, 2),</span></span>
<span id="cb132-1466"><a href="#cb132-1466" aria-hidden="true" tabindex="-1"></a><span class="in">    xmax = c(3, 2, 3),</span></span>
<span id="cb132-1467"><a href="#cb132-1467" aria-hidden="true" tabindex="-1"></a><span class="in">    annotation = c('beta:-1.71~ (-2.31 - -1.103)', 'beta:-0.99~ (-1.59 - -0.40)', 'beta:-0.72 ~ (-1.30 - -0.12)'), </span></span>
<span id="cb132-1468"><a href="#cb132-1468" aria-hidden="true" tabindex="-1"></a><span class="in">    parse = TRUE,</span></span>
<span id="cb132-1469"><a href="#cb132-1469" aria-hidden="true" tabindex="-1"></a><span class="in">    tip_length = 0.02,</span></span>
<span id="cb132-1470"><a href="#cb132-1470" aria-hidden="true" tabindex="-1"></a><span class="in">    textsize = 3,</span></span>
<span id="cb132-1471"><a href="#cb132-1471" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 0.5,</span></span>
<span id="cb132-1472"><a href="#cb132-1472" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "gray60",</span></span>
<span id="cb132-1473"><a href="#cb132-1473" aria-hidden="true" tabindex="-1"></a><span class="in">    vjust = 0.2</span></span>
<span id="cb132-1474"><a href="#cb132-1474" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-1475"><a href="#cb132-1475" aria-hidden="true" tabindex="-1"></a><span class="in">   gghalves::geom_half_point(</span></span>
<span id="cb132-1476"><a href="#cb132-1476" aria-hidden="true" tabindex="-1"></a><span class="in">    data = agg_grp_time,</span></span>
<span id="cb132-1477"><a href="#cb132-1477" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(y = entry.time.diff, x = type),</span></span>
<span id="cb132-1478"><a href="#cb132-1478" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "orange",</span></span>
<span id="cb132-1479"><a href="#cb132-1479" aria-hidden="true" tabindex="-1"></a><span class="in">    # draw jitter on the left</span></span>
<span id="cb132-1480"><a href="#cb132-1480" aria-hidden="true" tabindex="-1"></a><span class="in">    side = "l",</span></span>
<span id="cb132-1481"><a href="#cb132-1481" aria-hidden="true" tabindex="-1"></a><span class="in">    pch = 20,</span></span>
<span id="cb132-1482"><a href="#cb132-1482" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 4,</span></span>
<span id="cb132-1483"><a href="#cb132-1483" aria-hidden="true" tabindex="-1"></a><span class="in">    # control range of jitter</span></span>
<span id="cb132-1484"><a href="#cb132-1484" aria-hidden="true" tabindex="-1"></a><span class="in">    range_scale = .4,</span></span>
<span id="cb132-1485"><a href="#cb132-1485" aria-hidden="true" tabindex="-1"></a><span class="in">    # add some transparency</span></span>
<span id="cb132-1486"><a href="#cb132-1486" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = .5,</span></span>
<span id="cb132-1487"><a href="#cb132-1487" aria-hidden="true" tabindex="-1"></a><span class="in">    transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-1488"><a href="#cb132-1488" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-1489"><a href="#cb132-1489" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_boxplot(</span></span>
<span id="cb132-1490"><a href="#cb132-1490" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = adjustcolor("orange", alpha.f = 0.1),</span></span>
<span id="cb132-1491"><a href="#cb132-1491" aria-hidden="true" tabindex="-1"></a><span class="in">    data = agg_grp_time,</span></span>
<span id="cb132-1492"><a href="#cb132-1492" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(y = entry.time.diff, x = type),</span></span>
<span id="cb132-1493"><a href="#cb132-1493" aria-hidden="true" tabindex="-1"></a><span class="in">    color = adjustcolor("orange", alpha.f = 0.6),</span></span>
<span id="cb132-1494"><a href="#cb132-1494" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .1,</span></span>
<span id="cb132-1495"><a href="#cb132-1495" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-1496"><a href="#cb132-1496" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA</span></span>
<span id="cb132-1497"><a href="#cb132-1497" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-1498"><a href="#cb132-1498" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text(lineheight = 0.8,</span></span>
<span id="cb132-1499"><a href="#cb132-1499" aria-hidden="true" tabindex="-1"></a><span class="in">    data = agg_grps,</span></span>
<span id="cb132-1500"><a href="#cb132-1500" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(y = distance, x = type, label = n.labels),</span></span>
<span id="cb132-1501"><a href="#cb132-1501" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "gray60",</span></span>
<span id="cb132-1502"><a href="#cb132-1502" aria-hidden="true" tabindex="-1"></a><span class="in">    nudge_x = 0,</span></span>
<span id="cb132-1503"><a href="#cb132-1503" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 4</span></span>
<span id="cb132-1504"><a href="#cb132-1504" aria-hidden="true" tabindex="-1"></a><span class="in">  ) + theme_classic(base_size = 12) + theme(legend.position = "none")</span></span>
<span id="cb132-1505"><a href="#cb132-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1506"><a href="#cb132-1506" aria-hidden="true" tabindex="-1"></a><span class="in">ggsave(</span></span>
<span id="cb132-1507"><a href="#cb132-1507" aria-hidden="true" tabindex="-1"></a><span class="in">  "./output/roost_entry_coordination_1_panel.png",</span></span>
<span id="cb132-1508"><a href="#cb132-1508" aria-hidden="true" tabindex="-1"></a><span class="in">  gg_entry,</span></span>
<span id="cb132-1509"><a href="#cb132-1509" aria-hidden="true" tabindex="-1"></a><span class="in">  grDevices::png,</span></span>
<span id="cb132-1510"><a href="#cb132-1510" aria-hidden="true" tabindex="-1"></a><span class="in">  width = 4.5,</span></span>
<span id="cb132-1511"><a href="#cb132-1511" aria-hidden="true" tabindex="-1"></a><span class="in">  height = 3.5,</span></span>
<span id="cb132-1512"><a href="#cb132-1512" aria-hidden="true" tabindex="-1"></a><span class="in">  dpi = 300</span></span>
<span id="cb132-1513"><a href="#cb132-1513" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-1514"><a href="#cb132-1514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1515"><a href="#cb132-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1516"><a href="#cb132-1516" aria-hidden="true" tabindex="-1"></a>By group size:</span>
<span id="cb132-1517"><a href="#cb132-1517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-1518"><a href="#cb132-1518" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-1519"><a href="#cb132-1519" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(sim_groups_l[[1]],</span></span>
<span id="cb132-1520"><a href="#cb132-1520" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(</span></span>
<span id="cb132-1521"><a href="#cb132-1521" aria-hidden="true" tabindex="-1"></a><span class="in">         y = entry.time.diff,</span></span>
<span id="cb132-1522"><a href="#cb132-1522" aria-hidden="true" tabindex="-1"></a><span class="in">         x = type,</span></span>
<span id="cb132-1523"><a href="#cb132-1523" aria-hidden="true" tabindex="-1"></a><span class="in">         color = type,</span></span>
<span id="cb132-1524"><a href="#cb132-1524" aria-hidden="true" tabindex="-1"></a><span class="in">         fill = type</span></span>
<span id="cb132-1525"><a href="#cb132-1525" aria-hidden="true" tabindex="-1"></a><span class="in">       )) +</span></span>
<span id="cb132-1526"><a href="#cb132-1526" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-1527"><a href="#cb132-1527" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-1528"><a href="#cb132-1528" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-1529"><a href="#cb132-1529" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-1530"><a href="#cb132-1530" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-1531"><a href="#cb132-1531" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-1532"><a href="#cb132-1532" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-1533"><a href="#cb132-1533" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-1534"><a href="#cb132-1534" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-1535"><a href="#cb132-1535" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-1536"><a href="#cb132-1536" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-1537"><a href="#cb132-1537" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-1538"><a href="#cb132-1538" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-1539"><a href="#cb132-1539" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-1540"><a href="#cb132-1540" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-1541"><a href="#cb132-1541" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-1542"><a href="#cb132-1542" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-1543"><a href="#cb132-1543" aria-hidden="true" tabindex="-1"></a><span class="in">    # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-1544"><a href="#cb132-1544" aria-hidden="true" tabindex="-1"></a><span class="in">    gghalves::geom_half_point(</span></span>
<span id="cb132-1545"><a href="#cb132-1545" aria-hidden="true" tabindex="-1"></a><span class="in">      # color = fill_color,</span></span>
<span id="cb132-1546"><a href="#cb132-1546" aria-hidden="true" tabindex="-1"></a><span class="in">      # draw jitter on the left</span></span>
<span id="cb132-1547"><a href="#cb132-1547" aria-hidden="true" tabindex="-1"></a><span class="in">      side = "l",</span></span>
<span id="cb132-1548"><a href="#cb132-1548" aria-hidden="true" tabindex="-1"></a><span class="in">      # control range of jitter</span></span>
<span id="cb132-1549"><a href="#cb132-1549" aria-hidden="true" tabindex="-1"></a><span class="in">      range_scale = .4,</span></span>
<span id="cb132-1550"><a href="#cb132-1550" aria-hidden="true" tabindex="-1"></a><span class="in">      # add some transparency</span></span>
<span id="cb132-1551"><a href="#cb132-1551" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = .5,</span></span>
<span id="cb132-1552"><a href="#cb132-1552" aria-hidden="true" tabindex="-1"></a><span class="in">      transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-1553"><a href="#cb132-1553" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb132-1554"><a href="#cb132-1554" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-1555"><a href="#cb132-1555" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-1556"><a href="#cb132-1556" aria-hidden="true" tabindex="-1"></a><span class="in">                           end = 0.8,</span></span>
<span id="cb132-1557"><a href="#cb132-1557" aria-hidden="true" tabindex="-1"></a><span class="in">                           alpha = 0.6) +</span></span>
<span id="cb132-1558"><a href="#cb132-1558" aria-hidden="true" tabindex="-1"></a><span class="in">      # ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb132-1559"><a href="#cb132-1559" aria-hidden="true" tabindex="-1"></a><span class="in">           scale_x_discrete(labels = c(</span></span>
<span id="cb132-1560"><a href="#cb132-1560" aria-hidden="true" tabindex="-1"></a><span class="in">        "natural" = "Natural",</span></span>
<span id="cb132-1561"><a href="#cb132-1561" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial" = "Artificial",</span></span>
<span id="cb132-1562"><a href="#cb132-1562" aria-hidden="true" tabindex="-1"></a><span class="in">        "simulated" = "Simulated"</span></span>
<span id="cb132-1563"><a href="#cb132-1563" aria-hidden="true" tabindex="-1"></a><span class="in">      )) +</span></span>
<span id="cb132-1564"><a href="#cb132-1564" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "none") +</span></span>
<span id="cb132-1565"><a href="#cb132-1565" aria-hidden="true" tabindex="-1"></a><span class="in">      facet_wrap(</span></span>
<span id="cb132-1566"><a href="#cb132-1566" aria-hidden="true" tabindex="-1"></a><span class="in">        ~ group.size.factor,</span></span>
<span id="cb132-1567"><a href="#cb132-1567" aria-hidden="true" tabindex="-1"></a><span class="in">        ncol = 2,</span></span>
<span id="cb132-1568"><a href="#cb132-1568" aria-hidden="true" tabindex="-1"></a><span class="in">        labeller = labeller(group.size.factor = custom_labels)</span></span>
<span id="cb132-1569"><a href="#cb132-1569" aria-hidden="true" tabindex="-1"></a><span class="in">      ) +</span></span>
<span id="cb132-1570"><a href="#cb132-1570" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Flight type", y = "Time difference (s)")</span></span>
<span id="cb132-1571"><a href="#cb132-1571" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-1572"><a href="#cb132-1572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1573"><a href="#cb132-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1574"><a href="#cb132-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1575"><a href="#cb132-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1576"><a href="#cb132-1576" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression model</span></span>
<span id="cb132-1577"><a href="#cb132-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1578"><a href="#cb132-1578" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Add the group roost entry data to each simulated set and run a bayesian mixed effects model coordination on roost entry for each data set </span>
<span id="cb132-1579"><a href="#cb132-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1580"><a href="#cb132-1580" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The difference in time between when entering the roost between consecutive individuals was used as the response variable (modeled with a normal distribution), while group type (natural, artificial or simulated) was used as predictor</span>
<span id="cb132-1581"><a href="#cb132-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1582"><a href="#cb132-1582" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Group ID was included as varying effect</span>
<span id="cb132-1583"><a href="#cb132-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1584"><a href="#cb132-1584" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The posterior distributions from the 30 models were combined into a single model fit for statistical inference</span>
<span id="cb132-1585"><a href="#cb132-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1586"><a href="#cb132-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1587"><a href="#cb132-1587" aria-hidden="true" tabindex="-1"></a>Model:</span>
<span id="cb132-1588"><a href="#cb132-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1589"><a href="#cb132-1589" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-1590"><a href="#cb132-1590" aria-hidden="true" tabindex="-1"></a>\text{log(entry time difference + 1)} \sim \text{type} + \text{monotonic(group size)} + (\text{1} \mid \text{group})</span>
<span id="cb132-1591"><a href="#cb132-1591" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-1592"><a href="#cb132-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1593"><a href="#cb132-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1594"><a href="#cb132-1594" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  entry time regression, eval = FALSE}</span></span>
<span id="cb132-1595"><a href="#cb132-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1596"><a href="#cb132-1596" aria-hidden="true" tabindex="-1"></a><span class="in">entry_mod_list &lt;- brm_multiple(</span></span>
<span id="cb132-1597"><a href="#cb132-1597" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = log(entry.time.diff + 1) ~ type + mo(group.size) + (1 | group),</span></span>
<span id="cb132-1598"><a href="#cb132-1598" aria-hidden="true" tabindex="-1"></a><span class="in">  iter = iter,</span></span>
<span id="cb132-1599"><a href="#cb132-1599" aria-hidden="true" tabindex="-1"></a><span class="in">  thin = 1,</span></span>
<span id="cb132-1600"><a href="#cb132-1600" aria-hidden="true" tabindex="-1"></a><span class="in">  data = sim_groups_l,</span></span>
<span id="cb132-1601"><a href="#cb132-1601" aria-hidden="true" tabindex="-1"></a><span class="in">  family = gaussian(),</span></span>
<span id="cb132-1602"><a href="#cb132-1602" aria-hidden="true" tabindex="-1"></a><span class="in">  silent = 2,</span></span>
<span id="cb132-1603"><a href="#cb132-1603" aria-hidden="true" tabindex="-1"></a><span class="in">  chains = chains,</span></span>
<span id="cb132-1604"><a href="#cb132-1604" aria-hidden="true" tabindex="-1"></a><span class="in">  backend = "cmdstanr",</span></span>
<span id="cb132-1605"><a href="#cb132-1605" aria-hidden="true" tabindex="-1"></a><span class="in">  # only works if cmdstanr package is installed</span></span>
<span id="cb132-1606"><a href="#cb132-1606" aria-hidden="true" tabindex="-1"></a><span class="in">  threads = threading(2),</span></span>
<span id="cb132-1607"><a href="#cb132-1607" aria-hidden="true" tabindex="-1"></a><span class="in">  cores = chains,</span></span>
<span id="cb132-1608"><a href="#cb132-1608" aria-hidden="true" tabindex="-1"></a><span class="in">  combine = FALSE,</span></span>
<span id="cb132-1609"><a href="#cb132-1609" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(adapt_delta = 0.99, max_treedepth = 15)</span></span>
<span id="cb132-1610"><a href="#cb132-1610" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-1611"><a href="#cb132-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1612"><a href="#cb132-1612" aria-hidden="true" tabindex="-1"></a><span class="in">custom_ppc(fit = entry_mod_list[[1]], group = "type")</span></span>
<span id="cb132-1613"><a href="#cb132-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1614"><a href="#cb132-1614" aria-hidden="true" tabindex="-1"></a><span class="in">entry_mod_list &lt;- pblapply(entry_mod_list,  function(x) add_criterion(x, criterion = c("loo")))</span></span>
<span id="cb132-1615"><a href="#cb132-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1616"><a href="#cb132-1616" aria-hidden="true" tabindex="-1"></a><span class="in">saveRDS(entry_mod_list,</span></span>
<span id="cb132-1617"><a href="#cb132-1617" aria-hidden="true" tabindex="-1"></a><span class="in">        "./data/processed/model_list_roost_entry_time_regression_monotonic.RDS")</span></span>
<span id="cb132-1618"><a href="#cb132-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1619"><a href="#cb132-1619" aria-hidden="true" tabindex="-1"></a><span class="in"># run null model</span></span>
<span id="cb132-1620"><a href="#cb132-1620" aria-hidden="true" tabindex="-1"></a><span class="in">null_entry_mod_list &lt;- brm_multiple(</span></span>
<span id="cb132-1621"><a href="#cb132-1621" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = log(entry.time.diff + 1) ~ 1 + (1 | group),</span></span>
<span id="cb132-1622"><a href="#cb132-1622" aria-hidden="true" tabindex="-1"></a><span class="in">  iter = iter,</span></span>
<span id="cb132-1623"><a href="#cb132-1623" aria-hidden="true" tabindex="-1"></a><span class="in">  thin = 1,</span></span>
<span id="cb132-1624"><a href="#cb132-1624" aria-hidden="true" tabindex="-1"></a><span class="in">  data = sim_groups_l,</span></span>
<span id="cb132-1625"><a href="#cb132-1625" aria-hidden="true" tabindex="-1"></a><span class="in">  family = gaussian(),</span></span>
<span id="cb132-1626"><a href="#cb132-1626" aria-hidden="true" tabindex="-1"></a><span class="in">  silent = 2,</span></span>
<span id="cb132-1627"><a href="#cb132-1627" aria-hidden="true" tabindex="-1"></a><span class="in">  chains = chains,</span></span>
<span id="cb132-1628"><a href="#cb132-1628" aria-hidden="true" tabindex="-1"></a><span class="in">  backend = "cmdstanr",</span></span>
<span id="cb132-1629"><a href="#cb132-1629" aria-hidden="true" tabindex="-1"></a><span class="in">  # only works if cmdstanr package is installed</span></span>
<span id="cb132-1630"><a href="#cb132-1630" aria-hidden="true" tabindex="-1"></a><span class="in">  threads = threading(2),</span></span>
<span id="cb132-1631"><a href="#cb132-1631" aria-hidden="true" tabindex="-1"></a><span class="in">  cores = chains,</span></span>
<span id="cb132-1632"><a href="#cb132-1632" aria-hidden="true" tabindex="-1"></a><span class="in">  combine = FALSE,</span></span>
<span id="cb132-1633"><a href="#cb132-1633" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(adapt_delta = 0.99, max_treedepth = 15)</span></span>
<span id="cb132-1634"><a href="#cb132-1634" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-1635"><a href="#cb132-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1636"><a href="#cb132-1636" aria-hidden="true" tabindex="-1"></a><span class="in">null_entry_mod_list &lt;- pblapply(null_entry_mod_list,  function(x) add_criterion(x, criterion = c("loo")))</span></span>
<span id="cb132-1637"><a href="#cb132-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1638"><a href="#cb132-1638" aria-hidden="true" tabindex="-1"></a><span class="in"># loo_compare(entry_mod_list[[1]], null_entry_mod_list[[1]])</span></span>
<span id="cb132-1639"><a href="#cb132-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1640"><a href="#cb132-1640" aria-hidden="true" tabindex="-1"></a><span class="in">saveRDS(null_entry_mod_list,</span></span>
<span id="cb132-1641"><a href="#cb132-1641" aria-hidden="true" tabindex="-1"></a><span class="in">        "./data/processed/null_model_list_roost_entry_time_regression_monotonic.RDS")</span></span>
<span id="cb132-1642"><a href="#cb132-1642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1643"><a href="#cb132-1643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1644"><a href="#cb132-1644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1645"><a href="#cb132-1645" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb132-1646"><a href="#cb132-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1647"><a href="#cb132-1647" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model performance vs null model </span></span>
<span id="cb132-1648"><a href="#cb132-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1649"><a href="#cb132-1649" aria-hidden="true" tabindex="-1"></a><span class="in">```{r regression results model comparison, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-1650"><a href="#cb132-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1651"><a href="#cb132-1651" aria-hidden="true" tabindex="-1"></a><span class="in">model_list_roost_entry_time_regression &lt;-</span></span>
<span id="cb132-1652"><a href="#cb132-1652" aria-hidden="true" tabindex="-1"></a><span class="in">  readRDS("./data/processed/model_list_roost_entry_time_regression_monotonic.RDS")</span></span>
<span id="cb132-1653"><a href="#cb132-1653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1654"><a href="#cb132-1654" aria-hidden="true" tabindex="-1"></a><span class="in">null_model_list_roost_entry_time_regression &lt;-</span></span>
<span id="cb132-1655"><a href="#cb132-1655" aria-hidden="true" tabindex="-1"></a><span class="in">  readRDS("./data/processed/null_model_list_roost_entry_time_regression_monotonic.RDS")</span></span>
<span id="cb132-1656"><a href="#cb132-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1657"><a href="#cb132-1657" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diffs &lt;- </span></span>
<span id="cb132-1658"><a href="#cb132-1658" aria-hidden="true" tabindex="-1"></a><span class="in">lapply(seq_along(model_list_roost_entry_time_regression), function(x)</span></span>
<span id="cb132-1659"><a href="#cb132-1659" aria-hidden="true" tabindex="-1"></a><span class="in">  loo::loo_compare(model_list_roost_entry_time_regression[[x]], null_model_list_roost_entry_time_regression[[x]])</span></span>
<span id="cb132-1660"><a href="#cb132-1660" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-1661"><a href="#cb132-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1662"><a href="#cb132-1662" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff &lt;- do.call(rbind, loo_diffs)</span></span>
<span id="cb132-1663"><a href="#cb132-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1664"><a href="#cb132-1664" aria-hidden="true" tabindex="-1"></a><span class="in">rows &lt;- rownames(loo_diff)</span></span>
<span id="cb132-1665"><a href="#cb132-1665" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff &lt;- as.data.frame(loo_diff)</span></span>
<span id="cb132-1666"><a href="#cb132-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1667"><a href="#cb132-1667" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff$model &lt;- rows</span></span>
<span id="cb132-1668"><a href="#cb132-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1669"><a href="#cb132-1669" aria-hidden="true" tabindex="-1"></a><span class="in">aggregate(cbind(elpd_diff, se_diff) ~ model, loo_diff, mean)</span></span>
<span id="cb132-1670"><a href="#cb132-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1671"><a href="#cb132-1671" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1672"><a href="#cb132-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1673"><a href="#cb132-1673" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model fit</span></span>
<span id="cb132-1674"><a href="#cb132-1674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1675"><a href="#cb132-1675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r regression results entry, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-1676"><a href="#cb132-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1677"><a href="#cb132-1677" aria-hidden="true" tabindex="-1"></a><span class="in"># average model</span></span>
<span id="cb132-1678"><a href="#cb132-1678" aria-hidden="true" tabindex="-1"></a><span class="in">avrg_call &lt;-</span></span>
<span id="cb132-1679"><a href="#cb132-1679" aria-hidden="true" tabindex="-1"></a><span class="in">  paste0("posterior_average(",</span></span>
<span id="cb132-1680"><a href="#cb132-1680" aria-hidden="true" tabindex="-1"></a><span class="in">         paste0(paste0("model_list_roost_entry_time_regression[[", 1:length(model_list_roost_entry_time_regression), "]]"), collapse = ", "),</span></span>
<span id="cb132-1681"><a href="#cb132-1681" aria-hidden="true" tabindex="-1"></a><span class="in">         ", weights = 'loo')")</span></span>
<span id="cb132-1682"><a href="#cb132-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1683"><a href="#cb132-1683" aria-hidden="true" tabindex="-1"></a><span class="in">average_model_draws &lt;- eval(parse(text = avrg_call))</span></span>
<span id="cb132-1684"><a href="#cb132-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1685"><a href="#cb132-1685" aria-hidden="true" tabindex="-1"></a><span class="in">draw_extended_summary(average_model_draws,</span></span>
<span id="cb132-1686"><a href="#cb132-1686" aria-hidden="true" tabindex="-1"></a><span class="in">                      highlight = TRUE,</span></span>
<span id="cb132-1687"><a href="#cb132-1687" aria-hidden="true" tabindex="-1"></a><span class="in">                      fill = fill_color,</span></span>
<span id="cb132-1688"><a href="#cb132-1688" aria-hidden="true" tabindex="-1"></a><span class="in">                      beta.prefix = c("^b_", "^bsp_mo"))</span></span>
<span id="cb132-1689"><a href="#cb132-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1690"><a href="#cb132-1690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1691"><a href="#cb132-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1692"><a href="#cb132-1692" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Contrasts</span></span>
<span id="cb132-1693"><a href="#cb132-1693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r regresion contrasts roost entry, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-1694"><a href="#cb132-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1695"><a href="#cb132-1695" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts &lt;-</span></span>
<span id="cb132-1696"><a href="#cb132-1696" aria-hidden="true" tabindex="-1"></a><span class="in">  draws_contrasts(</span></span>
<span id="cb132-1697"><a href="#cb132-1697" aria-hidden="true" tabindex="-1"></a><span class="in">    average_model_draws,</span></span>
<span id="cb132-1698"><a href="#cb132-1698" aria-hidden="true" tabindex="-1"></a><span class="in">    predictor_name = "type",</span></span>
<span id="cb132-1699"><a href="#cb132-1699" aria-hidden="true" tabindex="-1"></a><span class="in">    basal_level = "Natural",</span></span>
<span id="cb132-1700"><a href="#cb132-1700" aria-hidden="true" tabindex="-1"></a><span class="in">    fill_color = fill_color</span></span>
<span id="cb132-1701"><a href="#cb132-1701" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-1702"><a href="#cb132-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1703"><a href="#cb132-1703" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts$contrasts</span></span>
<span id="cb132-1704"><a href="#cb132-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1705"><a href="#cb132-1705" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts$plot + theme_classic()</span></span>
<span id="cb132-1706"><a href="#cb132-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1707"><a href="#cb132-1707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1708"><a href="#cb132-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1709"><a href="#cb132-1709" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Posterior predictive checks</span></span>
<span id="cb132-1712"><a href="#cb132-1712" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-1713"><a href="#cb132-1713" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> model_list_roost_entry_time_regression[[<span class="dv">1</span>]], <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb132-1714"><a href="#cb132-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1715"><a href="#cb132-1715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1716"><a href="#cb132-1716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1717"><a href="#cb132-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1718"><a href="#cb132-1718" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-1719"><a href="#cb132-1719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1720"><a href="#cb132-1720" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb132-1721"><a href="#cb132-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1722"><a href="#cb132-1722" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Natural groups enter more coordinated than simulated and artificial groups </span>
<span id="cb132-1723"><a href="#cb132-1723" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Artificial groups enter more coordinated than simulated groups</span>
<span id="cb132-1724"><a href="#cb132-1724" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Entry time difference decreases with group size</span>
<span id="cb132-1725"><a href="#cb132-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1726"><a href="#cb132-1726" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-1727"><a href="#cb132-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1728"><a href="#cb132-1728" aria-hidden="true" tabindex="-1"></a><span class="fu"># Calling behavior</span></span>
<span id="cb132-1729"><a href="#cb132-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1730"><a href="#cb132-1730" aria-hidden="true" tabindex="-1"></a><span class="fu">## Read data</span></span>
<span id="cb132-1731"><a href="#cb132-1731" aria-hidden="true" tabindex="-1"></a><span class="in">```{r read data, eval = TRUE, warning=FALSE}</span></span>
<span id="cb132-1732"><a href="#cb132-1732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1733"><a href="#cb132-1733" aria-hidden="true" tabindex="-1"></a><span class="in">clls &lt;- readRDS("./data/processed/curated_extended_selection_table_inquiry_calls_2020_&amp;_2021.RDS")</span></span>
<span id="cb132-1734"><a href="#cb132-1734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1735"><a href="#cb132-1735" aria-hidden="true" tabindex="-1"></a><span class="in">sub_clls &lt;- clls[!duplicated(clls$org.sound.files), ]</span></span>
<span id="cb132-1736"><a href="#cb132-1736" aria-hidden="true" tabindex="-1"></a><span class="in">sub_clls$file.duration &lt;- sub_clls$sound.file.samples / (sub_clls$sample.rate * 1000)</span></span>
<span id="cb132-1737"><a href="#cb132-1737" aria-hidden="true" tabindex="-1"></a><span class="in"># </span></span>
<span id="cb132-1738"><a href="#cb132-1738" aria-hidden="true" tabindex="-1"></a><span class="in"># metadat2 &lt;- read.csv("./data/processed/metadata_inquiry_calls_2020_&amp;_2021.csv", stringsAsFactors = FALSE)</span></span>
<span id="cb132-1739"><a href="#cb132-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1740"><a href="#cb132-1740" aria-hidden="true" tabindex="-1"></a><span class="in">metadat &lt;- as.data.frame(read_excel("./data/raw/Anexo 1_Proyecto MPI enero 20-21.xlsx"))</span></span>
<span id="cb132-1741"><a href="#cb132-1741" aria-hidden="true" tabindex="-1"></a><span class="in">names(metadat) &lt;- gsub(" ", ".", names(metadat))</span></span>
<span id="cb132-1742"><a href="#cb132-1742" aria-hidden="true" tabindex="-1"></a><span class="in">metadat$year &lt;- substr(metadat$DÃ­a, 0, 4)</span></span>
<span id="cb132-1743"><a href="#cb132-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1744"><a href="#cb132-1744" aria-hidden="true" tabindex="-1"></a><span class="in">metadat$year[is.na(metadat$year)] &lt;- "2021"</span></span>
<span id="cb132-1745"><a href="#cb132-1745" aria-hidden="true" tabindex="-1"></a><span class="in">metadat &lt;- metadat[metadat$tipo.de.video != "calibracion de video", ]</span></span>
<span id="cb132-1746"><a href="#cb132-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1747"><a href="#cb132-1747" aria-hidden="true" tabindex="-1"></a><span class="in"># audio solamente para identificacion de sonidos. TASA NO</span></span>
<span id="cb132-1748"><a href="#cb132-1748" aria-hidden="true" tabindex="-1"></a><span class="in">metadat &lt;- metadat[metadat$Audio != "60 y 61", ]</span></span>
<span id="cb132-1749"><a href="#cb132-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1750"><a href="#cb132-1750" aria-hidden="true" tabindex="-1"></a><span class="in">metadat$year.audio &lt;- paste(metadat$year, metadat$Audio, sep = "-")</span></span>
<span id="cb132-1751"><a href="#cb132-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1752"><a href="#cb132-1752" aria-hidden="true" tabindex="-1"></a><span class="in">caps &lt;- as.data.frame(read_excel("./data/raw/Proyecto MPI enero 2020_2.xlsx", sheet = "Capturas"))</span></span>
<span id="cb132-1753"><a href="#cb132-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1754"><a href="#cb132-1754" aria-hidden="true" tabindex="-1"></a><span class="in"># read acoustic parameter data</span></span>
<span id="cb132-1755"><a href="#cb132-1755" aria-hidden="true" tabindex="-1"></a><span class="in">acous_param_l &lt;- readRDS("./data/processed/acoustic_parameters_all_groups_specific_warbler_acoustic_measurements_curated_data_2020_&amp;_2021.RDS")</span></span>
<span id="cb132-1756"><a href="#cb132-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1757"><a href="#cb132-1757" aria-hidden="true" tabindex="-1"></a><span class="in"># read as RDS</span></span>
<span id="cb132-1758"><a href="#cb132-1758" aria-hidden="true" tabindex="-1"></a><span class="in">agg_pred &lt;- readRDS("./data/processed/predicted_individual_in_group_flights_2020_&amp;_2021.RDS")</span></span>
<span id="cb132-1759"><a href="#cb132-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1760"><a href="#cb132-1760" aria-hidden="true" tabindex="-1"></a><span class="in"># read diagnostics</span></span>
<span id="cb132-1761"><a href="#cb132-1761" aria-hidden="true" tabindex="-1"></a><span class="in">diagnostics &lt;- readRDS("./data/processed/random_forests_diagnostics_solo_flight.RDS")</span></span>
<span id="cb132-1762"><a href="#cb132-1762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1763"><a href="#cb132-1763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1764"><a href="#cb132-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1765"><a href="#cb132-1765" aria-hidden="true" tabindex="-1"></a><span class="fu">## Call rate</span></span>
<span id="cb132-1766"><a href="#cb132-1766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1767"><a href="#cb132-1767" aria-hidden="true" tabindex="-1"></a><span class="fu">### Individual in solo flight vs overall group flight</span></span>
<span id="cb132-1768"><a href="#cb132-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1769"><a href="#cb132-1769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r individual vs group call rate stats 1, eval = TRUE}</span></span>
<span id="cb132-1770"><a href="#cb132-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1771"><a href="#cb132-1771" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group &lt;-</span></span>
<span id="cb132-1772"><a href="#cb132-1772" aria-hidden="true" tabindex="-1"></a><span class="in">  readRDS("./data/processed/call_rate_by_group.RDS")</span></span>
<span id="cb132-1773"><a href="#cb132-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1774"><a href="#cb132-1774" aria-hidden="true" tabindex="-1"></a><span class="in"># remove those in which only one individual called</span></span>
<span id="cb132-1775"><a href="#cb132-1775" aria-hidden="true" tabindex="-1"></a><span class="in">call_id_seq &lt;- read.csv("./data/processed/group_call_individual_id_sequence.csv")</span></span>
<span id="cb132-1776"><a href="#cb132-1776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1777"><a href="#cb132-1777" aria-hidden="true" tabindex="-1"></a><span class="in">call_id_seq &lt;- call_id_seq[order(call_id_seq$event, call_id_seq$start), ]</span></span>
<span id="cb132-1778"><a href="#cb132-1778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1779"><a href="#cb132-1779" aria-hidden="true" tabindex="-1"></a><span class="in">call_id_seq_list &lt;- split(call_id_seq, call_id_seq$event)</span></span>
<span id="cb132-1780"><a href="#cb132-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1781"><a href="#cb132-1781" aria-hidden="true" tabindex="-1"></a><span class="in"># get diversity and entropy</span></span>
<span id="cb132-1782"><a href="#cb132-1782" aria-hidden="true" tabindex="-1"></a><span class="in">unique_callers_list &lt;- pblapply(call_id_seq_list, function(x){</span></span>
<span id="cb132-1783"><a href="#cb132-1783" aria-hidden="true" tabindex="-1"></a><span class="in">  x &lt;- x[order(x$start), ]</span></span>
<span id="cb132-1784"><a href="#cb132-1784" aria-hidden="true" tabindex="-1"></a><span class="in">  id_seq &lt;- x$indiv</span></span>
<span id="cb132-1785"><a href="#cb132-1785" aria-hidden="true" tabindex="-1"></a><span class="in">  id_seq &lt;- as.character(as.numeric(factor(id_seq)))</span></span>
<span id="cb132-1786"><a href="#cb132-1786" aria-hidden="true" tabindex="-1"></a><span class="in">  unique.callers &lt;- length(unique(id_seq))</span></span>
<span id="cb132-1787"><a href="#cb132-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1788"><a href="#cb132-1788" aria-hidden="true" tabindex="-1"></a><span class="in">  out &lt;- data.frame(group = x$group[1], unique.callers = unique.callers)</span></span>
<span id="cb132-1789"><a href="#cb132-1789" aria-hidden="true" tabindex="-1"></a><span class="in">  return(out)</span></span>
<span id="cb132-1790"><a href="#cb132-1790" aria-hidden="true" tabindex="-1"></a><span class="in"> }</span></span>
<span id="cb132-1791"><a href="#cb132-1791" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-1792"><a href="#cb132-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1793"><a href="#cb132-1793" aria-hidden="true" tabindex="-1"></a><span class="in">unique_callers_df &lt;- do_call(rbind, unique_callers_list)</span></span>
<span id="cb132-1794"><a href="#cb132-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1795"><a href="#cb132-1795" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group &lt;- call_rate_by_group[!call_rate_by_group$group %in% unique_callers_df$group[unique_callers_df$unique.callers == 1], ]</span></span>
<span id="cb132-1796"><a href="#cb132-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1797"><a href="#cb132-1797" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group$type &lt;-</span></span>
<span id="cb132-1798"><a href="#cb132-1798" aria-hidden="true" tabindex="-1"></a><span class="in">  ifelse(</span></span>
<span id="cb132-1799"><a href="#cb132-1799" aria-hidden="true" tabindex="-1"></a><span class="in">    call_rate_by_group$type == "solo",</span></span>
<span id="cb132-1800"><a href="#cb132-1800" aria-hidden="true" tabindex="-1"></a><span class="in">    "solo",</span></span>
<span id="cb132-1801"><a href="#cb132-1801" aria-hidden="true" tabindex="-1"></a><span class="in">    paste(call_rate_by_group$experiment, call_rate_by_group$type, sep = "-")</span></span>
<span id="cb132-1802"><a href="#cb132-1802" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-1803"><a href="#cb132-1803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1804"><a href="#cb132-1804" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group$type &lt;-</span></span>
<span id="cb132-1805"><a href="#cb132-1805" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub("mixed.group",</span></span>
<span id="cb132-1806"><a href="#cb132-1806" aria-hidden="true" tabindex="-1"></a><span class="in">       "artificial.group",</span></span>
<span id="cb132-1807"><a href="#cb132-1807" aria-hidden="true" tabindex="-1"></a><span class="in">       call_rate_by_group$type)</span></span>
<span id="cb132-1808"><a href="#cb132-1808" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group$type &lt;-</span></span>
<span id="cb132-1809"><a href="#cb132-1809" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub("regular.group",</span></span>
<span id="cb132-1810"><a href="#cb132-1810" aria-hidden="true" tabindex="-1"></a><span class="in">       "natural.group",</span></span>
<span id="cb132-1811"><a href="#cb132-1811" aria-hidden="true" tabindex="-1"></a><span class="in">       call_rate_by_group$type)</span></span>
<span id="cb132-1812"><a href="#cb132-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1813"><a href="#cb132-1813" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group$type &lt;-</span></span>
<span id="cb132-1814"><a href="#cb132-1814" aria-hidden="true" tabindex="-1"></a><span class="in">  factor(</span></span>
<span id="cb132-1815"><a href="#cb132-1815" aria-hidden="true" tabindex="-1"></a><span class="in">    call_rate_by_group$type,</span></span>
<span id="cb132-1816"><a href="#cb132-1816" aria-hidden="true" tabindex="-1"></a><span class="in">    levels = c("solo", "natural.group", "artificial.group")</span></span>
<span id="cb132-1817"><a href="#cb132-1817" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-1818"><a href="#cb132-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1819"><a href="#cb132-1819" aria-hidden="true" tabindex="-1"></a><span class="in"># mean centering group size</span></span>
<span id="cb132-1820"><a href="#cb132-1820" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group$group.size.f &lt;- </span></span>
<span id="cb132-1821"><a href="#cb132-1821" aria-hidden="true" tabindex="-1"></a><span class="in">  factor(call_rate_by_group$group.size, ordered = TRUE)</span></span>
<span id="cb132-1822"><a href="#cb132-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1823"><a href="#cb132-1823" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1824"><a href="#cb132-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1825"><a href="#cb132-1825" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot raw data</span></span>
<span id="cb132-1826"><a href="#cb132-1826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1827"><a href="#cb132-1827" aria-hidden="true" tabindex="-1"></a>All group sizes combined:</span>
<span id="cb132-1828"><a href="#cb132-1828" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-1829"><a href="#cb132-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1830"><a href="#cb132-1830" aria-hidden="true" tabindex="-1"></a><span class="in"># table(call_rate_by_group$group.size, call_rate_by_group$type)</span></span>
<span id="cb132-1831"><a href="#cb132-1831" aria-hidden="true" tabindex="-1"></a><span class="in">cols &lt;- graph_cols[1:3]</span></span>
<span id="cb132-1832"><a href="#cb132-1832" aria-hidden="true" tabindex="-1"></a><span class="in">cols_transp &lt;- graph_cols_transp[1:3]</span></span>
<span id="cb132-1833"><a href="#cb132-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1834"><a href="#cb132-1834" aria-hidden="true" tabindex="-1"></a><span class="in">names(cols) &lt;- names(cols_transp) &lt;- c("solo", "natural.group", "artificial.group")</span></span>
<span id="cb132-1835"><a href="#cb132-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1836"><a href="#cb132-1836" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-1837"><a href="#cb132-1837" aria-hidden="true" tabindex="-1"></a><span class="in">  ggrate_indv_grp &lt;- ggplot(call_rate_by_group,</span></span>
<span id="cb132-1838"><a href="#cb132-1838" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(</span></span>
<span id="cb132-1839"><a href="#cb132-1839" aria-hidden="true" tabindex="-1"></a><span class="in">         y = rate,</span></span>
<span id="cb132-1840"><a href="#cb132-1840" aria-hidden="true" tabindex="-1"></a><span class="in">         x = type,</span></span>
<span id="cb132-1841"><a href="#cb132-1841" aria-hidden="true" tabindex="-1"></a><span class="in">         color = type,</span></span>
<span id="cb132-1842"><a href="#cb132-1842" aria-hidden="true" tabindex="-1"></a><span class="in">         fill = type</span></span>
<span id="cb132-1843"><a href="#cb132-1843" aria-hidden="true" tabindex="-1"></a><span class="in">       )) +</span></span>
<span id="cb132-1844"><a href="#cb132-1844" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-1845"><a href="#cb132-1845" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-1846"><a href="#cb132-1846" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-1847"><a href="#cb132-1847" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-1848"><a href="#cb132-1848" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-1849"><a href="#cb132-1849" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-1850"><a href="#cb132-1850" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-1851"><a href="#cb132-1851" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-1852"><a href="#cb132-1852" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-1853"><a href="#cb132-1853" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-1854"><a href="#cb132-1854" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-1855"><a href="#cb132-1855" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-1856"><a href="#cb132-1856" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-1857"><a href="#cb132-1857" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-1858"><a href="#cb132-1858" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-1859"><a href="#cb132-1859" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-1860"><a href="#cb132-1860" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-1861"><a href="#cb132-1861" aria-hidden="true" tabindex="-1"></a><span class="in">    # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-1862"><a href="#cb132-1862" aria-hidden="true" tabindex="-1"></a><span class="in">    gghalves::geom_half_point(</span></span>
<span id="cb132-1863"><a href="#cb132-1863" aria-hidden="true" tabindex="-1"></a><span class="in">      # color = fill_color,</span></span>
<span id="cb132-1864"><a href="#cb132-1864" aria-hidden="true" tabindex="-1"></a><span class="in">      # draw jitter on the left</span></span>
<span id="cb132-1865"><a href="#cb132-1865" aria-hidden="true" tabindex="-1"></a><span class="in">      side = "l",</span></span>
<span id="cb132-1866"><a href="#cb132-1866" aria-hidden="true" tabindex="-1"></a><span class="in">      # control range of jitter</span></span>
<span id="cb132-1867"><a href="#cb132-1867" aria-hidden="true" tabindex="-1"></a><span class="in">      range_scale = .4,</span></span>
<span id="cb132-1868"><a href="#cb132-1868" aria-hidden="true" tabindex="-1"></a><span class="in">      # add some transparency</span></span>
<span id="cb132-1869"><a href="#cb132-1869" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = .5,</span></span>
<span id="cb132-1870"><a href="#cb132-1870" aria-hidden="true" tabindex="-1"></a><span class="in">      transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-1871"><a href="#cb132-1871" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb132-1872"><a href="#cb132-1872" aria-hidden="true" tabindex="-1"></a><span class="in">      # scale_color_viridis_d(option = "G", begin = 0.2, end = 0.8) +</span></span>
<span id="cb132-1873"><a href="#cb132-1873" aria-hidden="true" tabindex="-1"></a><span class="in">      # scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-1874"><a href="#cb132-1874" aria-hidden="true" tabindex="-1"></a><span class="in">      #                      end = 0.8,</span></span>
<span id="cb132-1875"><a href="#cb132-1875" aria-hidden="true" tabindex="-1"></a><span class="in">      #                      alpha = 0.6) +</span></span>
<span id="cb132-1876"><a href="#cb132-1876" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_color_manual(values = cols) +</span></span>
<span id="cb132-1877"><a href="#cb132-1877" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = cols_transp) +</span></span>
<span id="cb132-1878"><a href="#cb132-1878" aria-hidden="true" tabindex="-1"></a><span class="in">      ylim(c(-0.1, 60)) +</span></span>
<span id="cb132-1879"><a href="#cb132-1879" aria-hidden="true" tabindex="-1"></a><span class="in">           scale_x_discrete(labels = c(</span></span>
<span id="cb132-1880"><a href="#cb132-1880" aria-hidden="true" tabindex="-1"></a><span class="in">        "solo" = "Solo",</span></span>
<span id="cb132-1881"><a href="#cb132-1881" aria-hidden="true" tabindex="-1"></a><span class="in">        "natural.group" = "Natural group",</span></span>
<span id="cb132-1882"><a href="#cb132-1882" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial.group" = "Artificial group"</span></span>
<span id="cb132-1883"><a href="#cb132-1883" aria-hidden="true" tabindex="-1"></a><span class="in">      )) +</span></span>
<span id="cb132-1884"><a href="#cb132-1884" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "none") +</span></span>
<span id="cb132-1885"><a href="#cb132-1885" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Flight type", y = "Calling rate (calls / min)")</span></span>
<span id="cb132-1886"><a href="#cb132-1886" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-1887"><a href="#cb132-1887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1888"><a href="#cb132-1888" aria-hidden="true" tabindex="-1"></a><span class="in">length(unique(call_rate_by_group$group))</span></span>
<span id="cb132-1889"><a href="#cb132-1889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1890"><a href="#cb132-1890" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps &lt;-</span></span>
<span id="cb132-1891"><a href="#cb132-1891" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(group ~ type, call_rate_by_group, function(x)</span></span>
<span id="cb132-1892"><a href="#cb132-1892" aria-hidden="true" tabindex="-1"></a><span class="in">    length(unique(x)))</span></span>
<span id="cb132-1893"><a href="#cb132-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1894"><a href="#cb132-1894" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$group &lt;- sapply(n_grps$type, function(x) length(unique(call_rate_by_group$group[call_rate_by_group$type == x &amp; call_rate_by_group$indiv == "group"])))</span></span>
<span id="cb132-1895"><a href="#cb132-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1896"><a href="#cb132-1896" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$group[1] &lt;- length(unique(call_rate_by_group$group[call_rate_by_group$type == "solo" &amp; call_rate_by_group$experiment == "regular"]))</span></span>
<span id="cb132-1897"><a href="#cb132-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1898"><a href="#cb132-1898" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$indivs &lt;- 0</span></span>
<span id="cb132-1899"><a href="#cb132-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1900"><a href="#cb132-1900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1901"><a href="#cb132-1901" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$indivs[1] &lt;- length(unique(call_rate_by_group$indiv[call_rate_by_group$type == "solo"]))</span></span>
<span id="cb132-1902"><a href="#cb132-1902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1903"><a href="#cb132-1903" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$distance &lt;- -4</span></span>
<span id="cb132-1904"><a href="#cb132-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1905"><a href="#cb132-1905" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$n.labels &lt;-</span></span>
<span id="cb132-1906"><a href="#cb132-1906" aria-hidden="true" tabindex="-1"></a><span class="in">  paste0(n_grps$group, " / ", n_grps$indivs)</span></span>
<span id="cb132-1907"><a href="#cb132-1907" aria-hidden="true" tabindex="-1"></a><span class="in">n_grps$n.labels &lt;- c(</span></span>
<span id="cb132-1908"><a href="#cb132-1908" aria-hidden="true" tabindex="-1"></a><span class="in">  "n = 131 individuals\nfrom 29 groups",</span></span>
<span id="cb132-1909"><a href="#cb132-1909" aria-hidden="true" tabindex="-1"></a><span class="in">  "32 groups",</span></span>
<span id="cb132-1910"><a href="#cb132-1910" aria-hidden="true" tabindex="-1"></a><span class="in">  "37 groups")</span></span>
<span id="cb132-1911"><a href="#cb132-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1912"><a href="#cb132-1912" aria-hidden="true" tabindex="-1"></a><span class="in">ggrate_indv_grp_pimp &lt;- ggrate_indv_grp +</span></span>
<span id="cb132-1913"><a href="#cb132-1913" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c(</span></span>
<span id="cb132-1914"><a href="#cb132-1914" aria-hidden="true" tabindex="-1"></a><span class="in">        "solo" = "Single individual",</span></span>
<span id="cb132-1915"><a href="#cb132-1915" aria-hidden="true" tabindex="-1"></a><span class="in">        "natural.group" = "Natural group",</span></span>
<span id="cb132-1916"><a href="#cb132-1916" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial.group" = "Artificial group"</span></span>
<span id="cb132-1917"><a href="#cb132-1917" aria-hidden="true" tabindex="-1"></a><span class="in">      )) +</span></span>
<span id="cb132-1918"><a href="#cb132-1918" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_signif(</span></span>
<span id="cb132-1919"><a href="#cb132-1919" aria-hidden="true" tabindex="-1"></a><span class="in">    y_position = c(61, 68),</span></span>
<span id="cb132-1920"><a href="#cb132-1920" aria-hidden="true" tabindex="-1"></a><span class="in">    xmin = c(1, 2),</span></span>
<span id="cb132-1921"><a href="#cb132-1921" aria-hidden="true" tabindex="-1"></a><span class="in">    xmax = c(3, 3),</span></span>
<span id="cb132-1922"><a href="#cb132-1922" aria-hidden="true" tabindex="-1"></a><span class="in">    annotation = c('beta:-0.41~ (-0.74 - -0.089)', 'beta:-0.64 ~ (-1.05 - -0.23)'), </span></span>
<span id="cb132-1923"><a href="#cb132-1923" aria-hidden="true" tabindex="-1"></a><span class="in">    parse = TRUE,</span></span>
<span id="cb132-1924"><a href="#cb132-1924" aria-hidden="true" tabindex="-1"></a><span class="in">    tip_length = 0.02,</span></span>
<span id="cb132-1925"><a href="#cb132-1925" aria-hidden="true" tabindex="-1"></a><span class="in">    textsize = 3,</span></span>
<span id="cb132-1926"><a href="#cb132-1926" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 0.5,</span></span>
<span id="cb132-1927"><a href="#cb132-1927" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "gray60",</span></span>
<span id="cb132-1928"><a href="#cb132-1928" aria-hidden="true" tabindex="-1"></a><span class="in">    vjust = 0.2</span></span>
<span id="cb132-1929"><a href="#cb132-1929" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-1930"><a href="#cb132-1930" aria-hidden="true" tabindex="-1"></a><span class="in">  ylim(c(-5, 68)) +</span></span>
<span id="cb132-1931"><a href="#cb132-1931" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.title.x = element_blank()) +</span></span>
<span id="cb132-1932"><a href="#cb132-1932" aria-hidden="true" tabindex="-1"></a><span class="in">   geom_text(lineheight = 0.8,</span></span>
<span id="cb132-1933"><a href="#cb132-1933" aria-hidden="true" tabindex="-1"></a><span class="in">    data = n_grps,</span></span>
<span id="cb132-1934"><a href="#cb132-1934" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(y = distance, x = type, label = n.labels),</span></span>
<span id="cb132-1935"><a href="#cb132-1935" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "gray60",</span></span>
<span id="cb132-1936"><a href="#cb132-1936" aria-hidden="true" tabindex="-1"></a><span class="in">    nudge_x = 0,</span></span>
<span id="cb132-1937"><a href="#cb132-1937" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 3</span></span>
<span id="cb132-1938"><a href="#cb132-1938" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-1939"><a href="#cb132-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1940"><a href="#cb132-1940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-1941"><a href="#cb132-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1942"><a href="#cb132-1942" aria-hidden="true" tabindex="-1"></a>By group size:</span>
<span id="cb132-1943"><a href="#cb132-1943" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-1944"><a href="#cb132-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1945"><a href="#cb132-1945" aria-hidden="true" tabindex="-1"></a><span class="in">custom_labels &lt;- unique(call_rate_by_group$group.size)</span></span>
<span id="cb132-1946"><a href="#cb132-1946" aria-hidden="true" tabindex="-1"></a><span class="in">custom_labels &lt;- paste("group size = ", custom_labels)</span></span>
<span id="cb132-1947"><a href="#cb132-1947" aria-hidden="true" tabindex="-1"></a><span class="in">names(custom_labels) &lt;- unique(call_rate_by_group$group.size)</span></span>
<span id="cb132-1948"><a href="#cb132-1948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-1949"><a href="#cb132-1949" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-1950"><a href="#cb132-1950" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(call_rate_by_group[call_rate_by_group$group.size &lt;= 5,],</span></span>
<span id="cb132-1951"><a href="#cb132-1951" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(</span></span>
<span id="cb132-1952"><a href="#cb132-1952" aria-hidden="true" tabindex="-1"></a><span class="in">         y = rate,</span></span>
<span id="cb132-1953"><a href="#cb132-1953" aria-hidden="true" tabindex="-1"></a><span class="in">         x = type,</span></span>
<span id="cb132-1954"><a href="#cb132-1954" aria-hidden="true" tabindex="-1"></a><span class="in">         color = type,</span></span>
<span id="cb132-1955"><a href="#cb132-1955" aria-hidden="true" tabindex="-1"></a><span class="in">         fill = type</span></span>
<span id="cb132-1956"><a href="#cb132-1956" aria-hidden="true" tabindex="-1"></a><span class="in">       )) +</span></span>
<span id="cb132-1957"><a href="#cb132-1957" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-1958"><a href="#cb132-1958" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-1959"><a href="#cb132-1959" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-1960"><a href="#cb132-1960" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-1961"><a href="#cb132-1961" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-1962"><a href="#cb132-1962" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-1963"><a href="#cb132-1963" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-1964"><a href="#cb132-1964" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-1965"><a href="#cb132-1965" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-1966"><a href="#cb132-1966" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-1967"><a href="#cb132-1967" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-1968"><a href="#cb132-1968" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-1969"><a href="#cb132-1969" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-1970"><a href="#cb132-1970" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-1971"><a href="#cb132-1971" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-1972"><a href="#cb132-1972" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-1973"><a href="#cb132-1973" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-1974"><a href="#cb132-1974" aria-hidden="true" tabindex="-1"></a><span class="in">    # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-1975"><a href="#cb132-1975" aria-hidden="true" tabindex="-1"></a><span class="in">    gghalves::geom_half_point(</span></span>
<span id="cb132-1976"><a href="#cb132-1976" aria-hidden="true" tabindex="-1"></a><span class="in">      # color = fill_color,</span></span>
<span id="cb132-1977"><a href="#cb132-1977" aria-hidden="true" tabindex="-1"></a><span class="in">      # draw jitter on the left</span></span>
<span id="cb132-1978"><a href="#cb132-1978" aria-hidden="true" tabindex="-1"></a><span class="in">      side = "l",</span></span>
<span id="cb132-1979"><a href="#cb132-1979" aria-hidden="true" tabindex="-1"></a><span class="in">      # control range of jitter</span></span>
<span id="cb132-1980"><a href="#cb132-1980" aria-hidden="true" tabindex="-1"></a><span class="in">      range_scale = .4,</span></span>
<span id="cb132-1981"><a href="#cb132-1981" aria-hidden="true" tabindex="-1"></a><span class="in">      # add some transparency</span></span>
<span id="cb132-1982"><a href="#cb132-1982" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = .5,</span></span>
<span id="cb132-1983"><a href="#cb132-1983" aria-hidden="true" tabindex="-1"></a><span class="in">      transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-1984"><a href="#cb132-1984" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb132-1985"><a href="#cb132-1985" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-1986"><a href="#cb132-1986" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-1987"><a href="#cb132-1987" aria-hidden="true" tabindex="-1"></a><span class="in">                           end = 0.8,</span></span>
<span id="cb132-1988"><a href="#cb132-1988" aria-hidden="true" tabindex="-1"></a><span class="in">                           alpha = 0.6) +</span></span>
<span id="cb132-1989"><a href="#cb132-1989" aria-hidden="true" tabindex="-1"></a><span class="in">      ylim(c(-0.1, 60)) +</span></span>
<span id="cb132-1990"><a href="#cb132-1990" aria-hidden="true" tabindex="-1"></a><span class="in">             scale_x_discrete(labels = c(</span></span>
<span id="cb132-1991"><a href="#cb132-1991" aria-hidden="true" tabindex="-1"></a><span class="in">        "solo" = "Solo",</span></span>
<span id="cb132-1992"><a href="#cb132-1992" aria-hidden="true" tabindex="-1"></a><span class="in">        "natural.group" = "Natural group",</span></span>
<span id="cb132-1993"><a href="#cb132-1993" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial.group" = "Artificial group"</span></span>
<span id="cb132-1994"><a href="#cb132-1994" aria-hidden="true" tabindex="-1"></a><span class="in">      )) +</span></span>
<span id="cb132-1995"><a href="#cb132-1995" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "none") +</span></span>
<span id="cb132-1996"><a href="#cb132-1996" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Flight type", y = "Calling rate (calls / min)") +</span></span>
<span id="cb132-1997"><a href="#cb132-1997" aria-hidden="true" tabindex="-1"></a><span class="in">      facet_wrap(</span></span>
<span id="cb132-1998"><a href="#cb132-1998" aria-hidden="true" tabindex="-1"></a><span class="in">        ~ group.size.f,</span></span>
<span id="cb132-1999"><a href="#cb132-1999" aria-hidden="true" tabindex="-1"></a><span class="in">        ncol = 2,</span></span>
<span id="cb132-2000"><a href="#cb132-2000" aria-hidden="true" tabindex="-1"></a><span class="in">        labeller = labeller(group.size.f = custom_labels)</span></span>
<span id="cb132-2001"><a href="#cb132-2001" aria-hidden="true" tabindex="-1"></a><span class="in">      ) </span></span>
<span id="cb132-2002"><a href="#cb132-2002" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-2003"><a href="#cb132-2003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2004"><a href="#cb132-2004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2005"><a href="#cb132-2005" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Regression model</span></span>
<span id="cb132-2006"><a href="#cb132-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2007"><a href="#cb132-2007" aria-hidden="true" tabindex="-1"></a>Model:</span>
<span id="cb132-2008"><a href="#cb132-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2009"><a href="#cb132-2009" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-2010"><a href="#cb132-2010" aria-hidden="true" tabindex="-1"></a>\text{call rate} \sim \text{type} + (1 \mid \text{group}) + \text{monotonic(group size)} + (\text{type} \mid \text{group})</span>
<span id="cb132-2011"><a href="#cb132-2011" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-2012"><a href="#cb132-2012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2013"><a href="#cb132-2013" aria-hidden="true" tabindex="-1"></a>Response modeled with a negative binomial distribution.</span>
<span id="cb132-2014"><a href="#cb132-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2015"><a href="#cb132-2015" aria-hidden="true" tabindex="-1"></a><span class="in">```{r individual vs group call rate stats 2, eval = FALSE}</span></span>
<span id="cb132-2016"><a href="#cb132-2016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2017"><a href="#cb132-2017" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- brm(</span></span>
<span id="cb132-2018"><a href="#cb132-2018" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = calls | resp_rate(flight.time) ~ type + mo(group.size.f) + (type | group),</span></span>
<span id="cb132-2019"><a href="#cb132-2019" aria-hidden="true" tabindex="-1"></a><span class="in">  iter = iter,</span></span>
<span id="cb132-2020"><a href="#cb132-2020" aria-hidden="true" tabindex="-1"></a><span class="in">  thin = 1,</span></span>
<span id="cb132-2021"><a href="#cb132-2021" aria-hidden="true" tabindex="-1"></a><span class="in">  data = call_rate_by_group,</span></span>
<span id="cb132-2022"><a href="#cb132-2022" aria-hidden="true" tabindex="-1"></a><span class="in">  family = negbinomial(),</span></span>
<span id="cb132-2023"><a href="#cb132-2023" aria-hidden="true" tabindex="-1"></a><span class="in">  silent = 2,</span></span>
<span id="cb132-2024"><a href="#cb132-2024" aria-hidden="true" tabindex="-1"></a><span class="in">  chains = chains,</span></span>
<span id="cb132-2025"><a href="#cb132-2025" aria-hidden="true" tabindex="-1"></a><span class="in">  cores = chains,</span></span>
<span id="cb132-2026"><a href="#cb132-2026" aria-hidden="true" tabindex="-1"></a><span class="in">  save_pars = save_pars(all = TRUE),</span></span>
<span id="cb132-2027"><a href="#cb132-2027" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(adapt_delta = 0.99, max_treedepth = 15),</span></span>
<span id="cb132-2028"><a href="#cb132-2028" aria-hidden="true" tabindex="-1"></a><span class="in">  file = "./data/processed/individual_vs_group_call_rate_group_size_monot", </span></span>
<span id="cb132-2029"><a href="#cb132-2029" aria-hidden="true" tabindex="-1"></a><span class="in">  file_refit = "always"</span></span>
<span id="cb132-2030"><a href="#cb132-2030" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-2031"><a href="#cb132-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2032"><a href="#cb132-2032" aria-hidden="true" tabindex="-1"></a><span class="in"># custom_ppc(fit = mod, group = "type")</span></span>
<span id="cb132-2033"><a href="#cb132-2033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2034"><a href="#cb132-2034" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- add_criterion(mod, criterion = c("loo"))</span></span>
<span id="cb132-2035"><a href="#cb132-2035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2036"><a href="#cb132-2036" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- brm(</span></span>
<span id="cb132-2037"><a href="#cb132-2037" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = calls | resp_rate(flight.time) ~ 1 + (1 | group),</span></span>
<span id="cb132-2038"><a href="#cb132-2038" aria-hidden="true" tabindex="-1"></a><span class="in">  iter = iter,</span></span>
<span id="cb132-2039"><a href="#cb132-2039" aria-hidden="true" tabindex="-1"></a><span class="in">  thin = 1,</span></span>
<span id="cb132-2040"><a href="#cb132-2040" aria-hidden="true" tabindex="-1"></a><span class="in">  data = call_rate_by_group,</span></span>
<span id="cb132-2041"><a href="#cb132-2041" aria-hidden="true" tabindex="-1"></a><span class="in">  family = negbinomial(),</span></span>
<span id="cb132-2042"><a href="#cb132-2042" aria-hidden="true" tabindex="-1"></a><span class="in">  silent = 2,</span></span>
<span id="cb132-2043"><a href="#cb132-2043" aria-hidden="true" tabindex="-1"></a><span class="in">  chains = chains,</span></span>
<span id="cb132-2044"><a href="#cb132-2044" aria-hidden="true" tabindex="-1"></a><span class="in">  cores = chains,</span></span>
<span id="cb132-2045"><a href="#cb132-2045" aria-hidden="true" tabindex="-1"></a><span class="in">  save_pars = save_pars(all = TRUE),</span></span>
<span id="cb132-2046"><a href="#cb132-2046" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(adapt_delta = 0.99, max_treedepth = 15),</span></span>
<span id="cb132-2047"><a href="#cb132-2047" aria-hidden="true" tabindex="-1"></a><span class="in">  file = "./data/processed/null_mod_individual_vs_group_call_rate_group_size", </span></span>
<span id="cb132-2048"><a href="#cb132-2048" aria-hidden="true" tabindex="-1"></a><span class="in">  file_refit = "always"</span></span>
<span id="cb132-2049"><a href="#cb132-2049" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-2050"><a href="#cb132-2050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2051"><a href="#cb132-2051" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- add_criterion(null_mod, criterion = c("loo"))</span></span>
<span id="cb132-2052"><a href="#cb132-2052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2053"><a href="#cb132-2053" aria-hidden="true" tabindex="-1"></a><span class="in">beepr::beep(2)</span></span>
<span id="cb132-2054"><a href="#cb132-2054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2055"><a href="#cb132-2055" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2056"><a href="#cb132-2056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2057"><a href="#cb132-2057" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results</span></span>
<span id="cb132-2058"><a href="#cb132-2058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2059"><a href="#cb132-2059" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model performance vs null model </span></span>
<span id="cb132-2060"><a href="#cb132-2060" aria-hidden="true" tabindex="-1"></a><span class="in">```{r individual vs group call rate compare null, eval = TRUE}</span></span>
<span id="cb132-2061"><a href="#cb132-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2062"><a href="#cb132-2062" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- readRDS("./data/processed/individual_vs_group_call_rate_group_size_monot.rds")</span></span>
<span id="cb132-2063"><a href="#cb132-2063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2064"><a href="#cb132-2064" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- readRDS("./data/processed/null_mod_individual_vs_group_call_rate_group_size.rds")</span></span>
<span id="cb132-2065"><a href="#cb132-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2066"><a href="#cb132-2066" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff &lt;- loo::loo_compare(mod, null_mod)</span></span>
<span id="cb132-2067"><a href="#cb132-2067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2068"><a href="#cb132-2068" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff</span></span>
<span id="cb132-2069"><a href="#cb132-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2070"><a href="#cb132-2070" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2071"><a href="#cb132-2071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2072"><a href="#cb132-2072" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model fit</span></span>
<span id="cb132-2073"><a href="#cb132-2073" aria-hidden="true" tabindex="-1"></a><span class="in">```{r individual vs group call rate results, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-2074"><a href="#cb132-2074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2075"><a href="#cb132-2075" aria-hidden="true" tabindex="-1"></a><span class="in">extended_summary(</span></span>
<span id="cb132-2076"><a href="#cb132-2076" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-2077"><a href="#cb132-2077" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.pattern = "type",</span></span>
<span id="cb132-2078"><a href="#cb132-2078" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.replacement = "solo_vs_",</span></span>
<span id="cb132-2079"><a href="#cb132-2079" aria-hidden="true" tabindex="-1"></a><span class="in">  remove.intercepts = TRUE,</span></span>
<span id="cb132-2080"><a href="#cb132-2080" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-2081"><a href="#cb132-2081" aria-hidden="true" tabindex="-1"></a><span class="in">  print.name = FALSE,</span></span>
<span id="cb132-2082"><a href="#cb132-2082" aria-hidden="true" tabindex="-1"></a><span class="in">  trace.palette = viridis::mako, </span></span>
<span id="cb132-2083"><a href="#cb132-2083" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = fill_color, </span></span>
<span id="cb132-2084"><a href="#cb132-2084" aria-hidden="true" tabindex="-1"></a><span class="in">  beta.prefix = c("^b_", "^bsp_mo")</span></span>
<span id="cb132-2085"><a href="#cb132-2085" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-2086"><a href="#cb132-2086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2087"><a href="#cb132-2087" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2088"><a href="#cb132-2088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2089"><a href="#cb132-2089" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Contrasts</span></span>
<span id="cb132-2090"><a href="#cb132-2090" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rate per group solo vs group results contrasts, eval = TRUE, results='asis'}</span></span>
<span id="cb132-2091"><a href="#cb132-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2092"><a href="#cb132-2092" aria-hidden="true" tabindex="-1"></a><span class="in"># contrasts</span></span>
<span id="cb132-2093"><a href="#cb132-2093" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts(</span></span>
<span id="cb132-2094"><a href="#cb132-2094" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-2095"><a href="#cb132-2095" aria-hidden="true" tabindex="-1"></a><span class="in">  predictor = "type",</span></span>
<span id="cb132-2096"><a href="#cb132-2096" aria-hidden="true" tabindex="-1"></a><span class="in">  n.posterior = 2000,</span></span>
<span id="cb132-2097"><a href="#cb132-2097" aria-hidden="true" tabindex="-1"></a><span class="in">  level.sep = " VS ",</span></span>
<span id="cb132-2098"><a href="#cb132-2098" aria-hidden="true" tabindex="-1"></a><span class="in">  html.table = TRUE,</span></span>
<span id="cb132-2099"><a href="#cb132-2099" aria-hidden="true" tabindex="-1"></a><span class="in">  plot = TRUE,</span></span>
<span id="cb132-2100"><a href="#cb132-2100" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-2101"><a href="#cb132-2101" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = fill_color</span></span>
<span id="cb132-2102"><a href="#cb132-2102" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-2103"><a href="#cb132-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2104"><a href="#cb132-2104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2105"><a href="#cb132-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2106"><a href="#cb132-2106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2107"><a href="#cb132-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2108"><a href="#cb132-2108" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Posterior predictive checks</span></span>
<span id="cb132-2111"><a href="#cb132-2111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-2112"><a href="#cb132-2112" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb132-2113"><a href="#cb132-2113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2114"><a href="#cb132-2114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2115"><a href="#cb132-2115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2116"><a href="#cb132-2116" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-2117"><a href="#cb132-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2118"><a href="#cb132-2118" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb132-2119"><a href="#cb132-2119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2120"><a href="#cb132-2120" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No difference in call rate between solo individuals and natural groups </span>
<span id="cb132-2121"><a href="#cb132-2121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Artificial groups produce lower call rates than solo individuals and natural groups</span>
<span id="cb132-2122"><a href="#cb132-2122" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No effect of group size</span>
<span id="cb132-2123"><a href="#cb132-2123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2124"><a href="#cb132-2124" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-2125"><a href="#cb132-2125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2126"><a href="#cb132-2126" aria-hidden="true" tabindex="-1"></a><span class="fu">###  Individual in solo flight vs individuals in group flight</span></span>
<span id="cb132-2127"><a href="#cb132-2127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r individual vs group call plot, eval = TRUE, echo = TRUE, fig.width = 12, fig.height = 8}</span></span>
<span id="cb132-2128"><a href="#cb132-2128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2129"><a href="#cb132-2129" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group &lt;- readRDS("./data/processed/call_rate_by_group.RDS")</span></span>
<span id="cb132-2130"><a href="#cb132-2130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2131"><a href="#cb132-2131" aria-hidden="true" tabindex="-1"></a><span class="in"># remove those in which only one individual called</span></span>
<span id="cb132-2132"><a href="#cb132-2132" aria-hidden="true" tabindex="-1"></a><span class="in">call_id_seq &lt;- read.csv("./data/processed/group_call_individual_id_sequence.csv")</span></span>
<span id="cb132-2133"><a href="#cb132-2133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2134"><a href="#cb132-2134" aria-hidden="true" tabindex="-1"></a><span class="in">call_id_seq &lt;- call_id_seq[order(call_id_seq$event, call_id_seq$start), ]</span></span>
<span id="cb132-2135"><a href="#cb132-2135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2136"><a href="#cb132-2136" aria-hidden="true" tabindex="-1"></a><span class="in">call_id_seq_list &lt;- split(call_id_seq, call_id_seq$event)</span></span>
<span id="cb132-2137"><a href="#cb132-2137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2138"><a href="#cb132-2138" aria-hidden="true" tabindex="-1"></a><span class="in"># get diversity and entropy</span></span>
<span id="cb132-2139"><a href="#cb132-2139" aria-hidden="true" tabindex="-1"></a><span class="in">unique_callers_list &lt;- pblapply(call_id_seq_list, function(x){</span></span>
<span id="cb132-2140"><a href="#cb132-2140" aria-hidden="true" tabindex="-1"></a><span class="in">  x &lt;- x[order(x$start), ]</span></span>
<span id="cb132-2141"><a href="#cb132-2141" aria-hidden="true" tabindex="-1"></a><span class="in">  id_seq &lt;- x$indiv</span></span>
<span id="cb132-2142"><a href="#cb132-2142" aria-hidden="true" tabindex="-1"></a><span class="in">  id_seq &lt;- as.character(as.numeric(factor(id_seq)))</span></span>
<span id="cb132-2143"><a href="#cb132-2143" aria-hidden="true" tabindex="-1"></a><span class="in">  unique.callers &lt;- length(unique(id_seq))</span></span>
<span id="cb132-2144"><a href="#cb132-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2145"><a href="#cb132-2145" aria-hidden="true" tabindex="-1"></a><span class="in">  out &lt;- data.frame(group = x$group[1], unique.callers = unique.callers)</span></span>
<span id="cb132-2146"><a href="#cb132-2146" aria-hidden="true" tabindex="-1"></a><span class="in">  return(out)</span></span>
<span id="cb132-2147"><a href="#cb132-2147" aria-hidden="true" tabindex="-1"></a><span class="in"> }</span></span>
<span id="cb132-2148"><a href="#cb132-2148" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-2149"><a href="#cb132-2149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2150"><a href="#cb132-2150" aria-hidden="true" tabindex="-1"></a><span class="in">unique_callers_df &lt;- do_call(rbind, unique_callers_list)</span></span>
<span id="cb132-2151"><a href="#cb132-2151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2152"><a href="#cb132-2152" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group &lt;- call_rate_by_group[!call_rate_by_group$group %in% unique_callers_df$group[unique_callers_df$unique.callers == 1], ]</span></span>
<span id="cb132-2153"><a href="#cb132-2153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2154"><a href="#cb132-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2155"><a href="#cb132-2155" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv &lt;- readRDS("./data/processed/call_rate_by_individual.RDS")</span></span>
<span id="cb132-2156"><a href="#cb132-2156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2157"><a href="#cb132-2157" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv &lt;- call_rate_indiv[!call_rate_indiv$group %in% unique_callers_df$group[unique_callers_df$unique.callers == 1], ]</span></span>
<span id="cb132-2158"><a href="#cb132-2158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2159"><a href="#cb132-2159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2160"><a href="#cb132-2160" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group &lt;- call_rate_by_group[call_rate_by_group$type != "solo", ]</span></span>
<span id="cb132-2161"><a href="#cb132-2161" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group$type &lt;- "overall.group"</span></span>
<span id="cb132-2162"><a href="#cb132-2162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2163"><a href="#cb132-2163" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv$type &lt;- as.character(call_rate_indiv$type)</span></span>
<span id="cb132-2164"><a href="#cb132-2164" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv$type[call_rate_indiv$type == "group"] &lt;- "indiv.group" </span></span>
<span id="cb132-2165"><a href="#cb132-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2166"><a href="#cb132-2166" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate &lt;- rbind(call_rate_by_group[, intersect(names(call_rate_by_group), names(call_rate_indiv))</span></span>
<span id="cb132-2167"><a href="#cb132-2167" aria-hidden="true" tabindex="-1"></a><span class="in">], call_rate_indiv[, intersect(names(call_rate_by_group), names(call_rate_indiv))</span></span>
<span id="cb132-2168"><a href="#cb132-2168" aria-hidden="true" tabindex="-1"></a><span class="in">])</span></span>
<span id="cb132-2169"><a href="#cb132-2169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2170"><a href="#cb132-2170" aria-hidden="true" tabindex="-1"></a><span class="in"># aggregate for plot</span></span>
<span id="cb132-2171"><a href="#cb132-2171" aria-hidden="true" tabindex="-1"></a><span class="in">agg_rate &lt;- aggregate(rate ~ experiment + type + group.size, data = call_rate, FUN = mean)</span></span>
<span id="cb132-2172"><a href="#cb132-2172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2173"><a href="#cb132-2173" aria-hidden="true" tabindex="-1"></a><span class="in">agg_rate$sd &lt;- aggregate(rate ~ experiment + type + group.size, data = call_rate, FUN = sd)$rate</span></span>
<span id="cb132-2174"><a href="#cb132-2174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2175"><a href="#cb132-2175" aria-hidden="true" tabindex="-1"></a><span class="in">agg_rate$type &lt;- factor(agg_rate$type, levels = c("solo", "indiv.group", "overall.group"))</span></span>
<span id="cb132-2176"><a href="#cb132-2176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2177"><a href="#cb132-2177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2178"><a href="#cb132-2178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2181"><a href="#cb132-2181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-2182"><a href="#cb132-2182" aria-hidden="true" tabindex="-1"></a>call_rate_indiv <span class="ot">&lt;-</span> call_rate_indiv[<span class="sc">!</span><span class="fu">is.na</span>(call_rate_indiv<span class="sc">$</span>rate) <span class="sc">&amp;</span> call_rate_indiv<span class="sc">$</span>rate <span class="sc">&gt;</span> <span class="dv">0</span>, ]</span>
<span id="cb132-2183"><a href="#cb132-2183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2184"><a href="#cb132-2184" aria-hidden="true" tabindex="-1"></a>no_solo <span class="ot">&lt;-</span> call_rate_indiv[call_rate_indiv<span class="sc">$</span>type <span class="sc">!=</span> <span class="st">"solo"</span>, ]</span>
<span id="cb132-2185"><a href="#cb132-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2186"><a href="#cb132-2186" aria-hidden="true" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(indiv <span class="sc">~</span> group <span class="sc">+</span> experiment, <span class="at">data =</span> no_solo, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span>
<span id="cb132-2187"><a href="#cb132-2187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2188"><a href="#cb132-2188" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>group.size <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(group.size <span class="sc">~</span> group <span class="sc">+</span> experiment, <span class="at">data =</span> no_solo, <span class="cf">function</span>(x) <span class="fu">mean</span>(x))<span class="sc">$</span>group.size</span>
<span id="cb132-2189"><a href="#cb132-2189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2190"><a href="#cb132-2190" aria-hidden="true" tabindex="-1"></a>agg<span class="sc">$</span>prop.callers <span class="ot">&lt;-</span> agg<span class="sc">$</span>indiv <span class="sc">/</span> agg<span class="sc">$</span>group.size</span>
<span id="cb132-2191"><a href="#cb132-2191" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb132-2192"><a href="#cb132-2192" aria-hidden="true" tabindex="-1"></a><span class="co"># t.test(agg$prop.callers ~ agg$experiment)</span></span>
<span id="cb132-2193"><a href="#cb132-2193" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb132-2194"><a href="#cb132-2194" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate(prop.callers ~ experiment, agg, mean)</span></span>
<span id="cb132-2195"><a href="#cb132-2195" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate(prop.callers ~ experiment, agg, sd)</span></span>
<span id="cb132-2196"><a href="#cb132-2196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2197"><a href="#cb132-2197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2198"><a href="#cb132-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2199"><a href="#cb132-2199" aria-hidden="true" tabindex="-1"></a>In average <span class="in">`r round(mean(agg$prop.callers), 2)`</span> (+/- <span class="in">`r round(sd(agg$prop.callers), 2)`</span> SD) individuals in group flights called</span>
<span id="cb132-2200"><a href="#cb132-2200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2201"><a href="#cb132-2201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2202"><a href="#cb132-2202" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot raw data</span></span>
<span id="cb132-2203"><a href="#cb132-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2204"><a href="#cb132-2204" aria-hidden="true" tabindex="-1"></a>All group sizes combined:</span>
<span id="cb132-2205"><a href="#cb132-2205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-2206"><a href="#cb132-2206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2207"><a href="#cb132-2207" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv &lt;- call_rate_indiv[!is.na(call_rate_indiv$rate) &amp; call_rate_indiv$rate &gt; 0, ]</span></span>
<span id="cb132-2208"><a href="#cb132-2208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2209"><a href="#cb132-2209" aria-hidden="true" tabindex="-1"></a><span class="in">if (!is.factor(call_rate_indiv$type)){</span></span>
<span id="cb132-2210"><a href="#cb132-2210" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv$type &lt;- ifelse(call_rate_indiv$type == "solo", "solo", paste(call_rate_indiv$experiment, call_rate_indiv$type, sep = "-"))</span></span>
<span id="cb132-2211"><a href="#cb132-2211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2212"><a href="#cb132-2212" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv$type &lt;- gsub("mixed-indiv.group", "artificial.group", call_rate_indiv$type)</span></span>
<span id="cb132-2213"><a href="#cb132-2213" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv$type &lt;- gsub("regular-indiv.group", "natural.group", call_rate_indiv$type)</span></span>
<span id="cb132-2214"><a href="#cb132-2214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2215"><a href="#cb132-2215" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv$type &lt;- factor(call_rate_indiv$type, levels = c("solo", "natural.group", "artificial.group")) </span></span>
<span id="cb132-2216"><a href="#cb132-2216" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb132-2217"><a href="#cb132-2217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2218"><a href="#cb132-2218" aria-hidden="true" tabindex="-1"></a><span class="in"># table(call_rate_by_group$group.size, call_rate_by_group$type)</span></span>
<span id="cb132-2219"><a href="#cb132-2219" aria-hidden="true" tabindex="-1"></a><span class="in">cols &lt;- graph_cols[1:3]</span></span>
<span id="cb132-2220"><a href="#cb132-2220" aria-hidden="true" tabindex="-1"></a><span class="in">cols_transp &lt;- graph_cols_transp[1:3]</span></span>
<span id="cb132-2221"><a href="#cb132-2221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2222"><a href="#cb132-2222" aria-hidden="true" tabindex="-1"></a><span class="in">names(cols) &lt;- names(cols_transp) &lt;- c("solo", "natural.group", "artificial.group")</span></span>
<span id="cb132-2223"><a href="#cb132-2223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2224"><a href="#cb132-2224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2225"><a href="#cb132-2225" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-2226"><a href="#cb132-2226" aria-hidden="true" tabindex="-1"></a><span class="in">gg_rate_indiv &lt;- ggplot(call_rate_indiv,</span></span>
<span id="cb132-2227"><a href="#cb132-2227" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(</span></span>
<span id="cb132-2228"><a href="#cb132-2228" aria-hidden="true" tabindex="-1"></a><span class="in">         y = rate,</span></span>
<span id="cb132-2229"><a href="#cb132-2229" aria-hidden="true" tabindex="-1"></a><span class="in">         x = type,</span></span>
<span id="cb132-2230"><a href="#cb132-2230" aria-hidden="true" tabindex="-1"></a><span class="in">         color = type,</span></span>
<span id="cb132-2231"><a href="#cb132-2231" aria-hidden="true" tabindex="-1"></a><span class="in">         fill = type</span></span>
<span id="cb132-2232"><a href="#cb132-2232" aria-hidden="true" tabindex="-1"></a><span class="in">       )) +</span></span>
<span id="cb132-2233"><a href="#cb132-2233" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-2234"><a href="#cb132-2234" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-2235"><a href="#cb132-2235" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-2236"><a href="#cb132-2236" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-2237"><a href="#cb132-2237" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-2238"><a href="#cb132-2238" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-2239"><a href="#cb132-2239" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-2240"><a href="#cb132-2240" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-2241"><a href="#cb132-2241" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-2242"><a href="#cb132-2242" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-2243"><a href="#cb132-2243" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-2244"><a href="#cb132-2244" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-2245"><a href="#cb132-2245" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-2246"><a href="#cb132-2246" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-2247"><a href="#cb132-2247" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-2248"><a href="#cb132-2248" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-2249"><a href="#cb132-2249" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-2250"><a href="#cb132-2250" aria-hidden="true" tabindex="-1"></a><span class="in">    # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-2251"><a href="#cb132-2251" aria-hidden="true" tabindex="-1"></a><span class="in">    gghalves::geom_half_point(</span></span>
<span id="cb132-2252"><a href="#cb132-2252" aria-hidden="true" tabindex="-1"></a><span class="in">      # color = fill_color,</span></span>
<span id="cb132-2253"><a href="#cb132-2253" aria-hidden="true" tabindex="-1"></a><span class="in">      # draw jitter on the left</span></span>
<span id="cb132-2254"><a href="#cb132-2254" aria-hidden="true" tabindex="-1"></a><span class="in">      side = "l",</span></span>
<span id="cb132-2255"><a href="#cb132-2255" aria-hidden="true" tabindex="-1"></a><span class="in">      # control range of jitter</span></span>
<span id="cb132-2256"><a href="#cb132-2256" aria-hidden="true" tabindex="-1"></a><span class="in">      range_scale = .4,</span></span>
<span id="cb132-2257"><a href="#cb132-2257" aria-hidden="true" tabindex="-1"></a><span class="in">      # add some transparency</span></span>
<span id="cb132-2258"><a href="#cb132-2258" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = .5,</span></span>
<span id="cb132-2259"><a href="#cb132-2259" aria-hidden="true" tabindex="-1"></a><span class="in">      transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-2260"><a href="#cb132-2260" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb132-2261"><a href="#cb132-2261" aria-hidden="true" tabindex="-1"></a><span class="in">      # scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-2262"><a href="#cb132-2262" aria-hidden="true" tabindex="-1"></a><span class="in">      # scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-2263"><a href="#cb132-2263" aria-hidden="true" tabindex="-1"></a><span class="in">      #                      end = 0.8,</span></span>
<span id="cb132-2264"><a href="#cb132-2264" aria-hidden="true" tabindex="-1"></a><span class="in">      #                      alpha = 0.6) +</span></span>
<span id="cb132-2265"><a href="#cb132-2265" aria-hidden="true" tabindex="-1"></a><span class="in">     scale_color_manual(values = cols) +</span></span>
<span id="cb132-2266"><a href="#cb132-2266" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = cols_transp) +</span></span>
<span id="cb132-2267"><a href="#cb132-2267" aria-hidden="true" tabindex="-1"></a><span class="in">      ylim(c(-0.1, 40)) +</span></span>
<span id="cb132-2268"><a href="#cb132-2268" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "none") +</span></span>
<span id="cb132-2269"><a href="#cb132-2269" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Type", y = "Calling rate (calls / min)") +</span></span>
<span id="cb132-2270"><a href="#cb132-2270" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c(</span></span>
<span id="cb132-2271"><a href="#cb132-2271" aria-hidden="true" tabindex="-1"></a><span class="in">        "solo" = "Solo",</span></span>
<span id="cb132-2272"><a href="#cb132-2272" aria-hidden="true" tabindex="-1"></a><span class="in">        "natural.group" = "Natural group",</span></span>
<span id="cb132-2273"><a href="#cb132-2273" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial.group" = "Artificial group"</span></span>
<span id="cb132-2274"><a href="#cb132-2274" aria-hidden="true" tabindex="-1"></a><span class="in">      ))</span></span>
<span id="cb132-2275"><a href="#cb132-2275" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-2276"><a href="#cb132-2276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2277"><a href="#cb132-2277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2280"><a href="#cb132-2280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-2281"><a href="#cb132-2281" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb132-2282"><a href="#cb132-2282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2283"><a href="#cb132-2283" aria-hidden="true" tabindex="-1"></a>n_grps <span class="ot">&lt;-</span></span>
<span id="cb132-2284"><a href="#cb132-2284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(group <span class="sc">~</span> type, call_rate_indiv, <span class="cf">function</span>(x)</span>
<span id="cb132-2285"><a href="#cb132-2285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">length</span>(<span class="fu">unique</span>(x)))</span>
<span id="cb132-2286"><a href="#cb132-2286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2287"><a href="#cb132-2287" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>indivs <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n_grps<span class="sc">$</span>type, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(call_rate_indiv<span class="sc">$</span>indiv[call_rate_indiv<span class="sc">$</span>type <span class="sc">==</span> x])))</span>
<span id="cb132-2288"><a href="#cb132-2288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2289"><a href="#cb132-2289" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>group[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(call_rate_indiv<span class="sc">$</span>group[call_rate_indiv<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span> <span class="sc">&amp;</span> call_rate_indiv<span class="sc">$</span>experiment <span class="sc">==</span> <span class="st">"regular"</span>]))</span>
<span id="cb132-2290"><a href="#cb132-2290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2291"><a href="#cb132-2291" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>indivs[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(call_rate_indiv<span class="sc">$</span>indiv[call_rate_indiv<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span> <span class="sc">&amp;</span> call_rate_indiv<span class="sc">$</span>experiment <span class="sc">==</span> <span class="st">"regular"</span>]))</span>
<span id="cb132-2292"><a href="#cb132-2292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2293"><a href="#cb132-2293" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>distance <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.5</span></span>
<span id="cb132-2294"><a href="#cb132-2294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2295"><a href="#cb132-2295" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>n.labels <span class="ot">&lt;-</span></span>
<span id="cb132-2296"><a href="#cb132-2296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(n_grps<span class="sc">$</span>group, <span class="st">" / "</span>, n_grps<span class="sc">$</span>indivs)</span>
<span id="cb132-2297"><a href="#cb132-2297" aria-hidden="true" tabindex="-1"></a>n_grps<span class="sc">$</span>n.labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb132-2298"><a href="#cb132-2298" aria-hidden="true" tabindex="-1"></a>  <span class="st">"n = 81 individuals</span><span class="sc">\n</span><span class="st">from 23 groups"</span>,</span>
<span id="cb132-2299"><a href="#cb132-2299" aria-hidden="true" tabindex="-1"></a>  <span class="st">"63 individuals</span><span class="sc">\n</span><span class="st">21 groups"</span>,</span>
<span id="cb132-2300"><a href="#cb132-2300" aria-hidden="true" tabindex="-1"></a>  <span class="st">"44 individuals</span><span class="sc">\n</span><span class="st">21 groups"</span>)</span>
<span id="cb132-2301"><a href="#cb132-2301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2302"><a href="#cb132-2302" aria-hidden="true" tabindex="-1"></a>agg_rate <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(rate <span class="sc">~</span> type <span class="sc">+</span> group, <span class="at">data =</span> call_rate_indiv, <span class="at">FUN =</span> mean)</span>
<span id="cb132-2303"><a href="#cb132-2303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2304"><a href="#cb132-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2305"><a href="#cb132-2305" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(agg_rate$group, function(x) if(any(agg_rate$type == "natural.group")) "natural" else "artificial")</span></span>
<span id="cb132-2306"><a href="#cb132-2306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2307"><a href="#cb132-2307" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only those solo from natural groups</span></span>
<span id="cb132-2308"><a href="#cb132-2308" aria-hidden="true" tabindex="-1"></a>solo_keep <span class="ot">&lt;-</span> agg_rate[agg_rate<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"natural.group"</span>, ]</span>
<span id="cb132-2309"><a href="#cb132-2309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2310"><a href="#cb132-2310" aria-hidden="true" tabindex="-1"></a>solo_keep <span class="ot">&lt;-</span> solo_keep<span class="sc">$</span>group[solo_keep<span class="sc">$</span>group <span class="sc">%in%</span> agg_rate<span class="sc">$</span>group[agg_rate<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span>]]</span>
<span id="cb132-2311"><a href="#cb132-2311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2312"><a href="#cb132-2312" aria-hidden="true" tabindex="-1"></a>agg_rate <span class="ot">&lt;-</span> agg_rate[(agg_rate<span class="sc">$</span>group <span class="sc">%in%</span> solo_keep <span class="sc">&amp;</span> agg_rate<span class="sc">$</span>type <span class="sc">==</span> <span class="st">"solo"</span>) <span class="sc">|</span> agg_rate<span class="sc">$</span>type <span class="sc">!=</span> <span class="st">"solo"</span>, ]</span>
<span id="cb132-2313"><a href="#cb132-2313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2314"><a href="#cb132-2314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2315"><a href="#cb132-2315" aria-hidden="true" tabindex="-1"></a>gg_rate_indiv_pimp <span class="ot">&lt;-</span> gg_rate_indiv <span class="sc">+</span> </span>
<span id="cb132-2316"><a href="#cb132-2316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">35</span>)) <span class="sc">+</span></span>
<span id="cb132-2317"><a href="#cb132-2317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">lineheight =</span> <span class="fl">0.8</span>,</span>
<span id="cb132-2318"><a href="#cb132-2318" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> n_grps,</span>
<span id="cb132-2319"><a href="#cb132-2319" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> distance, <span class="at">x =</span> type, <span class="at">label =</span> n.labels),</span>
<span id="cb132-2320"><a href="#cb132-2320" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb132-2321"><a href="#cb132-2321" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_x =</span> <span class="dv">0</span>,</span>
<span id="cb132-2322"><a href="#cb132-2322" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb132-2323"><a href="#cb132-2323" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb132-2324"><a href="#cb132-2324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_signif</span>(</span>
<span id="cb132-2325"><a href="#cb132-2325" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_position =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">34</span>),</span>
<span id="cb132-2326"><a href="#cb132-2326" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb132-2327"><a href="#cb132-2327" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb132-2328"><a href="#cb132-2328" aria-hidden="true" tabindex="-1"></a>    <span class="at">annotation =</span> <span class="fu">c</span>(<span class="st">'beta:-1.60~ (-1.87 - -1.33)'</span>, <span class="st">'beta:-1.31 ~ (-1.55 - -1.07)'</span>), </span>
<span id="cb132-2329"><a href="#cb132-2329" aria-hidden="true" tabindex="-1"></a>    <span class="at">parse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb132-2330"><a href="#cb132-2330" aria-hidden="true" tabindex="-1"></a>    <span class="at">tip_length =</span> <span class="fl">0.02</span>,</span>
<span id="cb132-2331"><a href="#cb132-2331" aria-hidden="true" tabindex="-1"></a>    <span class="at">textsize =</span> <span class="dv">3</span>,</span>
<span id="cb132-2332"><a href="#cb132-2332" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb132-2333"><a href="#cb132-2333" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"gray60"</span>,</span>
<span id="cb132-2334"><a href="#cb132-2334" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.2</span></span>
<span id="cb132-2335"><a href="#cb132-2335" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb132-2336"><a href="#cb132-2336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb132-2337"><a href="#cb132-2337" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">adjustcolor</span>(<span class="st">"orange"</span>, <span class="at">alpha.f =</span> <span class="fl">0.1</span>),</span>
<span id="cb132-2338"><a href="#cb132-2338" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_rate,</span>
<span id="cb132-2339"><a href="#cb132-2339" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb132-2340"><a href="#cb132-2340" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> rate,</span>
<span id="cb132-2341"><a href="#cb132-2341" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type</span>
<span id="cb132-2342"><a href="#cb132-2342" aria-hidden="true" tabindex="-1"></a>       ),</span>
<span id="cb132-2343"><a href="#cb132-2343" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">adjustcolor</span>(<span class="st">"orange"</span>, <span class="at">alpha.f =</span> <span class="fl">0.6</span>),</span>
<span id="cb132-2344"><a href="#cb132-2344" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">1</span>,</span>
<span id="cb132-2345"><a href="#cb132-2345" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb132-2346"><a href="#cb132-2346" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span></span>
<span id="cb132-2347"><a href="#cb132-2347" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb132-2348"><a href="#cb132-2348" aria-hidden="true" tabindex="-1"></a>   gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb132-2349"><a href="#cb132-2349" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> agg_rate,</span>
<span id="cb132-2350"><a href="#cb132-2350" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> rate, <span class="at">x =</span> type),</span>
<span id="cb132-2351"><a href="#cb132-2351" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"orange"</span>,</span>
<span id="cb132-2352"><a href="#cb132-2352" aria-hidden="true" tabindex="-1"></a>    <span class="co"># draw jitter on the left</span></span>
<span id="cb132-2353"><a href="#cb132-2353" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb132-2354"><a href="#cb132-2354" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb132-2355"><a href="#cb132-2355" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb132-2356"><a href="#cb132-2356" aria-hidden="true" tabindex="-1"></a>    <span class="co"># control range of jitter</span></span>
<span id="cb132-2357"><a href="#cb132-2357" aria-hidden="true" tabindex="-1"></a>    <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb132-2358"><a href="#cb132-2358" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add some transparency</span></span>
<span id="cb132-2359"><a href="#cb132-2359" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb132-2360"><a href="#cb132-2360" aria-hidden="true" tabindex="-1"></a>    <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb132-2361"><a href="#cb132-2361" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb132-2362"><a href="#cb132-2362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb132-2363"><a href="#cb132-2363" aria-hidden="true" tabindex="-1"></a>        <span class="st">"solo"</span> <span class="ot">=</span> <span class="st">"Single individual"</span>,</span>
<span id="cb132-2364"><a href="#cb132-2364" aria-hidden="true" tabindex="-1"></a>        <span class="st">"natural.group"</span> <span class="ot">=</span> <span class="st">"Individual in</span><span class="sc">\n</span><span class="st"> natural group"</span>,</span>
<span id="cb132-2365"><a href="#cb132-2365" aria-hidden="true" tabindex="-1"></a>        <span class="st">"artificial.group"</span> <span class="ot">=</span> <span class="st">"Individual in</span><span class="sc">\n</span><span class="st">artificial group"</span></span>
<span id="cb132-2366"><a href="#cb132-2366" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb132-2367"><a href="#cb132-2367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb132-2368"><a href="#cb132-2368" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb132-2369"><a href="#cb132-2369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2370"><a href="#cb132-2370" aria-hidden="true" tabindex="-1"></a>gg_rate_indiv_pimp</span>
<span id="cb132-2371"><a href="#cb132-2371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2372"><a href="#cb132-2372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2373"><a href="#cb132-2373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2374"><a href="#cb132-2374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2375"><a href="#cb132-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2376"><a href="#cb132-2376" aria-hidden="true" tabindex="-1"></a>By group size:</span>
<span id="cb132-2377"><a href="#cb132-2377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-2378"><a href="#cb132-2378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2379"><a href="#cb132-2379" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-2380"><a href="#cb132-2380" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(call_rate_indiv,</span></span>
<span id="cb132-2381"><a href="#cb132-2381" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(</span></span>
<span id="cb132-2382"><a href="#cb132-2382" aria-hidden="true" tabindex="-1"></a><span class="in">         y = rate,</span></span>
<span id="cb132-2383"><a href="#cb132-2383" aria-hidden="true" tabindex="-1"></a><span class="in">         x = type,</span></span>
<span id="cb132-2384"><a href="#cb132-2384" aria-hidden="true" tabindex="-1"></a><span class="in">         color = type,</span></span>
<span id="cb132-2385"><a href="#cb132-2385" aria-hidden="true" tabindex="-1"></a><span class="in">         fill = type</span></span>
<span id="cb132-2386"><a href="#cb132-2386" aria-hidden="true" tabindex="-1"></a><span class="in">       )) +</span></span>
<span id="cb132-2387"><a href="#cb132-2387" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-2388"><a href="#cb132-2388" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-2389"><a href="#cb132-2389" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-2390"><a href="#cb132-2390" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-2391"><a href="#cb132-2391" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-2392"><a href="#cb132-2392" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-2393"><a href="#cb132-2393" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-2394"><a href="#cb132-2394" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-2395"><a href="#cb132-2395" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-2396"><a href="#cb132-2396" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-2397"><a href="#cb132-2397" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-2398"><a href="#cb132-2398" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-2399"><a href="#cb132-2399" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-2400"><a href="#cb132-2400" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-2401"><a href="#cb132-2401" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-2402"><a href="#cb132-2402" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-2403"><a href="#cb132-2403" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-2404"><a href="#cb132-2404" aria-hidden="true" tabindex="-1"></a><span class="in">    # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-2405"><a href="#cb132-2405" aria-hidden="true" tabindex="-1"></a><span class="in">    gghalves::geom_half_point(</span></span>
<span id="cb132-2406"><a href="#cb132-2406" aria-hidden="true" tabindex="-1"></a><span class="in">      # color = fill_color,</span></span>
<span id="cb132-2407"><a href="#cb132-2407" aria-hidden="true" tabindex="-1"></a><span class="in">      # draw jitter on the left</span></span>
<span id="cb132-2408"><a href="#cb132-2408" aria-hidden="true" tabindex="-1"></a><span class="in">      side = "l",</span></span>
<span id="cb132-2409"><a href="#cb132-2409" aria-hidden="true" tabindex="-1"></a><span class="in">      # control range of jitter</span></span>
<span id="cb132-2410"><a href="#cb132-2410" aria-hidden="true" tabindex="-1"></a><span class="in">      range_scale = .4,</span></span>
<span id="cb132-2411"><a href="#cb132-2411" aria-hidden="true" tabindex="-1"></a><span class="in">      # add some transparency</span></span>
<span id="cb132-2412"><a href="#cb132-2412" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = .5,</span></span>
<span id="cb132-2413"><a href="#cb132-2413" aria-hidden="true" tabindex="-1"></a><span class="in">      transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-2414"><a href="#cb132-2414" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb132-2415"><a href="#cb132-2415" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-2416"><a href="#cb132-2416" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-2417"><a href="#cb132-2417" aria-hidden="true" tabindex="-1"></a><span class="in">                           end = 0.8,</span></span>
<span id="cb132-2418"><a href="#cb132-2418" aria-hidden="true" tabindex="-1"></a><span class="in">                           alpha = 0.6) +</span></span>
<span id="cb132-2419"><a href="#cb132-2419" aria-hidden="true" tabindex="-1"></a><span class="in">      ylim(c(-0.1, 40)) +</span></span>
<span id="cb132-2420"><a href="#cb132-2420" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "none") +</span></span>
<span id="cb132-2421"><a href="#cb132-2421" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Type", y = "Rate (calls / min)") + </span></span>
<span id="cb132-2422"><a href="#cb132-2422" aria-hidden="true" tabindex="-1"></a><span class="in">      facet_wrap(</span></span>
<span id="cb132-2423"><a href="#cb132-2423" aria-hidden="true" tabindex="-1"></a><span class="in">        ~ group.size,</span></span>
<span id="cb132-2424"><a href="#cb132-2424" aria-hidden="true" tabindex="-1"></a><span class="in">        ncol = 2,</span></span>
<span id="cb132-2425"><a href="#cb132-2425" aria-hidden="true" tabindex="-1"></a><span class="in">        labeller = labeller(group.size = custom_labels)</span></span>
<span id="cb132-2426"><a href="#cb132-2426" aria-hidden="true" tabindex="-1"></a><span class="in">      ) +</span></span>
<span id="cb132-2427"><a href="#cb132-2427" aria-hidden="true" tabindex="-1"></a><span class="in">   scale_x_discrete(labels = c(</span></span>
<span id="cb132-2428"><a href="#cb132-2428" aria-hidden="true" tabindex="-1"></a><span class="in">        "solo" = "Solo",</span></span>
<span id="cb132-2429"><a href="#cb132-2429" aria-hidden="true" tabindex="-1"></a><span class="in">        "natural.group" = "Natural group",</span></span>
<span id="cb132-2430"><a href="#cb132-2430" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial.group" = "Artificial group"</span></span>
<span id="cb132-2431"><a href="#cb132-2431" aria-hidden="true" tabindex="-1"></a><span class="in">      ))</span></span>
<span id="cb132-2432"><a href="#cb132-2432" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-2433"><a href="#cb132-2433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2434"><a href="#cb132-2434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2435"><a href="#cb132-2435" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Regression model</span></span>
<span id="cb132-2436"><a href="#cb132-2436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2437"><a href="#cb132-2437" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-2438"><a href="#cb132-2438" aria-hidden="true" tabindex="-1"></a>\text{call rate} \sim \text{type} + (1 \mid \text{group}) + \text{monotonic(group size)} + (1 \mid \text{individual})</span>
<span id="cb132-2439"><a href="#cb132-2439" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-2440"><a href="#cb132-2440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2441"><a href="#cb132-2441" aria-hidden="true" tabindex="-1"></a>Response modeled with a log-normal distribution.</span>
<span id="cb132-2442"><a href="#cb132-2442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2443"><a href="#cb132-2443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r individual call rate stats, eval = FALSE}</span></span>
<span id="cb132-2444"><a href="#cb132-2444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2445"><a href="#cb132-2445" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- brm(</span></span>
<span id="cb132-2446"><a href="#cb132-2446" aria-hidden="true" tabindex="-1"></a><span class="in">          formula = calls | resp_rate(flight.time)  ~ type  + mo(group.size.f) + (1 | indiv),</span></span>
<span id="cb132-2447"><a href="#cb132-2447" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-2448"><a href="#cb132-2448" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-2449"><a href="#cb132-2449" aria-hidden="true" tabindex="-1"></a><span class="in">          data = call_rate_indiv,</span></span>
<span id="cb132-2450"><a href="#cb132-2450" aria-hidden="true" tabindex="-1"></a><span class="in">          family = negbinomial(),</span></span>
<span id="cb132-2451"><a href="#cb132-2451" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-2452"><a href="#cb132-2452" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-2453"><a href="#cb132-2453" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-2454"><a href="#cb132-2454" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99, max_treedepth = 15),</span></span>
<span id="cb132-2455"><a href="#cb132-2455" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/individual_call_rate_solo_vs_group_group_size_monot_negbinomial",</span></span>
<span id="cb132-2456"><a href="#cb132-2456" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always"</span></span>
<span id="cb132-2457"><a href="#cb132-2457" aria-hidden="true" tabindex="-1"></a><span class="in">          )</span></span>
<span id="cb132-2458"><a href="#cb132-2458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2459"><a href="#cb132-2459" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- add_criterion(mod, criterion = "loo")  </span></span>
<span id="cb132-2460"><a href="#cb132-2460" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb132-2461"><a href="#cb132-2461" aria-hidden="true" tabindex="-1"></a><span class="in">    null_mod &lt;- brm(</span></span>
<span id="cb132-2462"><a href="#cb132-2462" aria-hidden="true" tabindex="-1"></a><span class="in">          formula = calls | resp_rate(flight.time)  ~ 1 + (1 | indiv),</span></span>
<span id="cb132-2463"><a href="#cb132-2463" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-2464"><a href="#cb132-2464" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-2465"><a href="#cb132-2465" aria-hidden="true" tabindex="-1"></a><span class="in">          data = call_rate_indiv,</span></span>
<span id="cb132-2466"><a href="#cb132-2466" aria-hidden="true" tabindex="-1"></a><span class="in">          family = negbinomial(),</span></span>
<span id="cb132-2467"><a href="#cb132-2467" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-2468"><a href="#cb132-2468" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-2469"><a href="#cb132-2469" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-2470"><a href="#cb132-2470" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99, max_treedepth = 15),</span></span>
<span id="cb132-2471"><a href="#cb132-2471" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/null_model_individual_call_rate_solo_vs_group_group_size_monot_negbinomial",</span></span>
<span id="cb132-2472"><a href="#cb132-2472" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always"</span></span>
<span id="cb132-2473"><a href="#cb132-2473" aria-hidden="true" tabindex="-1"></a><span class="in">          )</span></span>
<span id="cb132-2474"><a href="#cb132-2474" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-2475"><a href="#cb132-2475" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- add_criterion(null_mod, criterion = "loo")  </span></span>
<span id="cb132-2476"><a href="#cb132-2476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2477"><a href="#cb132-2477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2478"><a href="#cb132-2478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2479"><a href="#cb132-2479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2480"><a href="#cb132-2480" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Results</span></span>
<span id="cb132-2481"><a href="#cb132-2481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2482"><a href="#cb132-2482" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Model performance vs null model </span></span>
<span id="cb132-2483"><a href="#cb132-2483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r compare models, eval = TRUE}</span></span>
<span id="cb132-2484"><a href="#cb132-2484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2485"><a href="#cb132-2485" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- readRDS("./data/processed/individual_call_rate_solo_vs_group_group_size_monot.rds")</span></span>
<span id="cb132-2486"><a href="#cb132-2486" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- readRDS("./data/processed/null_model_individual_call_rate_solo_vs_group_group_size_monot.rds")</span></span>
<span id="cb132-2487"><a href="#cb132-2487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2488"><a href="#cb132-2488" aria-hidden="true" tabindex="-1"></a><span class="in">loo_compare(mod, null_mod)</span></span>
<span id="cb132-2489"><a href="#cb132-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2490"><a href="#cb132-2490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2491"><a href="#cb132-2491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2492"><a href="#cb132-2492" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Model fit</span></span>
<span id="cb132-2493"><a href="#cb132-2493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r individual call rate results, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-2494"><a href="#cb132-2494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2495"><a href="#cb132-2495" aria-hidden="true" tabindex="-1"></a><span class="in">extended_summary(</span></span>
<span id="cb132-2496"><a href="#cb132-2496" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-2497"><a href="#cb132-2497" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.pattern = "type",</span></span>
<span id="cb132-2498"><a href="#cb132-2498" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.replacement = "solo_vs_",</span></span>
<span id="cb132-2499"><a href="#cb132-2499" aria-hidden="true" tabindex="-1"></a><span class="in">  remove.intercepts = TRUE,</span></span>
<span id="cb132-2500"><a href="#cb132-2500" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-2501"><a href="#cb132-2501" aria-hidden="true" tabindex="-1"></a><span class="in">  print.name = FALSE,</span></span>
<span id="cb132-2502"><a href="#cb132-2502" aria-hidden="true" tabindex="-1"></a><span class="in">  trace.palette = viridis::mako, </span></span>
<span id="cb132-2503"><a href="#cb132-2503" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = fill_color,</span></span>
<span id="cb132-2504"><a href="#cb132-2504" aria-hidden="true" tabindex="-1"></a><span class="in">  beta.prefix = c("^b_", "^bsp_mo")</span></span>
<span id="cb132-2505"><a href="#cb132-2505" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-2506"><a href="#cb132-2506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2507"><a href="#cb132-2507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2508"><a href="#cb132-2508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2509"><a href="#cb132-2509" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Contrasts</span></span>
<span id="cb132-2510"><a href="#cb132-2510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r contrasts, eval = TRUE, results='asis'}</span></span>
<span id="cb132-2511"><a href="#cb132-2511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2512"><a href="#cb132-2512" aria-hidden="true" tabindex="-1"></a><span class="in"># contrasts</span></span>
<span id="cb132-2513"><a href="#cb132-2513" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts(</span></span>
<span id="cb132-2514"><a href="#cb132-2514" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-2515"><a href="#cb132-2515" aria-hidden="true" tabindex="-1"></a><span class="in">  predictor = "type",</span></span>
<span id="cb132-2516"><a href="#cb132-2516" aria-hidden="true" tabindex="-1"></a><span class="in">  n.posterior = 2000,</span></span>
<span id="cb132-2517"><a href="#cb132-2517" aria-hidden="true" tabindex="-1"></a><span class="in">  level.sep = " VS ",</span></span>
<span id="cb132-2518"><a href="#cb132-2518" aria-hidden="true" tabindex="-1"></a><span class="in">  html.table = TRUE,</span></span>
<span id="cb132-2519"><a href="#cb132-2519" aria-hidden="true" tabindex="-1"></a><span class="in">  plot = TRUE,</span></span>
<span id="cb132-2520"><a href="#cb132-2520" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-2521"><a href="#cb132-2521" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = fill_color</span></span>
<span id="cb132-2522"><a href="#cb132-2522" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-2523"><a href="#cb132-2523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2524"><a href="#cb132-2524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2525"><a href="#cb132-2525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2526"><a href="#cb132-2526" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Posterior predictive checks</span></span>
<span id="cb132-2529"><a href="#cb132-2529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-2530"><a href="#cb132-2530" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb132-2531"><a href="#cb132-2531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2532"><a href="#cb132-2532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2533"><a href="#cb132-2533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2534"><a href="#cb132-2534" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-2535"><a href="#cb132-2535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2536"><a href="#cb132-2536" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb132-2537"><a href="#cb132-2537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2538"><a href="#cb132-2538" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Individuals in natural and artificial groups produce lower call rates than in solo flights</span>
<span id="cb132-2539"><a href="#cb132-2539" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No difference in call rate between natural and artificial groups</span>
<span id="cb132-2540"><a href="#cb132-2540" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No effect of group size</span>
<span id="cb132-2541"><a href="#cb132-2541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2542"><a href="#cb132-2542" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-2543"><a href="#cb132-2543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2544"><a href="#cb132-2544" aria-hidden="true" tabindex="-1"></a><span class="fu">###  Individual consistency in call rate across flight types</span></span>
<span id="cb132-2545"><a href="#cb132-2545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2546"><a href="#cb132-2546" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot raw data</span></span>
<span id="cb132-2547"><a href="#cb132-2547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2548"><a href="#cb132-2548" aria-hidden="true" tabindex="-1"></a>All group sizes combined:</span>
<span id="cb132-2549"><a href="#cb132-2549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-2550"><a href="#cb132-2550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2551"><a href="#cb132-2551" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv &lt;- readRDS("./data/processed/call_rate_by_individual.RDS")</span></span>
<span id="cb132-2552"><a href="#cb132-2552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2553"><a href="#cb132-2553" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv &lt;- call_rate_indiv[!call_rate_indiv$group %in% unique_callers_df$group[unique_callers_df$unique.callers == 1], ]</span></span>
<span id="cb132-2554"><a href="#cb132-2554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2555"><a href="#cb132-2555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2556"><a href="#cb132-2556" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group &lt;- call_rate_by_group[call_rate_by_group$type != "solo", ]</span></span>
<span id="cb132-2557"><a href="#cb132-2557" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_by_group$type &lt;- "overall.group"</span></span>
<span id="cb132-2558"><a href="#cb132-2558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2559"><a href="#cb132-2559" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv$type &lt;- as.character(call_rate_indiv$type)</span></span>
<span id="cb132-2560"><a href="#cb132-2560" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv$type[call_rate_indiv$type == "group"] &lt;- "indiv.group" </span></span>
<span id="cb132-2561"><a href="#cb132-2561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2562"><a href="#cb132-2562" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv &lt;- call_rate_indiv[!is.na(call_rate_indiv$rate) &amp; call_rate_indiv$rate &gt; 0, ]</span></span>
<span id="cb132-2563"><a href="#cb132-2563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2564"><a href="#cb132-2564" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv_cov_l &lt;- lapply(call_rate_indiv$indiv, function(x){</span></span>
<span id="cb132-2565"><a href="#cb132-2565" aria-hidden="true" tabindex="-1"></a><span class="in">  Y &lt;- call_rate_indiv[call_rate_indiv$indiv == x, ]</span></span>
<span id="cb132-2566"><a href="#cb132-2566" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-2567"><a href="#cb132-2567" aria-hidden="true" tabindex="-1"></a><span class="in">  out2 &lt;- lapply(unique(Y$group), function(y){</span></span>
<span id="cb132-2568"><a href="#cb132-2568" aria-hidden="true" tabindex="-1"></a><span class="in">    Y2 &lt;- Y[Y$group == y, ]</span></span>
<span id="cb132-2569"><a href="#cb132-2569" aria-hidden="true" tabindex="-1"></a><span class="in">    res &lt;- as.data.frame(t(unstack(Y2[, c("rate", "type")])))</span></span>
<span id="cb132-2570"><a href="#cb132-2570" aria-hidden="true" tabindex="-1"></a><span class="in">    res$group &lt;- y</span></span>
<span id="cb132-2571"><a href="#cb132-2571" aria-hidden="true" tabindex="-1"></a><span class="in">    res$experiment &lt;- Y2$experiment[1]</span></span>
<span id="cb132-2572"><a href="#cb132-2572" aria-hidden="true" tabindex="-1"></a><span class="in">    res$group.size &lt;- Y2$group.size[1]</span></span>
<span id="cb132-2573"><a href="#cb132-2573" aria-hidden="true" tabindex="-1"></a><span class="in">    return(res)</span></span>
<span id="cb132-2574"><a href="#cb132-2574" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb132-2575"><a href="#cb132-2575" aria-hidden="true" tabindex="-1"></a><span class="in">  out2 &lt;- out2[sapply(out2, ncol) == 5]</span></span>
<span id="cb132-2576"><a href="#cb132-2576" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-2577"><a href="#cb132-2577" aria-hidden="true" tabindex="-1"></a><span class="in">  rate_df &lt;- do.call(rbind, out2)</span></span>
<span id="cb132-2578"><a href="#cb132-2578" aria-hidden="true" tabindex="-1"></a><span class="in">  rate_df$indiv &lt;- x</span></span>
<span id="cb132-2579"><a href="#cb132-2579" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-2580"><a href="#cb132-2580" aria-hidden="true" tabindex="-1"></a><span class="in">  return(rate_df)</span></span>
<span id="cb132-2581"><a href="#cb132-2581" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-2582"><a href="#cb132-2582" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-2583"><a href="#cb132-2583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2584"><a href="#cb132-2584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2585"><a href="#cb132-2585" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv_cov &lt;- do.call(rbind, call_rate_indiv_cov_l[sapply(call_rate_indiv_cov_l, class) == "data.frame"])</span></span>
<span id="cb132-2586"><a href="#cb132-2586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2587"><a href="#cb132-2587" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv_cov$experiment &lt;- ifelse(call_rate_indiv_cov$experiment == "mixed", "artificial", "natural") </span></span>
<span id="cb132-2588"><a href="#cb132-2588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2589"><a href="#cb132-2589" aria-hidden="true" tabindex="-1"></a><span class="in"># make group size a factor</span></span>
<span id="cb132-2590"><a href="#cb132-2590" aria-hidden="true" tabindex="-1"></a><span class="in">call_rate_indiv_cov$group.size.f &lt;- </span></span>
<span id="cb132-2591"><a href="#cb132-2591" aria-hidden="true" tabindex="-1"></a><span class="in">  factor(call_rate_indiv_cov$group.size, ordered = TRUE)</span></span>
<span id="cb132-2592"><a href="#cb132-2592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2593"><a href="#cb132-2593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2594"><a href="#cb132-2594" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(call_rate_indiv_cov,</span></span>
<span id="cb132-2595"><a href="#cb132-2595" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(</span></span>
<span id="cb132-2596"><a href="#cb132-2596" aria-hidden="true" tabindex="-1"></a><span class="in">         y = indiv.group,</span></span>
<span id="cb132-2597"><a href="#cb132-2597" aria-hidden="true" tabindex="-1"></a><span class="in">         x = solo,</span></span>
<span id="cb132-2598"><a href="#cb132-2598" aria-hidden="true" tabindex="-1"></a><span class="in">         color = experiment)) + </span></span>
<span id="cb132-2599"><a href="#cb132-2599" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() +</span></span>
<span id="cb132-2600"><a href="#cb132-2600" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-2601"><a href="#cb132-2601" aria-hidden="true" tabindex="-1"></a><span class="in">      ylim(c(-0.1, 40)) +</span></span>
<span id="cb132-2602"><a href="#cb132-2602" aria-hidden="true" tabindex="-1"></a><span class="in">      xlim(c(-0.1, 40)) +</span></span>
<span id="cb132-2603"><a href="#cb132-2603" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "right") +</span></span>
<span id="cb132-2604"><a href="#cb132-2604" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Type", y = "Rate (calls / min)")</span></span>
<span id="cb132-2605"><a href="#cb132-2605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2606"><a href="#cb132-2606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2607"><a href="#cb132-2607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2608"><a href="#cb132-2608" aria-hidden="true" tabindex="-1"></a>By group size:</span>
<span id="cb132-2609"><a href="#cb132-2609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-2610"><a href="#cb132-2610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2611"><a href="#cb132-2611" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(call_rate_indiv_cov,</span></span>
<span id="cb132-2612"><a href="#cb132-2612" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(</span></span>
<span id="cb132-2613"><a href="#cb132-2613" aria-hidden="true" tabindex="-1"></a><span class="in">         y = indiv.group,</span></span>
<span id="cb132-2614"><a href="#cb132-2614" aria-hidden="true" tabindex="-1"></a><span class="in">         x = solo,</span></span>
<span id="cb132-2615"><a href="#cb132-2615" aria-hidden="true" tabindex="-1"></a><span class="in">         color = experiment)) + </span></span>
<span id="cb132-2616"><a href="#cb132-2616" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point() +</span></span>
<span id="cb132-2617"><a href="#cb132-2617" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-2618"><a href="#cb132-2618" aria-hidden="true" tabindex="-1"></a><span class="in">      ylim(c(-0.1, 40)) +</span></span>
<span id="cb132-2619"><a href="#cb132-2619" aria-hidden="true" tabindex="-1"></a><span class="in">      xlim(c(-0.1, 40)) +</span></span>
<span id="cb132-2620"><a href="#cb132-2620" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "right") +</span></span>
<span id="cb132-2621"><a href="#cb132-2621" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Type", y = "Rate (calls / min)") +</span></span>
<span id="cb132-2622"><a href="#cb132-2622" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(</span></span>
<span id="cb132-2623"><a href="#cb132-2623" aria-hidden="true" tabindex="-1"></a><span class="in">    ~ group.size.f,</span></span>
<span id="cb132-2624"><a href="#cb132-2624" aria-hidden="true" tabindex="-1"></a><span class="in">    ncol = 2,</span></span>
<span id="cb132-2625"><a href="#cb132-2625" aria-hidden="true" tabindex="-1"></a><span class="in">    labeller = labeller(group.size.f = custom_labels)</span></span>
<span id="cb132-2626"><a href="#cb132-2626" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-2627"><a href="#cb132-2627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2628"><a href="#cb132-2628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2629"><a href="#cb132-2629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2630"><a href="#cb132-2630" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Regression model</span></span>
<span id="cb132-2631"><a href="#cb132-2631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2632"><a href="#cb132-2632" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-2633"><a href="#cb132-2633" aria-hidden="true" tabindex="-1"></a>\text{indiv call rate in group} \sim \text{solo call rate} + \text{experiment} + (1 \mid \text{group}) + \text{monotonic(group size)} + (1 \mid \text{individual})</span>
<span id="cb132-2634"><a href="#cb132-2634" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-2635"><a href="#cb132-2635" aria-hidden="true" tabindex="-1"></a><span class="in">```{r individual call rate covariation stats, eval = FALSE}</span></span>
<span id="cb132-2636"><a href="#cb132-2636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2637"><a href="#cb132-2637" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- brm(</span></span>
<span id="cb132-2638"><a href="#cb132-2638" aria-hidden="true" tabindex="-1"></a><span class="in">          formula = indiv.group ~ solo + experiment + mo(group.size.f) + (1 | indiv),</span></span>
<span id="cb132-2639"><a href="#cb132-2639" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-2640"><a href="#cb132-2640" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-2641"><a href="#cb132-2641" aria-hidden="true" tabindex="-1"></a><span class="in">          data = call_rate_indiv_cov,</span></span>
<span id="cb132-2642"><a href="#cb132-2642" aria-hidden="true" tabindex="-1"></a><span class="in">          family = gaussian(),</span></span>
<span id="cb132-2643"><a href="#cb132-2643" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-2644"><a href="#cb132-2644" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-2645"><a href="#cb132-2645" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-2646"><a href="#cb132-2646" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99, max_treedepth = 15),</span></span>
<span id="cb132-2647"><a href="#cb132-2647" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial",</span></span>
<span id="cb132-2648"><a href="#cb132-2648" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always"</span></span>
<span id="cb132-2649"><a href="#cb132-2649" aria-hidden="true" tabindex="-1"></a><span class="in">          )</span></span>
<span id="cb132-2650"><a href="#cb132-2650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2651"><a href="#cb132-2651" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- add_criterion(mod, criterion = "loo")  </span></span>
<span id="cb132-2652"><a href="#cb132-2652" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb132-2653"><a href="#cb132-2653" aria-hidden="true" tabindex="-1"></a><span class="in">mod_inter &lt;- brm(</span></span>
<span id="cb132-2654"><a href="#cb132-2654" aria-hidden="true" tabindex="-1"></a><span class="in">          formula = indiv.group ~ solo * experiment + mo(group.size.f) + (1 | indiv),</span></span>
<span id="cb132-2655"><a href="#cb132-2655" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-2656"><a href="#cb132-2656" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-2657"><a href="#cb132-2657" aria-hidden="true" tabindex="-1"></a><span class="in">          data = call_rate_indiv_cov,</span></span>
<span id="cb132-2658"><a href="#cb132-2658" aria-hidden="true" tabindex="-1"></a><span class="in">          family = gaussian(),</span></span>
<span id="cb132-2659"><a href="#cb132-2659" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-2660"><a href="#cb132-2660" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-2661"><a href="#cb132-2661" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-2662"><a href="#cb132-2662" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99, max_treedepth = 15),</span></span>
<span id="cb132-2663"><a href="#cb132-2663" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial_interaction",</span></span>
<span id="cb132-2664"><a href="#cb132-2664" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always"</span></span>
<span id="cb132-2665"><a href="#cb132-2665" aria-hidden="true" tabindex="-1"></a><span class="in">          )</span></span>
<span id="cb132-2666"><a href="#cb132-2666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2667"><a href="#cb132-2667" aria-hidden="true" tabindex="-1"></a><span class="in">mod_inter &lt;- add_criterion(mod_inter, criterion = "loo")  </span></span>
<span id="cb132-2668"><a href="#cb132-2668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2669"><a href="#cb132-2669" aria-hidden="true" tabindex="-1"></a><span class="in">    null_mod &lt;- brm(</span></span>
<span id="cb132-2670"><a href="#cb132-2670" aria-hidden="true" tabindex="-1"></a><span class="in">           formula = indiv.group  ~ 1 + mo(group.size.f) + (1 | indiv),</span></span>
<span id="cb132-2671"><a href="#cb132-2671" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-2672"><a href="#cb132-2672" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-2673"><a href="#cb132-2673" aria-hidden="true" tabindex="-1"></a><span class="in">          data = call_rate_indiv_cov,</span></span>
<span id="cb132-2674"><a href="#cb132-2674" aria-hidden="true" tabindex="-1"></a><span class="in">          family = gaussian(),</span></span>
<span id="cb132-2675"><a href="#cb132-2675" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-2676"><a href="#cb132-2676" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-2677"><a href="#cb132-2677" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-2678"><a href="#cb132-2678" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99, max_treedepth = 15),</span></span>
<span id="cb132-2679"><a href="#cb132-2679" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/null_model_individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial",</span></span>
<span id="cb132-2680"><a href="#cb132-2680" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always"</span></span>
<span id="cb132-2681"><a href="#cb132-2681" aria-hidden="true" tabindex="-1"></a><span class="in">          )</span></span>
<span id="cb132-2682"><a href="#cb132-2682" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-2683"><a href="#cb132-2683" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- add_criterion(null_mod, criterion = "loo")  </span></span>
<span id="cb132-2684"><a href="#cb132-2684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2685"><a href="#cb132-2685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2686"><a href="#cb132-2686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2687"><a href="#cb132-2687" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Results</span></span>
<span id="cb132-2688"><a href="#cb132-2688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2689"><a href="#cb132-2689" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Model performance vs null model </span></span>
<span id="cb132-2690"><a href="#cb132-2690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r compare models 2, eval = TRUE}</span></span>
<span id="cb132-2691"><a href="#cb132-2691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2692"><a href="#cb132-2692" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- readRDS("./data/processed/individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial.rds")</span></span>
<span id="cb132-2693"><a href="#cb132-2693" aria-hidden="true" tabindex="-1"></a><span class="in">mod_inter &lt;- readRDS("./data/processed/individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial_interaction.rds")</span></span>
<span id="cb132-2694"><a href="#cb132-2694" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- readRDS("./data/processed/null_model_individual_call_rate_solo_vs_group_covariation_group_size_monot_negbinomial.rds")</span></span>
<span id="cb132-2695"><a href="#cb132-2695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2696"><a href="#cb132-2696" aria-hidden="true" tabindex="-1"></a><span class="in">loo_compare(mod, mod_inter, null_mod)</span></span>
<span id="cb132-2697"><a href="#cb132-2697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2698"><a href="#cb132-2698" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2699"><a href="#cb132-2699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2700"><a href="#cb132-2700" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Model fit</span></span>
<span id="cb132-2701"><a href="#cb132-2701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r individual call rate covariation results, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-2702"><a href="#cb132-2702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2703"><a href="#cb132-2703" aria-hidden="true" tabindex="-1"></a><span class="in">extended_summary(</span></span>
<span id="cb132-2704"><a href="#cb132-2704" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-2705"><a href="#cb132-2705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2706"><a href="#cb132-2706" aria-hidden="true" tabindex="-1"></a><span class="in">  remove.intercepts = TRUE,</span></span>
<span id="cb132-2707"><a href="#cb132-2707" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-2708"><a href="#cb132-2708" aria-hidden="true" tabindex="-1"></a><span class="in">  print.name = FALSE,</span></span>
<span id="cb132-2709"><a href="#cb132-2709" aria-hidden="true" tabindex="-1"></a><span class="in">  trace.palette = viridis::mako, </span></span>
<span id="cb132-2710"><a href="#cb132-2710" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = fill_color,</span></span>
<span id="cb132-2711"><a href="#cb132-2711" aria-hidden="true" tabindex="-1"></a><span class="in">  beta.prefix = c("^b_", "^bsp_mo")</span></span>
<span id="cb132-2712"><a href="#cb132-2712" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-2713"><a href="#cb132-2713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2714"><a href="#cb132-2714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2715"><a href="#cb132-2715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2716"><a href="#cb132-2716" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Posterior predictive checks</span></span>
<span id="cb132-2719"><a href="#cb132-2719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-2720"><a href="#cb132-2720" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb132-2721"><a href="#cb132-2721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2722"><a href="#cb132-2722" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2723"><a href="#cb132-2723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2724"><a href="#cb132-2724" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-2725"><a href="#cb132-2725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2726"><a href="#cb132-2726" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb132-2727"><a href="#cb132-2727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2728"><a href="#cb132-2728" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Individual call rate is positively associated between solo and group flights</span>
<span id="cb132-2729"><a href="#cb132-2729" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Association of call rate between solo and group flights is similar between natural and artificial groups</span>
<span id="cb132-2730"><a href="#cb132-2730" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No effect of group size</span>
<span id="cb132-2731"><a href="#cb132-2731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2732"><a href="#cb132-2732" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-2733"><a href="#cb132-2733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2734"><a href="#cb132-2734" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulated group calling</span></span>
<span id="cb132-2735"><a href="#cb132-2735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2738"><a href="#cb132-2738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-2739"><a href="#cb132-2739" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval = FALSE</span></span>
<span id="cb132-2740"><a href="#cb132-2740" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb132-2741"><a href="#cb132-2741" aria-hidden="true" tabindex="-1"></a>time_calls_indiv <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/time_position_calls_by_individual.RDS"</span>)  </span>
<span id="cb132-2742"><a href="#cb132-2742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2743"><a href="#cb132-2743" aria-hidden="true" tabindex="-1"></a><span class="co"># keep only 120 s duration flights</span></span>
<span id="cb132-2744"><a href="#cb132-2744" aria-hidden="true" tabindex="-1"></a>time_calls_indiv <span class="ot">&lt;-</span> time_calls_indiv[time_calls_indiv<span class="sc">$</span>flight.time <span class="sc">==</span> <span class="dv">120</span>, ]</span>
<span id="cb132-2745"><a href="#cb132-2745" aria-hidden="true" tabindex="-1"></a>time_calls_indiv <span class="ot">&lt;-</span> time_calls_indiv[<span class="fu">complete.cases</span>(time_calls_indiv), ]</span>
<span id="cb132-2746"><a href="#cb132-2746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2747"><a href="#cb132-2747" aria-hidden="true" tabindex="-1"></a>time_calls_indiv<span class="sc">$</span>sound.files <span class="ot">&lt;-</span> time_calls_indiv<span class="sc">$</span>orig.sound.files</span>
<span id="cb132-2748"><a href="#cb132-2748" aria-hidden="true" tabindex="-1"></a>ovlp <span class="ot">&lt;-</span> <span class="fu">overlapping_sels</span>(time_calls_indiv, <span class="at">parallel =</span> <span class="dv">10</span>)</span>
<span id="cb132-2749"><a href="#cb132-2749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2750"><a href="#cb132-2750" aria-hidden="true" tabindex="-1"></a><span class="co"># remove overlapping sounds</span></span>
<span id="cb132-2751"><a href="#cb132-2751" aria-hidden="true" tabindex="-1"></a>time_calls_indiv <span class="ot">&lt;-</span> ovlp[<span class="fu">is.na</span>(ovlp<span class="sc">$</span>ovlp.sels), ]</span>
<span id="cb132-2752"><a href="#cb132-2752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2753"><a href="#cb132-2753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2754"><a href="#cb132-2754" aria-hidden="true" tabindex="-1"></a>sim_group_call_list <span class="ot">&lt;-</span></span>
<span id="cb132-2755"><a href="#cb132-2755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, <span class="cf">function</span>(x) <span class="fu">sim_group_call</span>(<span class="fu">c</span>(group_sizes, <span class="fu">rep</span>(<span class="dv">7</span>, <span class="dv">6</span>)), <span class="at">seed =</span> x))</span>
<span id="cb132-2756"><a href="#cb132-2756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2757"><a href="#cb132-2757" aria-hidden="true" tabindex="-1"></a><span class="co"># add simulation tag</span></span>
<span id="cb132-2758"><a href="#cb132-2758" aria-hidden="true" tabindex="-1"></a>sim_group_call_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(sim_group_call_list), <span class="cf">function</span>(x) {</span>
<span id="cb132-2759"><a href="#cb132-2759" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> sim_group_call_list[[x]]</span>
<span id="cb132-2760"><a href="#cb132-2760" aria-hidden="true" tabindex="-1"></a>  Y<span class="sc">$</span>sim <span class="ot">&lt;-</span> x</span>
<span id="cb132-2761"><a href="#cb132-2761" aria-hidden="true" tabindex="-1"></a>  Y<span class="sc">$</span>sound.files <span class="ot">&lt;-</span> <span class="fu">paste0</span>(Y<span class="sc">$</span>sound.files, <span class="st">"-sim"</span>, x)</span>
<span id="cb132-2762"><a href="#cb132-2762" aria-hidden="true" tabindex="-1"></a>  Y<span class="sc">$</span>selec <span class="ot">&lt;-</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(Y))</span>
<span id="cb132-2763"><a href="#cb132-2763" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-2764"><a href="#cb132-2764" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(Y)  </span>
<span id="cb132-2765"><a href="#cb132-2765" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb132-2766"><a href="#cb132-2766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2767"><a href="#cb132-2767" aria-hidden="true" tabindex="-1"></a>sim_group_call_df <span class="ot">&lt;-</span> <span class="fu">do_call</span>(rbind, sim_group_call_list)</span>
<span id="cb132-2768"><a href="#cb132-2768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2769"><a href="#cb132-2769" aria-hidden="true" tabindex="-1"></a>ovlps <span class="ot">&lt;-</span> <span class="fu">overlapping_sels</span>(sim_group_call_df, <span class="at">parallel =</span> <span class="dv">10</span>)</span>
<span id="cb132-2770"><a href="#cb132-2770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2771"><a href="#cb132-2771" aria-hidden="true" tabindex="-1"></a>ovlp_count_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(ovlps<span class="sc">$</span>sound.files), <span class="cf">function</span>(x){</span>
<span id="cb132-2772"><a href="#cb132-2772" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> ovlps[ovlps<span class="sc">$</span>sound.files <span class="sc">==</span> x, ]</span>
<span id="cb132-2773"><a href="#cb132-2773" aria-hidden="true" tabindex="-1"></a>  cnt <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(X<span class="sc">$</span>ovlp.sels))</span>
<span id="cb132-2774"><a href="#cb132-2774" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sound.files =</span> x, <span class="at">group.size =</span> X<span class="sc">$</span>group.size[<span class="dv">1</span>], <span class="at">ovlp.count =</span> cnt)</span>
<span id="cb132-2775"><a href="#cb132-2775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb132-2776"><a href="#cb132-2776" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb132-2777"><a href="#cb132-2777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2778"><a href="#cb132-2778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2779"><a href="#cb132-2779" aria-hidden="true" tabindex="-1"></a>ovlp_count_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, ovlp_count_list)</span>
<span id="cb132-2780"><a href="#cb132-2780" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-2781"><a href="#cb132-2781" aria-hidden="true" tabindex="-1"></a>ovlp_count_df<span class="sc">$</span>ovlp.count <span class="ot">&lt;-</span> ovlp_count_df<span class="sc">$</span>ovlp.count <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb132-2782"><a href="#cb132-2782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2783"><a href="#cb132-2783" aria-hidden="true" tabindex="-1"></a>ovlp_count_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Simulated"</span> </span>
<span id="cb132-2784"><a href="#cb132-2784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2785"><a href="#cb132-2785" aria-hidden="true" tabindex="-1"></a>ovlp_count_df<span class="sc">$</span>flight.time <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb132-2786"><a href="#cb132-2786" aria-hidden="true" tabindex="-1"></a>ovlp_count_df<span class="sc">$</span>ovlp.rate <span class="ot">&lt;-</span> ovlp_count_df<span class="sc">$</span>ovlp.count <span class="sc">/</span> ovlp_count_df<span class="sc">$</span>fligh.time</span>
<span id="cb132-2787"><a href="#cb132-2787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2788"><a href="#cb132-2788" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(ovlp_count_df, <span class="st">"./data/processed/ovlps_simulated_group_call.RDS"</span>)</span>
<span id="cb132-2789"><a href="#cb132-2789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2790"><a href="#cb132-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2791"><a href="#cb132-2791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2794"><a href="#cb132-2794" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-2795"><a href="#cb132-2795" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb132-2796"><a href="#cb132-2796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2797"><a href="#cb132-2797" aria-hidden="true" tabindex="-1"></a>sim_ovlp_count_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/ovlps_simulated_group_call.RDS"</span>)</span>
<span id="cb132-2798"><a href="#cb132-2798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2799"><a href="#cb132-2799" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot with histogram of # of overlapping sounds by group size</span></span>
<span id="cb132-2800"><a href="#cb132-2800" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim_ovlp_count_df, <span class="fu">aes</span>(<span class="at">x =</span> ovlp.rate, <span class="at">fill =</span> <span class="fu">factor</span>(group.size))) <span class="sc">+</span></span>
<span id="cb132-2801"><a href="#cb132-2801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>( <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb132-2802"><a href="#cb132-2802" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb132-2803"><a href="#cb132-2803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of overlaps"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb132-2804"><a href="#cb132-2804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb132-2805"><a href="#cb132-2805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group.size)</span>
<span id="cb132-2806"><a href="#cb132-2806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2807"><a href="#cb132-2807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2808"><a href="#cb132-2808" aria-hidden="true" tabindex="-1"></a>time_calls_groups <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/time_position_calls_for_group_flights.RDS"</span>)  </span>
<span id="cb132-2809"><a href="#cb132-2809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2810"><a href="#cb132-2810" aria-hidden="true" tabindex="-1"></a><span class="co"># remove those in which only one individual called</span></span>
<span id="cb132-2811"><a href="#cb132-2811" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/processed/group_call_individual_id_sequence.csv"</span>)</span>
<span id="cb132-2812"><a href="#cb132-2812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2813"><a href="#cb132-2813" aria-hidden="true" tabindex="-1"></a><span class="co"># # keep only 120 s duration flights</span></span>
<span id="cb132-2814"><a href="#cb132-2814" aria-hidden="true" tabindex="-1"></a><span class="co"># call_id_seq &lt;- call_id_seq[call_id_seq$flight.time == 120,]</span></span>
<span id="cb132-2815"><a href="#cb132-2815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2816"><a href="#cb132-2816" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> call_id_seq[<span class="fu">order</span>(call_id_seq<span class="sc">$</span>event, call_id_seq<span class="sc">$</span>start), ]</span>
<span id="cb132-2817"><a href="#cb132-2817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2818"><a href="#cb132-2818" aria-hidden="true" tabindex="-1"></a>call_id_seq_list <span class="ot">&lt;-</span> <span class="fu">split</span>(call_id_seq, call_id_seq<span class="sc">$</span>event)</span>
<span id="cb132-2819"><a href="#cb132-2819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2820"><a href="#cb132-2820" aria-hidden="true" tabindex="-1"></a>unique_callers_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(call_id_seq_list, <span class="cf">function</span>(x){</span>
<span id="cb132-2821"><a href="#cb132-2821" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[<span class="fu">order</span>(x<span class="sc">$</span>start), ]</span>
<span id="cb132-2822"><a href="#cb132-2822" aria-hidden="true" tabindex="-1"></a>  id_seq <span class="ot">&lt;-</span> x<span class="sc">$</span>indiv</span>
<span id="cb132-2823"><a href="#cb132-2823" aria-hidden="true" tabindex="-1"></a>  id_seq <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(id_seq)))</span>
<span id="cb132-2824"><a href="#cb132-2824" aria-hidden="true" tabindex="-1"></a>  unique.callers <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(id_seq))</span>
<span id="cb132-2825"><a href="#cb132-2825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2826"><a href="#cb132-2826" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group =</span> x<span class="sc">$</span>group[<span class="dv">1</span>], <span class="at">unique.callers =</span> unique.callers)</span>
<span id="cb132-2827"><a href="#cb132-2827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb132-2828"><a href="#cb132-2828" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb132-2829"><a href="#cb132-2829" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb132-2830"><a href="#cb132-2830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2831"><a href="#cb132-2831" aria-hidden="true" tabindex="-1"></a>unique_callers_df <span class="ot">&lt;-</span> <span class="fu">do_call</span>(rbind, unique_callers_list)</span>
<span id="cb132-2832"><a href="#cb132-2832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2833"><a href="#cb132-2833" aria-hidden="true" tabindex="-1"></a>time_calls_groups <span class="ot">&lt;-</span> call_id_seq[<span class="sc">!</span>call_id_seq<span class="sc">$</span>group <span class="sc">%in%</span> unique_callers_df<span class="sc">$</span>group[unique_callers_df<span class="sc">$</span>unique.callers <span class="sc">==</span> <span class="dv">1</span>], ]</span>
<span id="cb132-2834"><a href="#cb132-2834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2835"><a href="#cb132-2835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2836"><a href="#cb132-2836" aria-hidden="true" tabindex="-1"></a>time_calls_groups<span class="sc">$</span>sound.files <span class="ot">&lt;-</span> time_calls_groups<span class="sc">$</span>event</span>
<span id="cb132-2837"><a href="#cb132-2837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2838"><a href="#cb132-2838" aria-hidden="true" tabindex="-1"></a>obs_ovlps <span class="ot">&lt;-</span> <span class="fu">overlapping_sels</span>(time_calls_groups, <span class="at">parallel =</span> <span class="dv">10</span>)</span>
<span id="cb132-2839"><a href="#cb132-2839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2840"><a href="#cb132-2840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2841"><a href="#cb132-2841" aria-hidden="true" tabindex="-1"></a>obs_ovlp_count_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">unique</span>(obs_ovlps<span class="sc">$</span>sound.files), <span class="cf">function</span>(x){</span>
<span id="cb132-2842"><a href="#cb132-2842" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> obs_ovlps[obs_ovlps<span class="sc">$</span>sound.files <span class="sc">==</span> x, ]</span>
<span id="cb132-2843"><a href="#cb132-2843" aria-hidden="true" tabindex="-1"></a>  cnt <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(X<span class="sc">$</span>ovlp.sels))</span>
<span id="cb132-2844"><a href="#cb132-2844" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sound.files =</span> x, <span class="at">group.size =</span> X<span class="sc">$</span>group.size[<span class="dv">1</span>], <span class="at">type =</span> X<span class="sc">$</span>type[<span class="dv">1</span>], <span class="at">ovlp.count =</span> cnt, <span class="at">flight.time =</span> X<span class="sc">$</span>flight.time[<span class="dv">1</span>])</span>
<span id="cb132-2845"><a href="#cb132-2845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb132-2846"><a href="#cb132-2846" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb132-2847"><a href="#cb132-2847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2848"><a href="#cb132-2848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2849"><a href="#cb132-2849" aria-hidden="true" tabindex="-1"></a>obs_ovlp_count_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, obs_ovlp_count_list)</span>
<span id="cb132-2850"><a href="#cb132-2850" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-2851"><a href="#cb132-2851" aria-hidden="true" tabindex="-1"></a>obs_ovlp_count_df<span class="sc">$</span>ovlp.count <span class="ot">&lt;-</span> obs_ovlp_count_df<span class="sc">$</span>ovlp.count <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb132-2852"><a href="#cb132-2852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2853"><a href="#cb132-2853" aria-hidden="true" tabindex="-1"></a>obs_ovlp_count_df<span class="sc">$</span>ovlp.rate <span class="ot">&lt;-</span> obs_ovlp_count_df<span class="sc">$</span>ovlp.count <span class="sc">/</span> obs_ovlp_count_df<span class="sc">$</span>flight.time</span>
<span id="cb132-2854"><a href="#cb132-2854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2855"><a href="#cb132-2855" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot with histogram of # of overlapping sounds by group size</span></span>
<span id="cb132-2856"><a href="#cb132-2856" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(obs_ovlp_count_df, <span class="fu">aes</span>(<span class="at">x =</span> ovlp.rate, <span class="at">fill =</span> <span class="fu">factor</span>(group.size))) <span class="sc">+</span></span>
<span id="cb132-2857"><a href="#cb132-2857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb132-2858"><a href="#cb132-2858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb132-2859"><a href="#cb132-2859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of overlaps"</span>, <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb132-2860"><a href="#cb132-2860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb132-2861"><a href="#cb132-2861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group.size)</span>
<span id="cb132-2862"><a href="#cb132-2862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2863"><a href="#cb132-2863" aria-hidden="true" tabindex="-1"></a>sim_ovlp_count_df<span class="sc">$</span>simulation <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb132-2864"><a href="#cb132-2864" aria-hidden="true" tabindex="-1"></a>total_count_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sim_ovlp_count_df, obs_ovlp_count_df)</span>
<span id="cb132-2865"><a href="#cb132-2865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2866"><a href="#cb132-2866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2867"><a href="#cb132-2867" aria-hidden="true" tabindex="-1"></a>total_count_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Regular"</span>, <span class="st">"Natural"</span>, total_count_df<span class="sc">$</span>type)</span>
<span id="cb132-2868"><a href="#cb132-2868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2869"><a href="#cb132-2869" aria-hidden="true" tabindex="-1"></a>total_count_df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(total_count_df<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Natural"</span>, <span class="st">"Artificial"</span>, <span class="st">"Simulated"</span>))</span>
<span id="cb132-2870"><a href="#cb132-2870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2871"><a href="#cb132-2871" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(total_count_df, <span class="st">"./data/processed/total_ovlp_count.RDS"</span>)</span>
<span id="cb132-2872"><a href="#cb132-2872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2873"><a href="#cb132-2873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2874"><a href="#cb132-2874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2875"><a href="#cb132-2875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2878"><a href="#cb132-2878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-2879"><a href="#cb132-2879" aria-hidden="true" tabindex="-1"></a>total_count_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"./data/processed/total_ovlp_count.RDS"</span>)</span>
<span id="cb132-2880"><a href="#cb132-2880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2881"><a href="#cb132-2881" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to overlaps per minute</span></span>
<span id="cb132-2882"><a href="#cb132-2882" aria-hidden="true" tabindex="-1"></a>total_count_df<span class="sc">$</span>ovlp.rate <span class="ot">&lt;-</span> total_count_df<span class="sc">$</span>ovlp.rate <span class="sc">*</span> <span class="dv">60</span></span>
<span id="cb132-2883"><a href="#cb132-2883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2884"><a href="#cb132-2884" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_count_df, <span class="fu">aes</span>(<span class="at">x =</span> ovlp.rate, <span class="at">fill =</span> <span class="fu">factor</span>(type))) <span class="sc">+</span></span>
<span id="cb132-2885"><a href="#cb132-2885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">adjust =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb132-2886"><a href="#cb132-2886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb132-2887"><a href="#cb132-2887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Number of overlaps"</span>, <span class="at">y =</span> <span class="st">"Density"</span>, <span class="at">fill =</span> <span class="st">"Group type"</span>) <span class="sc">+</span></span>
<span id="cb132-2888"><a href="#cb132-2888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group.size, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb132-2889"><a href="#cb132-2889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2890"><a href="#cb132-2890" aria-hidden="true" tabindex="-1"></a>agg_cnt <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(ovlp.rate <span class="sc">~</span> group.size <span class="sc">+</span> type, <span class="at">data =</span> total_count_df, <span class="at">FUN =</span> mean)</span>
<span id="cb132-2891"><a href="#cb132-2891" aria-hidden="true" tabindex="-1"></a>agg_cnt<span class="sc">$</span>sd <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(ovlp.rate <span class="sc">~</span> group.size <span class="sc">+</span> type, <span class="at">data =</span> total_count_df, <span class="at">FUN =</span> sd)<span class="sc">$</span>ovlp.rate</span>
<span id="cb132-2892"><a href="#cb132-2892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2893"><a href="#cb132-2893" aria-hidden="true" tabindex="-1"></a><span class="co"># table(call_rate_by_group$group.size, call_rate_by_group$type)</span></span>
<span id="cb132-2894"><a href="#cb132-2894" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> graph_cols[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb132-2895"><a href="#cb132-2895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2896"><a href="#cb132-2896" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(cols) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"Natural"</span>, <span class="st">"Artificial"</span>, <span class="st">"Simulated"</span>), <span class="st">"group"</span>)</span>
<span id="cb132-2897"><a href="#cb132-2897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2898"><a href="#cb132-2898" aria-hidden="true" tabindex="-1"></a>agg_cnt<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">paste</span>(agg_cnt<span class="sc">$</span>type, <span class="st">"group"</span>)</span>
<span id="cb132-2899"><a href="#cb132-2899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2900"><a href="#cb132-2900" aria-hidden="true" tabindex="-1"></a>agg_cnt<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">factor</span>(agg_cnt<span class="sc">$</span>type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Natural group"</span>, <span class="st">"Artificial group"</span>, <span class="st">"Simulated group"</span>))</span>
<span id="cb132-2901"><a href="#cb132-2901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2902"><a href="#cb132-2902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2903"><a href="#cb132-2903" aria-hidden="true" tabindex="-1"></a><span class="co"># convert previous graph in a point sd graph with number of overlaps in y and group size as factor in x</span></span>
<span id="cb132-2904"><a href="#cb132-2904" aria-hidden="true" tabindex="-1"></a>gg_overlap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agg_cnt, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(group.size), <span class="at">y =</span> ovlp.rate, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb132-2905"><a href="#cb132-2905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>), <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb132-2906"><a href="#cb132-2906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> ovlp.rate <span class="sc">-</span> sd, <span class="at">ymax =</span> ovlp.rate <span class="sc">+</span> sd), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="dv">0</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>), <span class="at">show.legend =</span> <span class="cn">FALSE</span>,  <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb132-2907"><a href="#cb132-2907" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols) <span class="sc">+</span></span>
<span id="cb132-2908"><a href="#cb132-2908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Group size"</span>, <span class="at">y =</span> <span class="st">"Overlaps / min"</span>, <span class="at">color =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb132-2909"><a href="#cb132-2909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"inside"</span>, <span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.7</span>)) </span>
<span id="cb132-2910"><a href="#cb132-2910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2911"><a href="#cb132-2911" aria-hidden="true" tabindex="-1"></a>gg_overlap</span>
<span id="cb132-2912"><a href="#cb132-2912" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2913"><a href="#cb132-2913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2914"><a href="#cb132-2914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2917"><a href="#cb132-2917" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-2918"><a href="#cb132-2918" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span></span>
<span id="cb132-2919"><a href="#cb132-2919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_grid</span>(</span>
<span id="cb132-2920"><a href="#cb132-2920" aria-hidden="true" tabindex="-1"></a>    gg_rate_indiv_pimp <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,  <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb132-2921"><a href="#cb132-2921" aria-hidden="true" tabindex="-1"></a>    ggrate_indv_grp_pimp <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()),</span>
<span id="cb132-2922"><a href="#cb132-2922" aria-hidden="true" tabindex="-1"></a>    gg_overlap <span class="sc">+</span> <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">12</span>)  <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"inside"</span>, <span class="at">legend.position.inside =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.7</span>)),</span>
<span id="cb132-2923"><a href="#cb132-2923" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb132-2924"><a href="#cb132-2924" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels=</span><span class="st">"AUTO"</span></span>
<span id="cb132-2925"><a href="#cb132-2925" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb132-2926"><a href="#cb132-2926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2927"><a href="#cb132-2927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2928"><a href="#cb132-2928" aria-hidden="true" tabindex="-1"></a>hedFont <span class="ot">&lt;-</span> <span class="st">"Arial"</span></span>
<span id="cb132-2929"><a href="#cb132-2929" aria-hidden="true" tabindex="-1"></a>pg <span class="ot">&lt;-</span> pg <span class="sc">+</span> </span>
<span id="cb132-2930"><a href="#cb132-2930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">family =</span> hedFont, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb132-2931"><a href="#cb132-2931" aria-hidden="true" tabindex="-1"></a>                                           </span>
<span id="cb132-2932"><a href="#cb132-2932" aria-hidden="true" tabindex="-1"></a>pg</span>
<span id="cb132-2933"><a href="#cb132-2933" aria-hidden="true" tabindex="-1"></a>                                           </span>
<span id="cb132-2934"><a href="#cb132-2934" aria-hidden="true" tabindex="-1"></a><span class="co"># ggsave(</span></span>
<span id="cb132-2935"><a href="#cb132-2935" aria-hidden="true" tabindex="-1"></a><span class="co">#   "./output/vocal_coordination_3_panels.png",</span></span>
<span id="cb132-2936"><a href="#cb132-2936" aria-hidden="true" tabindex="-1"></a><span class="co">#   pg,</span></span>
<span id="cb132-2937"><a href="#cb132-2937" aria-hidden="true" tabindex="-1"></a><span class="co">#   grDevices::png,</span></span>
<span id="cb132-2938"><a href="#cb132-2938" aria-hidden="true" tabindex="-1"></a><span class="co">#   width = 6,</span></span>
<span id="cb132-2939"><a href="#cb132-2939" aria-hidden="true" tabindex="-1"></a><span class="co">#   height = 8,</span></span>
<span id="cb132-2940"><a href="#cb132-2940" aria-hidden="true" tabindex="-1"></a><span class="co">#   dpi = 300</span></span>
<span id="cb132-2941"><a href="#cb132-2941" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb132-2942"><a href="#cb132-2942" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-2943"><a href="#cb132-2943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2944"><a href="#cb132-2944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2945"><a href="#cb132-2945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Simulation regression}</span></span>
<span id="cb132-2946"><a href="#cb132-2946" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval = FALSE</span></span>
<span id="cb132-2947"><a href="#cb132-2947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2948"><a href="#cb132-2948" aria-hidden="true" tabindex="-1"></a><span class="in"># observed data</span></span>
<span id="cb132-2949"><a href="#cb132-2949" aria-hidden="true" tabindex="-1"></a><span class="in">obs_ovlp_count_df &lt;- total_count_df[total_count_df$type != "Simulated", ]</span></span>
<span id="cb132-2950"><a href="#cb132-2950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2951"><a href="#cb132-2951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2952"><a href="#cb132-2952" aria-hidden="true" tabindex="-1"></a><span class="in">sim_ovlp_count_df$simulation &lt;- sapply(strsplit(sim_ovlp_count_df$sound.files, "-"), "[", 3)</span></span>
<span id="cb132-2953"><a href="#cb132-2953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2954"><a href="#cb132-2954" aria-hidden="true" tabindex="-1"></a><span class="in"># split by simulation</span></span>
<span id="cb132-2955"><a href="#cb132-2955" aria-hidden="true" tabindex="-1"></a><span class="in">sim_ovlp_count_list &lt;- split(sim_ovlp_count_df, sim_ovlp_count_df$simulation)</span></span>
<span id="cb132-2956"><a href="#cb132-2956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2957"><a href="#cb132-2957" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(123)</span></span>
<span id="cb132-2958"><a href="#cb132-2958" aria-hidden="true" tabindex="-1"></a><span class="in">sim_ovlp_count_list &lt;- sample(sim_ovlp_count_list, 30)</span></span>
<span id="cb132-2959"><a href="#cb132-2959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2960"><a href="#cb132-2960" aria-hidden="true" tabindex="-1"></a><span class="in">#combined each simulated data with the observed data</span></span>
<span id="cb132-2961"><a href="#cb132-2961" aria-hidden="true" tabindex="-1"></a><span class="in">sim_call_groups_list &lt;- lapply(sim_ovlp_count_list, function(x){</span></span>
<span id="cb132-2962"><a href="#cb132-2962" aria-hidden="true" tabindex="-1"></a><span class="in">    x$simulation &lt;- NULL</span></span>
<span id="cb132-2963"><a href="#cb132-2963" aria-hidden="true" tabindex="-1"></a><span class="in">  out &lt;- rbind(obs_ovlp_count_df, x)</span></span>
<span id="cb132-2964"><a href="#cb132-2964" aria-hidden="true" tabindex="-1"></a><span class="in">  out$ovlp.count &lt;- out$ovlp.count * 2</span></span>
<span id="cb132-2965"><a href="#cb132-2965" aria-hidden="true" tabindex="-1"></a><span class="in">  out$group.size.sc &lt;- scale(out$group.size, center = TRUE, scale = FALSE) </span></span>
<span id="cb132-2966"><a href="#cb132-2966" aria-hidden="true" tabindex="-1"></a><span class="in">  out$type &lt;- gsub("Regular", "Natural", out$type)</span></span>
<span id="cb132-2967"><a href="#cb132-2967" aria-hidden="true" tabindex="-1"></a><span class="in">  out$type &lt;- factor(out$type, levels = c("Natural", "Artificial", "Simulated"))</span></span>
<span id="cb132-2968"><a href="#cb132-2968" aria-hidden="true" tabindex="-1"></a><span class="in">  return(out)</span></span>
<span id="cb132-2969"><a href="#cb132-2969" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-2970"><a href="#cb132-2970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2971"><a href="#cb132-2971" aria-hidden="true" tabindex="-1"></a><span class="in">group_call_mod &lt;- brm_multiple(</span></span>
<span id="cb132-2972"><a href="#cb132-2972" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = ovlp.count ~ type + group.size + offset(log(flight.time)),</span></span>
<span id="cb132-2973"><a href="#cb132-2973" aria-hidden="true" tabindex="-1"></a><span class="in">  iter = iter,</span></span>
<span id="cb132-2974"><a href="#cb132-2974" aria-hidden="true" tabindex="-1"></a><span class="in">  thin = 1,</span></span>
<span id="cb132-2975"><a href="#cb132-2975" aria-hidden="true" tabindex="-1"></a><span class="in">  data = sim_call_groups_list,</span></span>
<span id="cb132-2976"><a href="#cb132-2976" aria-hidden="true" tabindex="-1"></a><span class="in">  family = zero_inflated_poisson(link = "log"),</span></span>
<span id="cb132-2977"><a href="#cb132-2977" aria-hidden="true" tabindex="-1"></a><span class="in">  silent = 2,</span></span>
<span id="cb132-2978"><a href="#cb132-2978" aria-hidden="true" tabindex="-1"></a><span class="in">  chains = chains,</span></span>
<span id="cb132-2979"><a href="#cb132-2979" aria-hidden="true" tabindex="-1"></a><span class="in">  backend = "cmdstanr",</span></span>
<span id="cb132-2980"><a href="#cb132-2980" aria-hidden="true" tabindex="-1"></a><span class="in">  # only works if cmdstanr package is installed</span></span>
<span id="cb132-2981"><a href="#cb132-2981" aria-hidden="true" tabindex="-1"></a><span class="in">  threads = threading(2),</span></span>
<span id="cb132-2982"><a href="#cb132-2982" aria-hidden="true" tabindex="-1"></a><span class="in">  cores = chains,</span></span>
<span id="cb132-2983"><a href="#cb132-2983" aria-hidden="true" tabindex="-1"></a><span class="in">  combine = FALSE,</span></span>
<span id="cb132-2984"><a href="#cb132-2984" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(adapt_delta = 0.99, max_treedepth = 15)</span></span>
<span id="cb132-2985"><a href="#cb132-2985" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-2986"><a href="#cb132-2986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2987"><a href="#cb132-2987" aria-hidden="true" tabindex="-1"></a><span class="in">custom_ppc(fit = group_call_mod[[1]], group = "type")</span></span>
<span id="cb132-2988"><a href="#cb132-2988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2989"><a href="#cb132-2989" aria-hidden="true" tabindex="-1"></a><span class="in">group_call_mod &lt;- pblapply(group_call_mod,  function(x) add_criterion(x, criterion = c("loo")))</span></span>
<span id="cb132-2990"><a href="#cb132-2990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2991"><a href="#cb132-2991" aria-hidden="true" tabindex="-1"></a><span class="in">saveRDS(group_call_mod,</span></span>
<span id="cb132-2992"><a href="#cb132-2992" aria-hidden="true" tabindex="-1"></a><span class="in">        "./data/processed/simulated_group_call_model.RDS")</span></span>
<span id="cb132-2993"><a href="#cb132-2993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2994"><a href="#cb132-2994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-2995"><a href="#cb132-2995" aria-hidden="true" tabindex="-1"></a><span class="in">null_group_call_mod &lt;- brm_multiple(</span></span>
<span id="cb132-2996"><a href="#cb132-2996" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = ovlp.count ~ 1 + group.size + offset(log(flight.time)),</span></span>
<span id="cb132-2997"><a href="#cb132-2997" aria-hidden="true" tabindex="-1"></a><span class="in">  iter = iter,</span></span>
<span id="cb132-2998"><a href="#cb132-2998" aria-hidden="true" tabindex="-1"></a><span class="in">  thin = 1,</span></span>
<span id="cb132-2999"><a href="#cb132-2999" aria-hidden="true" tabindex="-1"></a><span class="in">  data = sim_call_groups_list,</span></span>
<span id="cb132-3000"><a href="#cb132-3000" aria-hidden="true" tabindex="-1"></a><span class="in">  family = zero_inflated_poisson(link = "log"),</span></span>
<span id="cb132-3001"><a href="#cb132-3001" aria-hidden="true" tabindex="-1"></a><span class="in">  silent = 2,</span></span>
<span id="cb132-3002"><a href="#cb132-3002" aria-hidden="true" tabindex="-1"></a><span class="in">  chains = chains,</span></span>
<span id="cb132-3003"><a href="#cb132-3003" aria-hidden="true" tabindex="-1"></a><span class="in">  backend = "cmdstanr",</span></span>
<span id="cb132-3004"><a href="#cb132-3004" aria-hidden="true" tabindex="-1"></a><span class="in">  # only works if cmdstanr package is installed</span></span>
<span id="cb132-3005"><a href="#cb132-3005" aria-hidden="true" tabindex="-1"></a><span class="in">  threads = threading(2),</span></span>
<span id="cb132-3006"><a href="#cb132-3006" aria-hidden="true" tabindex="-1"></a><span class="in">  cores = chains,</span></span>
<span id="cb132-3007"><a href="#cb132-3007" aria-hidden="true" tabindex="-1"></a><span class="in">  combine = FALSE,</span></span>
<span id="cb132-3008"><a href="#cb132-3008" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(adapt_delta = 0.99, max_treedepth = 15)</span></span>
<span id="cb132-3009"><a href="#cb132-3009" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-3010"><a href="#cb132-3010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3011"><a href="#cb132-3011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3012"><a href="#cb132-3012" aria-hidden="true" tabindex="-1"></a><span class="in">custom_ppc(fit = null_group_call_mod[[1]], group = "type")</span></span>
<span id="cb132-3013"><a href="#cb132-3013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3014"><a href="#cb132-3014" aria-hidden="true" tabindex="-1"></a><span class="in">null_group_call_mod &lt;- pblapply(null_group_call_mod,  function(x) {</span></span>
<span id="cb132-3015"><a href="#cb132-3015" aria-hidden="true" tabindex="-1"></a><span class="in">  out &lt;- try(add_criterion(x, criterion = c("loo")), silent = TRUE)</span></span>
<span id="cb132-3016"><a href="#cb132-3016" aria-hidden="true" tabindex="-1"></a><span class="in">  if (is(out, "try-error")) return(x)</span></span>
<span id="cb132-3017"><a href="#cb132-3017" aria-hidden="true" tabindex="-1"></a><span class="in">  else return(out)</span></span>
<span id="cb132-3018"><a href="#cb132-3018" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb132-3019"><a href="#cb132-3019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3020"><a href="#cb132-3020" aria-hidden="true" tabindex="-1"></a><span class="in">loo_compare(group_call_mod[[1]], null_group_call_mod[[1]])</span></span>
<span id="cb132-3021"><a href="#cb132-3021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3022"><a href="#cb132-3022" aria-hidden="true" tabindex="-1"></a><span class="in">saveRDS(null_group_call_mod,</span></span>
<span id="cb132-3023"><a href="#cb132-3023" aria-hidden="true" tabindex="-1"></a><span class="in">        "./data/processed/simulated_group_call_null_model.RDS")</span></span>
<span id="cb132-3024"><a href="#cb132-3024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3025"><a href="#cb132-3025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3026"><a href="#cb132-3026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3027"><a href="#cb132-3027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3028"><a href="#cb132-3028" aria-hidden="true" tabindex="-1"></a><span class="fu">### Results</span></span>
<span id="cb132-3029"><a href="#cb132-3029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3030"><a href="#cb132-3030" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model performance vs null model </span></span>
<span id="cb132-3031"><a href="#cb132-3031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3032"><a href="#cb132-3032" aria-hidden="true" tabindex="-1"></a><span class="in">```{r regression results model comparison group call simulation, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-3033"><a href="#cb132-3033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3034"><a href="#cb132-3034" aria-hidden="true" tabindex="-1"></a><span class="in">group_call_mod &lt;-</span></span>
<span id="cb132-3035"><a href="#cb132-3035" aria-hidden="true" tabindex="-1"></a><span class="in">  readRDS("./data/processed/simulated_group_call_model.RDS")</span></span>
<span id="cb132-3036"><a href="#cb132-3036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3037"><a href="#cb132-3037" aria-hidden="true" tabindex="-1"></a><span class="in">null_group_call_mod &lt;-</span></span>
<span id="cb132-3038"><a href="#cb132-3038" aria-hidden="true" tabindex="-1"></a><span class="in">  readRDS("./data/processed/simulated_group_call_null_model.RDS")</span></span>
<span id="cb132-3039"><a href="#cb132-3039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3040"><a href="#cb132-3040" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diffs &lt;- </span></span>
<span id="cb132-3041"><a href="#cb132-3041" aria-hidden="true" tabindex="-1"></a><span class="in">lapply(seq_along(group_call_mod), function(x)</span></span>
<span id="cb132-3042"><a href="#cb132-3042" aria-hidden="true" tabindex="-1"></a><span class="in">  loo::loo_compare(group_call_mod[[x]], null_group_call_mod[[x]])</span></span>
<span id="cb132-3043"><a href="#cb132-3043" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-3044"><a href="#cb132-3044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3045"><a href="#cb132-3045" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff &lt;- do.call(rbind, loo_diffs)</span></span>
<span id="cb132-3046"><a href="#cb132-3046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3047"><a href="#cb132-3047" aria-hidden="true" tabindex="-1"></a><span class="in">rows &lt;- rownames(loo_diff)</span></span>
<span id="cb132-3048"><a href="#cb132-3048" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff &lt;- as.data.frame(loo_diff)</span></span>
<span id="cb132-3049"><a href="#cb132-3049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3050"><a href="#cb132-3050" aria-hidden="true" tabindex="-1"></a><span class="in">loo_diff$model &lt;- rows</span></span>
<span id="cb132-3051"><a href="#cb132-3051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3052"><a href="#cb132-3052" aria-hidden="true" tabindex="-1"></a><span class="in">aggregate(cbind(elpd_diff, se_diff) ~ model, loo_diff, mean)</span></span>
<span id="cb132-3053"><a href="#cb132-3053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3054"><a href="#cb132-3054" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3055"><a href="#cb132-3055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3056"><a href="#cb132-3056" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model fit</span></span>
<span id="cb132-3057"><a href="#cb132-3057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3058"><a href="#cb132-3058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r regression results group call simulation, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-3059"><a href="#cb132-3059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3060"><a href="#cb132-3060" aria-hidden="true" tabindex="-1"></a><span class="in"># average model</span></span>
<span id="cb132-3061"><a href="#cb132-3061" aria-hidden="true" tabindex="-1"></a><span class="in">avrg_call &lt;-</span></span>
<span id="cb132-3062"><a href="#cb132-3062" aria-hidden="true" tabindex="-1"></a><span class="in">  paste0("posterior_average(",</span></span>
<span id="cb132-3063"><a href="#cb132-3063" aria-hidden="true" tabindex="-1"></a><span class="in">         paste0(paste0("group_call_mod[[", 1:length(group_call_mod), "]]"), collapse = ", "),</span></span>
<span id="cb132-3064"><a href="#cb132-3064" aria-hidden="true" tabindex="-1"></a><span class="in">         ", weights = 'loo')")</span></span>
<span id="cb132-3065"><a href="#cb132-3065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3066"><a href="#cb132-3066" aria-hidden="true" tabindex="-1"></a><span class="in">average_model_draws &lt;- eval(parse(text = avrg_call))</span></span>
<span id="cb132-3067"><a href="#cb132-3067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3068"><a href="#cb132-3068" aria-hidden="true" tabindex="-1"></a><span class="in">draw_extended_summary(average_model_draws,</span></span>
<span id="cb132-3069"><a href="#cb132-3069" aria-hidden="true" tabindex="-1"></a><span class="in">                      highlight = TRUE,</span></span>
<span id="cb132-3070"><a href="#cb132-3070" aria-hidden="true" tabindex="-1"></a><span class="in">                      fill = fill_color,</span></span>
<span id="cb132-3071"><a href="#cb132-3071" aria-hidden="true" tabindex="-1"></a><span class="in">                      beta.prefix = c("^b_", "^bsp_mo"))</span></span>
<span id="cb132-3072"><a href="#cb132-3072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3073"><a href="#cb132-3073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3074"><a href="#cb132-3074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3075"><a href="#cb132-3075" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Contrasts</span></span>
<span id="cb132-3076"><a href="#cb132-3076" aria-hidden="true" tabindex="-1"></a><span class="in">```{r regresion contrasts group call simulation, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-3077"><a href="#cb132-3077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3078"><a href="#cb132-3078" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts &lt;-</span></span>
<span id="cb132-3079"><a href="#cb132-3079" aria-hidden="true" tabindex="-1"></a><span class="in">  draws_contrasts(</span></span>
<span id="cb132-3080"><a href="#cb132-3080" aria-hidden="true" tabindex="-1"></a><span class="in">    average_model_draws,</span></span>
<span id="cb132-3081"><a href="#cb132-3081" aria-hidden="true" tabindex="-1"></a><span class="in">    predictor_name = "type",</span></span>
<span id="cb132-3082"><a href="#cb132-3082" aria-hidden="true" tabindex="-1"></a><span class="in">    basal_level = "Natural",</span></span>
<span id="cb132-3083"><a href="#cb132-3083" aria-hidden="true" tabindex="-1"></a><span class="in">    fill_color = fill_color</span></span>
<span id="cb132-3084"><a href="#cb132-3084" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb132-3085"><a href="#cb132-3085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3086"><a href="#cb132-3086" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts$contrasts</span></span>
<span id="cb132-3087"><a href="#cb132-3087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3088"><a href="#cb132-3088" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts$plot + theme_classic()</span></span>
<span id="cb132-3089"><a href="#cb132-3089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3090"><a href="#cb132-3090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3091"><a href="#cb132-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3092"><a href="#cb132-3092" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Posterior predictive checks</span></span>
<span id="cb132-3095"><a href="#cb132-3095" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-3096"><a href="#cb132-3096" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> group_call_mod[[<span class="dv">1</span>]], <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb132-3097"><a href="#cb132-3097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3098"><a href="#cb132-3098" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3099"><a href="#cb132-3099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3100"><a href="#cb132-3100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3101"><a href="#cb132-3101" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-3102"><a href="#cb132-3102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3103"><a href="#cb132-3103" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb132-3104"><a href="#cb132-3104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3105"><a href="#cb132-3105" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Simulated groups produce more overlapping calls than both artificial and natural groups</span>
<span id="cb132-3106"><a href="#cb132-3106" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Artificial groups produce more overlapping calls than natural groups</span>
<span id="cb132-3107"><a href="#cb132-3107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3108"><a href="#cb132-3108" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-3109"><a href="#cb132-3109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3110"><a href="#cb132-3110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3111"><a href="#cb132-3111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gap duration</span></span>
<span id="cb132-3112"><a href="#cb132-3112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3113"><a href="#cb132-3113" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gap variation of individual in solo flight vs overall group flight</span></span>
<span id="cb132-3114"><a href="#cb132-3114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3115"><a href="#cb132-3115" aria-hidden="true" tabindex="-1"></a>Variation measured as the coefficient of variation of gap duration</span>
<span id="cb132-3116"><a href="#cb132-3116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gaps per group solo vs group lines plot 2, eval = TRUE, echo = TRUE, warning = FALSE, fig.width = 12, fig.height = 8}</span></span>
<span id="cb132-3117"><a href="#cb132-3117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3118"><a href="#cb132-3118" aria-hidden="true" tabindex="-1"></a><span class="in">gaps_indiv &lt;- readRDS("./data/processed/gaps_by_individual.RDS")</span></span>
<span id="cb132-3119"><a href="#cb132-3119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3120"><a href="#cb132-3120" aria-hidden="true" tabindex="-1"></a><span class="in"># remove those in which only one individual called</span></span>
<span id="cb132-3121"><a href="#cb132-3121" aria-hidden="true" tabindex="-1"></a><span class="in">call_id_seq &lt;- read.csv("./data/processed/group_call_individual_id_sequence.csv")</span></span>
<span id="cb132-3122"><a href="#cb132-3122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3123"><a href="#cb132-3123" aria-hidden="true" tabindex="-1"></a><span class="in">call_id_seq &lt;- call_id_seq[order(call_id_seq$event, call_id_seq$start), ]</span></span>
<span id="cb132-3124"><a href="#cb132-3124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3125"><a href="#cb132-3125" aria-hidden="true" tabindex="-1"></a><span class="in">call_id_seq_list &lt;- split(call_id_seq, call_id_seq$event)</span></span>
<span id="cb132-3126"><a href="#cb132-3126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3127"><a href="#cb132-3127" aria-hidden="true" tabindex="-1"></a><span class="in">unique_callers_list &lt;- pblapply(call_id_seq_list, function(x){</span></span>
<span id="cb132-3128"><a href="#cb132-3128" aria-hidden="true" tabindex="-1"></a><span class="in">  x &lt;- x[order(x$start), ]</span></span>
<span id="cb132-3129"><a href="#cb132-3129" aria-hidden="true" tabindex="-1"></a><span class="in">  id_seq &lt;- x$indiv</span></span>
<span id="cb132-3130"><a href="#cb132-3130" aria-hidden="true" tabindex="-1"></a><span class="in">  id_seq &lt;- as.character(as.numeric(factor(id_seq)))</span></span>
<span id="cb132-3131"><a href="#cb132-3131" aria-hidden="true" tabindex="-1"></a><span class="in">  unique.callers &lt;- length(unique(id_seq))</span></span>
<span id="cb132-3132"><a href="#cb132-3132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3133"><a href="#cb132-3133" aria-hidden="true" tabindex="-1"></a><span class="in">  out &lt;- data.frame(group = x$group[1], unique.callers = unique.callers)</span></span>
<span id="cb132-3134"><a href="#cb132-3134" aria-hidden="true" tabindex="-1"></a><span class="in">  return(out)</span></span>
<span id="cb132-3135"><a href="#cb132-3135" aria-hidden="true" tabindex="-1"></a><span class="in"> }</span></span>
<span id="cb132-3136"><a href="#cb132-3136" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-3137"><a href="#cb132-3137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3138"><a href="#cb132-3138" aria-hidden="true" tabindex="-1"></a><span class="in">unique_callers_df &lt;- do_call(rbind, unique_callers_list)</span></span>
<span id="cb132-3139"><a href="#cb132-3139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3140"><a href="#cb132-3140" aria-hidden="true" tabindex="-1"></a><span class="in">gaps_indiv &lt;- gaps_indiv[!gaps_indiv$group %in% unique_callers_df$group[unique_callers_df$unique.callers == 1], ]</span></span>
<span id="cb132-3141"><a href="#cb132-3141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3142"><a href="#cb132-3142" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv &lt;- gaps_indiv[grep("indiv.group", gaps_indiv$experiment.type, invert = TRUE), ]</span></span>
<span id="cb132-3143"><a href="#cb132-3143" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$experiment.type[sub_gaps_indiv$experiment.type == "mixed-overall.group"] &lt;- "artificial.group"</span></span>
<span id="cb132-3144"><a href="#cb132-3144" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$experiment.type[sub_gaps_indiv$experiment.type == "regular-overall.group"] &lt;- "real.group"</span></span>
<span id="cb132-3145"><a href="#cb132-3145" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$type &lt;- sub_gaps_indiv$experiment.type</span></span>
<span id="cb132-3146"><a href="#cb132-3146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3147"><a href="#cb132-3147" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$type &lt;- factor(sub_gaps_indiv$type, levels = c("solo", "real.group", "artificial.group")) </span></span>
<span id="cb132-3148"><a href="#cb132-3148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3149"><a href="#cb132-3149" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$group.size.f &lt;- factor(sub_gaps_indiv$group.size, levels = unique(sub_gaps_indiv$group.size), ordered = TRUE)</span></span>
<span id="cb132-3150"><a href="#cb132-3150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3151"><a href="#cb132-3151" aria-hidden="true" tabindex="-1"></a><span class="in">cv_gaps_groups &lt;- aggregate(gaps ~ experiment.type + group.size + group, data = sub_gaps_indiv, FUN = cv)</span></span>
<span id="cb132-3152"><a href="#cb132-3152" aria-hidden="true" tabindex="-1"></a><span class="in">cv_gaps_groups$indiv &lt;- "group"</span></span>
<span id="cb132-3153"><a href="#cb132-3153" aria-hidden="true" tabindex="-1"></a><span class="in">cv_gaps_groups &lt;- cv_gaps_groups[cv_gaps_groups$experiment.type != "solo", ]</span></span>
<span id="cb132-3154"><a href="#cb132-3154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3155"><a href="#cb132-3155" aria-hidden="true" tabindex="-1"></a><span class="in">cv_gaps_indiv &lt;- aggregate(gaps ~ indiv + experiment.type + group.size + group, data = sub_gaps_indiv, FUN = cv)</span></span>
<span id="cb132-3156"><a href="#cb132-3156" aria-hidden="true" tabindex="-1"></a><span class="in">cv_gaps_indiv &lt;- cv_gaps_indiv[cv_gaps_indiv$experiment.type == "solo", ]</span></span>
<span id="cb132-3157"><a href="#cb132-3157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3158"><a href="#cb132-3158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3159"><a href="#cb132-3159" aria-hidden="true" tabindex="-1"></a><span class="in"># duplicate individuals in artificial group flights</span></span>
<span id="cb132-3160"><a href="#cb132-3160" aria-hidden="true" tabindex="-1"></a><span class="in">dup_indivs &lt;- lapply(unique(cv_gaps_groups$group), function(x){</span></span>
<span id="cb132-3161"><a href="#cb132-3161" aria-hidden="true" tabindex="-1"></a><span class="in">  ids &lt;- unique(gaps_indiv$indiv[gaps_indiv$group == x])</span></span>
<span id="cb132-3162"><a href="#cb132-3162" aria-hidden="true" tabindex="-1"></a><span class="in">  ids &lt;- ids[ids != "group"]</span></span>
<span id="cb132-3163"><a href="#cb132-3163" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-3164"><a href="#cb132-3164" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- cv_gaps_indiv[cv_gaps_indiv$indiv %in% ids, ]</span></span>
<span id="cb132-3165"><a href="#cb132-3165" aria-hidden="true" tabindex="-1"></a><span class="in">  X$group &lt;- x</span></span>
<span id="cb132-3166"><a href="#cb132-3166" aria-hidden="true" tabindex="-1"></a><span class="in">  X$group.size &lt;- gaps_indiv$group.size[gaps_indiv$group == x][1]</span></span>
<span id="cb132-3167"><a href="#cb132-3167" aria-hidden="true" tabindex="-1"></a><span class="in">  return(X)</span></span>
<span id="cb132-3168"><a href="#cb132-3168" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb132-3169"><a href="#cb132-3169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3170"><a href="#cb132-3170" aria-hidden="true" tabindex="-1"></a><span class="in">dup_indivs &lt;- do.call(rbind, dup_indivs)</span></span>
<span id="cb132-3171"><a href="#cb132-3171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3172"><a href="#cb132-3172" aria-hidden="true" tabindex="-1"></a><span class="in">cv_gaps &lt;- rbind(dup_indivs, cv_gaps_groups)</span></span>
<span id="cb132-3173"><a href="#cb132-3173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3174"><a href="#cb132-3174" aria-hidden="true" tabindex="-1"></a><span class="in">names(cv_gaps)[ncol(cv_gaps)] &lt;- "cv.gaps"</span></span>
<span id="cb132-3175"><a href="#cb132-3175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3176"><a href="#cb132-3176" aria-hidden="true" tabindex="-1"></a><span class="in">cv_gaps$group.size.f &lt;- factor(cv_gaps$group.size, levels = unique(cv_gaps$group.size), ordered = TRUE)</span></span>
<span id="cb132-3177"><a href="#cb132-3177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3178"><a href="#cb132-3178" aria-hidden="true" tabindex="-1"></a><span class="in">names(cv_gaps)[2] &lt;- "type"</span></span>
<span id="cb132-3179"><a href="#cb132-3179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3180"><a href="#cb132-3180" aria-hidden="true" tabindex="-1"></a><span class="in">cv_gaps$type &lt;- factor(cv_gaps$type, levels  = c("solo", "real.group", "artificial.group"))</span></span>
<span id="cb132-3181"><a href="#cb132-3181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3182"><a href="#cb132-3182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3183"><a href="#cb132-3183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3184"><a href="#cb132-3184" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot raw data</span></span>
<span id="cb132-3185"><a href="#cb132-3185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3186"><a href="#cb132-3186" aria-hidden="true" tabindex="-1"></a>All group sizes combined:</span>
<span id="cb132-3187"><a href="#cb132-3187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-3188"><a href="#cb132-3188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3189"><a href="#cb132-3189" aria-hidden="true" tabindex="-1"></a><span class="in">custom_labels &lt;- unique(sub_gaps_indiv$group.size.f)</span></span>
<span id="cb132-3190"><a href="#cb132-3190" aria-hidden="true" tabindex="-1"></a><span class="in">custom_labels &lt;- paste("group size = ", custom_labels)</span></span>
<span id="cb132-3191"><a href="#cb132-3191" aria-hidden="true" tabindex="-1"></a><span class="in">names(custom_labels) &lt;- unique(sub_gaps_indiv$group.size.f)</span></span>
<span id="cb132-3192"><a href="#cb132-3192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3193"><a href="#cb132-3193" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-3194"><a href="#cb132-3194" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(cv_gaps, </span></span>
<span id="cb132-3195"><a href="#cb132-3195" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(y = log(cv.gaps + 1), </span></span>
<span id="cb132-3196"><a href="#cb132-3196" aria-hidden="true" tabindex="-1"></a><span class="in">           x = type,</span></span>
<span id="cb132-3197"><a href="#cb132-3197" aria-hidden="true" tabindex="-1"></a><span class="in">         color = type,</span></span>
<span id="cb132-3198"><a href="#cb132-3198" aria-hidden="true" tabindex="-1"></a><span class="in">         fill = type</span></span>
<span id="cb132-3199"><a href="#cb132-3199" aria-hidden="true" tabindex="-1"></a><span class="in">       )) +</span></span>
<span id="cb132-3200"><a href="#cb132-3200" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-3201"><a href="#cb132-3201" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-3202"><a href="#cb132-3202" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-3203"><a href="#cb132-3203" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-3204"><a href="#cb132-3204" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-3205"><a href="#cb132-3205" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-3206"><a href="#cb132-3206" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-3207"><a href="#cb132-3207" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-3208"><a href="#cb132-3208" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-3209"><a href="#cb132-3209" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-3210"><a href="#cb132-3210" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-3211"><a href="#cb132-3211" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-3212"><a href="#cb132-3212" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-3213"><a href="#cb132-3213" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-3214"><a href="#cb132-3214" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-3215"><a href="#cb132-3215" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-3216"><a href="#cb132-3216" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-3217"><a href="#cb132-3217" aria-hidden="true" tabindex="-1"></a><span class="in">    # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-3218"><a href="#cb132-3218" aria-hidden="true" tabindex="-1"></a><span class="in">    gghalves::geom_half_point(</span></span>
<span id="cb132-3219"><a href="#cb132-3219" aria-hidden="true" tabindex="-1"></a><span class="in">      # color = fill_color,</span></span>
<span id="cb132-3220"><a href="#cb132-3220" aria-hidden="true" tabindex="-1"></a><span class="in">      # draw jitter on the left</span></span>
<span id="cb132-3221"><a href="#cb132-3221" aria-hidden="true" tabindex="-1"></a><span class="in">      side = "l",</span></span>
<span id="cb132-3222"><a href="#cb132-3222" aria-hidden="true" tabindex="-1"></a><span class="in">      # control range of jitter</span></span>
<span id="cb132-3223"><a href="#cb132-3223" aria-hidden="true" tabindex="-1"></a><span class="in">      range_scale = .4,</span></span>
<span id="cb132-3224"><a href="#cb132-3224" aria-hidden="true" tabindex="-1"></a><span class="in">      # add some transparency</span></span>
<span id="cb132-3225"><a href="#cb132-3225" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = .5,</span></span>
<span id="cb132-3226"><a href="#cb132-3226" aria-hidden="true" tabindex="-1"></a><span class="in">      transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-3227"><a href="#cb132-3227" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb132-3228"><a href="#cb132-3228" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-3229"><a href="#cb132-3229" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-3230"><a href="#cb132-3230" aria-hidden="true" tabindex="-1"></a><span class="in">                           end = 0.8,</span></span>
<span id="cb132-3231"><a href="#cb132-3231" aria-hidden="true" tabindex="-1"></a><span class="in">                           alpha = 0.6) +</span></span>
<span id="cb132-3232"><a href="#cb132-3232" aria-hidden="true" tabindex="-1"></a><span class="in">      # ylim(c(-0.1, 60)) +</span></span>
<span id="cb132-3233"><a href="#cb132-3233" aria-hidden="true" tabindex="-1"></a><span class="in">           scale_x_discrete(labels = c(</span></span>
<span id="cb132-3234"><a href="#cb132-3234" aria-hidden="true" tabindex="-1"></a><span class="in">        "solo" = "Solo",</span></span>
<span id="cb132-3235"><a href="#cb132-3235" aria-hidden="true" tabindex="-1"></a><span class="in">        "real.group" = "Natural group",</span></span>
<span id="cb132-3236"><a href="#cb132-3236" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial.group" = "Artificial group"</span></span>
<span id="cb132-3237"><a href="#cb132-3237" aria-hidden="true" tabindex="-1"></a><span class="in">      )) +</span></span>
<span id="cb132-3238"><a href="#cb132-3238" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "none") +</span></span>
<span id="cb132-3239"><a href="#cb132-3239" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Flight type", y = "log(coefficient of variation\nof gap duration)")</span></span>
<span id="cb132-3240"><a href="#cb132-3240" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-3241"><a href="#cb132-3241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3242"><a href="#cb132-3242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3243"><a href="#cb132-3243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3244"><a href="#cb132-3244" aria-hidden="true" tabindex="-1"></a>By group size:</span>
<span id="cb132-3245"><a href="#cb132-3245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-3246"><a href="#cb132-3246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3247"><a href="#cb132-3247" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-3248"><a href="#cb132-3248" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(cv_gaps, </span></span>
<span id="cb132-3249"><a href="#cb132-3249" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(y = log(cv.gaps + 1), </span></span>
<span id="cb132-3250"><a href="#cb132-3250" aria-hidden="true" tabindex="-1"></a><span class="in">           x = type,</span></span>
<span id="cb132-3251"><a href="#cb132-3251" aria-hidden="true" tabindex="-1"></a><span class="in">         color = type,</span></span>
<span id="cb132-3252"><a href="#cb132-3252" aria-hidden="true" tabindex="-1"></a><span class="in">         fill = type</span></span>
<span id="cb132-3253"><a href="#cb132-3253" aria-hidden="true" tabindex="-1"></a><span class="in">       )) +</span></span>
<span id="cb132-3254"><a href="#cb132-3254" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-3255"><a href="#cb132-3255" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-3256"><a href="#cb132-3256" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-3257"><a href="#cb132-3257" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-3258"><a href="#cb132-3258" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-3259"><a href="#cb132-3259" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-3260"><a href="#cb132-3260" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-3261"><a href="#cb132-3261" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-3262"><a href="#cb132-3262" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-3263"><a href="#cb132-3263" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-3264"><a href="#cb132-3264" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-3265"><a href="#cb132-3265" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-3266"><a href="#cb132-3266" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-3267"><a href="#cb132-3267" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-3268"><a href="#cb132-3268" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-3269"><a href="#cb132-3269" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-3270"><a href="#cb132-3270" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-3271"><a href="#cb132-3271" aria-hidden="true" tabindex="-1"></a><span class="in">    # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-3272"><a href="#cb132-3272" aria-hidden="true" tabindex="-1"></a><span class="in">    gghalves::geom_half_point(</span></span>
<span id="cb132-3273"><a href="#cb132-3273" aria-hidden="true" tabindex="-1"></a><span class="in">      # color = fill_color,</span></span>
<span id="cb132-3274"><a href="#cb132-3274" aria-hidden="true" tabindex="-1"></a><span class="in">      # draw jitter on the left</span></span>
<span id="cb132-3275"><a href="#cb132-3275" aria-hidden="true" tabindex="-1"></a><span class="in">      side = "l",</span></span>
<span id="cb132-3276"><a href="#cb132-3276" aria-hidden="true" tabindex="-1"></a><span class="in">      # control range of jitter</span></span>
<span id="cb132-3277"><a href="#cb132-3277" aria-hidden="true" tabindex="-1"></a><span class="in">      range_scale = .4,</span></span>
<span id="cb132-3278"><a href="#cb132-3278" aria-hidden="true" tabindex="-1"></a><span class="in">      # add some transparency</span></span>
<span id="cb132-3279"><a href="#cb132-3279" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = .5,</span></span>
<span id="cb132-3280"><a href="#cb132-3280" aria-hidden="true" tabindex="-1"></a><span class="in">      transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-3281"><a href="#cb132-3281" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb132-3282"><a href="#cb132-3282" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-3283"><a href="#cb132-3283" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-3284"><a href="#cb132-3284" aria-hidden="true" tabindex="-1"></a><span class="in">                           end = 0.8,</span></span>
<span id="cb132-3285"><a href="#cb132-3285" aria-hidden="true" tabindex="-1"></a><span class="in">                           alpha = 0.6) +</span></span>
<span id="cb132-3286"><a href="#cb132-3286" aria-hidden="true" tabindex="-1"></a><span class="in">      # ylim(c(-0.1, 60)) +</span></span>
<span id="cb132-3287"><a href="#cb132-3287" aria-hidden="true" tabindex="-1"></a><span class="in">           scale_x_discrete(labels = c(</span></span>
<span id="cb132-3288"><a href="#cb132-3288" aria-hidden="true" tabindex="-1"></a><span class="in">        "solo" = "Solo",</span></span>
<span id="cb132-3289"><a href="#cb132-3289" aria-hidden="true" tabindex="-1"></a><span class="in">        "real.group" = "Natural group",</span></span>
<span id="cb132-3290"><a href="#cb132-3290" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial.group" = "Artificial group"</span></span>
<span id="cb132-3291"><a href="#cb132-3291" aria-hidden="true" tabindex="-1"></a><span class="in">      )) +</span></span>
<span id="cb132-3292"><a href="#cb132-3292" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "none") +</span></span>
<span id="cb132-3293"><a href="#cb132-3293" aria-hidden="true" tabindex="-1"></a><span class="in">         labs(x = "Flight type", y = "log(coefficient of variation\nof gap duration)") +</span></span>
<span id="cb132-3294"><a href="#cb132-3294" aria-hidden="true" tabindex="-1"></a><span class="in">   facet_wrap(</span></span>
<span id="cb132-3295"><a href="#cb132-3295" aria-hidden="true" tabindex="-1"></a><span class="in">        ~ group.size,</span></span>
<span id="cb132-3296"><a href="#cb132-3296" aria-hidden="true" tabindex="-1"></a><span class="in">        ncol = 2,</span></span>
<span id="cb132-3297"><a href="#cb132-3297" aria-hidden="true" tabindex="-1"></a><span class="in">        labeller = labeller(group.size = custom_labels)</span></span>
<span id="cb132-3298"><a href="#cb132-3298" aria-hidden="true" tabindex="-1"></a><span class="in">      ) </span></span>
<span id="cb132-3299"><a href="#cb132-3299" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-3300"><a href="#cb132-3300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3301"><a href="#cb132-3301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3302"><a href="#cb132-3302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3303"><a href="#cb132-3303" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Regression model</span></span>
<span id="cb132-3304"><a href="#cb132-3304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3305"><a href="#cb132-3305" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-3306"><a href="#cb132-3306" aria-hidden="true" tabindex="-1"></a>\text{log(gap variation + 1)} \sim \text{type} + \text{monotonic(group size)} + (1 \mid \text{group})</span>
<span id="cb132-3307"><a href="#cb132-3307" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-3308"><a href="#cb132-3308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3309"><a href="#cb132-3309" aria-hidden="true" tabindex="-1"></a>Response modeled with an normal distribution.</span>
<span id="cb132-3310"><a href="#cb132-3310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gaps per group solo vs group stats 2, eval = FALSE}</span></span>
<span id="cb132-3311"><a href="#cb132-3311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3312"><a href="#cb132-3312" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- brm(</span></span>
<span id="cb132-3313"><a href="#cb132-3313" aria-hidden="true" tabindex="-1"></a><span class="in">          formula =  log(cv.gaps + 1) ~ type + mo(group.size.f) + (1 | group),</span></span>
<span id="cb132-3314"><a href="#cb132-3314" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-3315"><a href="#cb132-3315" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-3316"><a href="#cb132-3316" aria-hidden="true" tabindex="-1"></a><span class="in">          data = cv_gaps,</span></span>
<span id="cb132-3317"><a href="#cb132-3317" aria-hidden="true" tabindex="-1"></a><span class="in">          family = gaussian(),</span></span>
<span id="cb132-3318"><a href="#cb132-3318" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-3319"><a href="#cb132-3319" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-3320"><a href="#cb132-3320" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-3321"><a href="#cb132-3321" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/cv_gaps_solo_vs_group",</span></span>
<span id="cb132-3322"><a href="#cb132-3322" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always"</span></span>
<span id="cb132-3323"><a href="#cb132-3323" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb132-3324"><a href="#cb132-3324" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb132-3325"><a href="#cb132-3325" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- add_criterion(mod, criterion = "loo")  </span></span>
<span id="cb132-3326"><a href="#cb132-3326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3327"><a href="#cb132-3327" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;-brm(</span></span>
<span id="cb132-3328"><a href="#cb132-3328" aria-hidden="true" tabindex="-1"></a><span class="in">          formula =  log(cv.gaps + 1) ~ 1 + (1 | group),</span></span>
<span id="cb132-3329"><a href="#cb132-3329" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-3330"><a href="#cb132-3330" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-3331"><a href="#cb132-3331" aria-hidden="true" tabindex="-1"></a><span class="in">          data = cv_gaps,</span></span>
<span id="cb132-3332"><a href="#cb132-3332" aria-hidden="true" tabindex="-1"></a><span class="in">          family = gaussian(),</span></span>
<span id="cb132-3333"><a href="#cb132-3333" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-3334"><a href="#cb132-3334" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-3335"><a href="#cb132-3335" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-3336"><a href="#cb132-3336" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/null_cv_gaps_solo_vs_group",</span></span>
<span id="cb132-3337"><a href="#cb132-3337" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always"</span></span>
<span id="cb132-3338"><a href="#cb132-3338" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb132-3339"><a href="#cb132-3339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3340"><a href="#cb132-3340" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- add_criterion(null_mod, criterion = "loo")  </span></span>
<span id="cb132-3341"><a href="#cb132-3341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3342"><a href="#cb132-3342" aria-hidden="true" tabindex="-1"></a><span class="in">beepr::beep(2)</span></span>
<span id="cb132-3343"><a href="#cb132-3343" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3344"><a href="#cb132-3344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3345"><a href="#cb132-3345" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Results</span></span>
<span id="cb132-3346"><a href="#cb132-3346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3347"><a href="#cb132-3347" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Model performance vs null model </span></span>
<span id="cb132-3348"><a href="#cb132-3348" aria-hidden="true" tabindex="-1"></a><span class="in">```{r compare models group gaps solo vs group, eval = TRUE}</span></span>
<span id="cb132-3349"><a href="#cb132-3349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3350"><a href="#cb132-3350" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- readRDS("./data/processed/cv_gaps_solo_vs_group.rds")</span></span>
<span id="cb132-3351"><a href="#cb132-3351" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- readRDS("./data/processed/null_cv_gaps_solo_vs_group.rds")</span></span>
<span id="cb132-3352"><a href="#cb132-3352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3353"><a href="#cb132-3353" aria-hidden="true" tabindex="-1"></a><span class="in">loo_compare(mod, null_mod)</span></span>
<span id="cb132-3354"><a href="#cb132-3354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3355"><a href="#cb132-3355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3356"><a href="#cb132-3356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3357"><a href="#cb132-3357" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Model fit</span></span>
<span id="cb132-3358"><a href="#cb132-3358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gaps per group solo vs group results 2, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-3359"><a href="#cb132-3359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3360"><a href="#cb132-3360" aria-hidden="true" tabindex="-1"></a><span class="in">extended_summary(</span></span>
<span id="cb132-3361"><a href="#cb132-3361" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-3362"><a href="#cb132-3362" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.pattern = "type",</span></span>
<span id="cb132-3363"><a href="#cb132-3363" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.replacement = "solo_vs_",</span></span>
<span id="cb132-3364"><a href="#cb132-3364" aria-hidden="true" tabindex="-1"></a><span class="in">  remove.intercepts = TRUE,</span></span>
<span id="cb132-3365"><a href="#cb132-3365" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-3366"><a href="#cb132-3366" aria-hidden="true" tabindex="-1"></a><span class="in">  print.name = FALSE,</span></span>
<span id="cb132-3367"><a href="#cb132-3367" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = fill_color,</span></span>
<span id="cb132-3368"><a href="#cb132-3368" aria-hidden="true" tabindex="-1"></a><span class="in">   trace.palette = viridis::mako,</span></span>
<span id="cb132-3369"><a href="#cb132-3369" aria-hidden="true" tabindex="-1"></a><span class="in">  beta.prefix = c("^b_", "^bsp_mo")</span></span>
<span id="cb132-3370"><a href="#cb132-3370" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-3371"><a href="#cb132-3371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3372"><a href="#cb132-3372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3373"><a href="#cb132-3373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3374"><a href="#cb132-3374" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Contrasts</span></span>
<span id="cb132-3375"><a href="#cb132-3375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gaps per group solo vs group results contrasts 2, eval = TRUE, results='asis'}</span></span>
<span id="cb132-3376"><a href="#cb132-3376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3377"><a href="#cb132-3377" aria-hidden="true" tabindex="-1"></a><span class="in"># contrasts</span></span>
<span id="cb132-3378"><a href="#cb132-3378" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts(</span></span>
<span id="cb132-3379"><a href="#cb132-3379" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-3380"><a href="#cb132-3380" aria-hidden="true" tabindex="-1"></a><span class="in">  predictor = "type",</span></span>
<span id="cb132-3381"><a href="#cb132-3381" aria-hidden="true" tabindex="-1"></a><span class="in">  n.posterior = 2000,</span></span>
<span id="cb132-3382"><a href="#cb132-3382" aria-hidden="true" tabindex="-1"></a><span class="in">  level.sep = " VS ",</span></span>
<span id="cb132-3383"><a href="#cb132-3383" aria-hidden="true" tabindex="-1"></a><span class="in">  html.table = TRUE,</span></span>
<span id="cb132-3384"><a href="#cb132-3384" aria-hidden="true" tabindex="-1"></a><span class="in">  plot = TRUE,</span></span>
<span id="cb132-3385"><a href="#cb132-3385" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-3386"><a href="#cb132-3386" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = fill_color</span></span>
<span id="cb132-3387"><a href="#cb132-3387" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-3388"><a href="#cb132-3388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3389"><a href="#cb132-3389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3390"><a href="#cb132-3390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3391"><a href="#cb132-3391" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Posterior predictive checks</span></span>
<span id="cb132-3394"><a href="#cb132-3394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-3395"><a href="#cb132-3395" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"experiment.type"</span>)</span>
<span id="cb132-3396"><a href="#cb132-3396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3397"><a href="#cb132-3397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3398"><a href="#cb132-3398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3399"><a href="#cb132-3399" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-3400"><a href="#cb132-3400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3401"><a href="#cb132-3401" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb132-3402"><a href="#cb132-3402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3403"><a href="#cb132-3403" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variation in gap duration is larger in both natural and artificial groups compared to solo flights</span>
<span id="cb132-3404"><a href="#cb132-3404" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No difference in gap variation between natural and artificial groups </span>
<span id="cb132-3405"><a href="#cb132-3405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3406"><a href="#cb132-3406" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-3407"><a href="#cb132-3407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3408"><a href="#cb132-3408" aria-hidden="true" tabindex="-1"></a><span class="fu">### Individual in solo flight vs individuals in group flight </span></span>
<span id="cb132-3409"><a href="#cb132-3409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3410"><a href="#cb132-3410" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Plot raw data</span></span>
<span id="cb132-3411"><a href="#cb132-3411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3412"><a href="#cb132-3412" aria-hidden="true" tabindex="-1"></a>All group sizes combined:</span>
<span id="cb132-3413"><a href="#cb132-3413" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-3414"><a href="#cb132-3414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3415"><a href="#cb132-3415" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv &lt;- gaps_indiv[grep("overall.group", gaps_indiv$experiment.type, invert = TRUE), ]</span></span>
<span id="cb132-3416"><a href="#cb132-3416" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$experiment.type[sub_gaps_indiv$experiment.type == "mixed-indiv.group"] &lt;- "artificial.group"</span></span>
<span id="cb132-3417"><a href="#cb132-3417" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$experiment.type[sub_gaps_indiv$experiment.type == "mixed-indiv.group"] &lt;- "artificial.group"</span></span>
<span id="cb132-3418"><a href="#cb132-3418" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$experiment.type[sub_gaps_indiv$experiment.type == "regular-indiv.group"] &lt;- "real.group"</span></span>
<span id="cb132-3419"><a href="#cb132-3419" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$type &lt;- sub_gaps_indiv$experiment.type</span></span>
<span id="cb132-3420"><a href="#cb132-3420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3421"><a href="#cb132-3421" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$type &lt;- factor(sub_gaps_indiv$type, levels = c("solo", "real.group", "artificial.group")) </span></span>
<span id="cb132-3422"><a href="#cb132-3422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3423"><a href="#cb132-3423" aria-hidden="true" tabindex="-1"></a><span class="in">sub_gaps_indiv$group.size.f &lt;- factor(sub_gaps_indiv$group.size, levels = unique(sub_gaps_indiv$group.size), ordered = TRUE)</span></span>
<span id="cb132-3424"><a href="#cb132-3424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3425"><a href="#cb132-3425" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-3426"><a href="#cb132-3426" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(sub_gaps_indiv,</span></span>
<span id="cb132-3427"><a href="#cb132-3427" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(</span></span>
<span id="cb132-3428"><a href="#cb132-3428" aria-hidden="true" tabindex="-1"></a><span class="in">         y = gaps,</span></span>
<span id="cb132-3429"><a href="#cb132-3429" aria-hidden="true" tabindex="-1"></a><span class="in">         x = type,</span></span>
<span id="cb132-3430"><a href="#cb132-3430" aria-hidden="true" tabindex="-1"></a><span class="in">         color = type,</span></span>
<span id="cb132-3431"><a href="#cb132-3431" aria-hidden="true" tabindex="-1"></a><span class="in">         fill = type</span></span>
<span id="cb132-3432"><a href="#cb132-3432" aria-hidden="true" tabindex="-1"></a><span class="in">       )) +</span></span>
<span id="cb132-3433"><a href="#cb132-3433" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-3434"><a href="#cb132-3434" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-3435"><a href="#cb132-3435" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-3436"><a href="#cb132-3436" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-3437"><a href="#cb132-3437" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-3438"><a href="#cb132-3438" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-3439"><a href="#cb132-3439" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-3440"><a href="#cb132-3440" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-3441"><a href="#cb132-3441" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-3442"><a href="#cb132-3442" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-3443"><a href="#cb132-3443" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-3444"><a href="#cb132-3444" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-3445"><a href="#cb132-3445" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-3446"><a href="#cb132-3446" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-3447"><a href="#cb132-3447" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-3448"><a href="#cb132-3448" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-3449"><a href="#cb132-3449" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-3450"><a href="#cb132-3450" aria-hidden="true" tabindex="-1"></a><span class="in">    # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-3451"><a href="#cb132-3451" aria-hidden="true" tabindex="-1"></a><span class="in">    gghalves::geom_half_point(</span></span>
<span id="cb132-3452"><a href="#cb132-3452" aria-hidden="true" tabindex="-1"></a><span class="in">      # color = fill_color,</span></span>
<span id="cb132-3453"><a href="#cb132-3453" aria-hidden="true" tabindex="-1"></a><span class="in">      # draw jitter on the left</span></span>
<span id="cb132-3454"><a href="#cb132-3454" aria-hidden="true" tabindex="-1"></a><span class="in">      side = "l",</span></span>
<span id="cb132-3455"><a href="#cb132-3455" aria-hidden="true" tabindex="-1"></a><span class="in">      # control range of jitter</span></span>
<span id="cb132-3456"><a href="#cb132-3456" aria-hidden="true" tabindex="-1"></a><span class="in">      range_scale = .4,</span></span>
<span id="cb132-3457"><a href="#cb132-3457" aria-hidden="true" tabindex="-1"></a><span class="in">      # add some transparency</span></span>
<span id="cb132-3458"><a href="#cb132-3458" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = .5,</span></span>
<span id="cb132-3459"><a href="#cb132-3459" aria-hidden="true" tabindex="-1"></a><span class="in">      transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-3460"><a href="#cb132-3460" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb132-3461"><a href="#cb132-3461" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-3462"><a href="#cb132-3462" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-3463"><a href="#cb132-3463" aria-hidden="true" tabindex="-1"></a><span class="in">                           end = 0.8,</span></span>
<span id="cb132-3464"><a href="#cb132-3464" aria-hidden="true" tabindex="-1"></a><span class="in">                           alpha = 0.6) +</span></span>
<span id="cb132-3465"><a href="#cb132-3465" aria-hidden="true" tabindex="-1"></a><span class="in">      ylim(c(-0.1, 40)) +</span></span>
<span id="cb132-3466"><a href="#cb132-3466" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "none") +</span></span>
<span id="cb132-3467"><a href="#cb132-3467" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Type", y = "Gap duration (s)") +</span></span>
<span id="cb132-3468"><a href="#cb132-3468" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c(</span></span>
<span id="cb132-3469"><a href="#cb132-3469" aria-hidden="true" tabindex="-1"></a><span class="in">        "solo" = "Solo",</span></span>
<span id="cb132-3470"><a href="#cb132-3470" aria-hidden="true" tabindex="-1"></a><span class="in">        "real.group" = "Natural group",</span></span>
<span id="cb132-3471"><a href="#cb132-3471" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial.group" = "Artificial group"</span></span>
<span id="cb132-3472"><a href="#cb132-3472" aria-hidden="true" tabindex="-1"></a><span class="in">      ))</span></span>
<span id="cb132-3473"><a href="#cb132-3473" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-3474"><a href="#cb132-3474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3475"><a href="#cb132-3475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3476"><a href="#cb132-3476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3477"><a href="#cb132-3477" aria-hidden="true" tabindex="-1"></a>By group size:</span>
<span id="cb132-3478"><a href="#cb132-3478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning = FALSE, message = FALSE}</span></span>
<span id="cb132-3479"><a href="#cb132-3479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3480"><a href="#cb132-3480" aria-hidden="true" tabindex="-1"></a><span class="in"># raincloud plot:</span></span>
<span id="cb132-3481"><a href="#cb132-3481" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(sub_gaps_indiv,</span></span>
<span id="cb132-3482"><a href="#cb132-3482" aria-hidden="true" tabindex="-1"></a><span class="in">       aes(</span></span>
<span id="cb132-3483"><a href="#cb132-3483" aria-hidden="true" tabindex="-1"></a><span class="in">         y = gaps,</span></span>
<span id="cb132-3484"><a href="#cb132-3484" aria-hidden="true" tabindex="-1"></a><span class="in">         x = type,</span></span>
<span id="cb132-3485"><a href="#cb132-3485" aria-hidden="true" tabindex="-1"></a><span class="in">         color = type,</span></span>
<span id="cb132-3486"><a href="#cb132-3486" aria-hidden="true" tabindex="-1"></a><span class="in">         fill = type</span></span>
<span id="cb132-3487"><a href="#cb132-3487" aria-hidden="true" tabindex="-1"></a><span class="in">       )) +</span></span>
<span id="cb132-3488"><a href="#cb132-3488" aria-hidden="true" tabindex="-1"></a><span class="in">  # add half-violin from {ggdist} package</span></span>
<span id="cb132-3489"><a href="#cb132-3489" aria-hidden="true" tabindex="-1"></a><span class="in">  ggdist::stat_halfeye(</span></span>
<span id="cb132-3490"><a href="#cb132-3490" aria-hidden="true" tabindex="-1"></a><span class="in">    # fill = fill_color,</span></span>
<span id="cb132-3491"><a href="#cb132-3491" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha = 0.5,</span></span>
<span id="cb132-3492"><a href="#cb132-3492" aria-hidden="true" tabindex="-1"></a><span class="in">    # custom bandwidth</span></span>
<span id="cb132-3493"><a href="#cb132-3493" aria-hidden="true" tabindex="-1"></a><span class="in">    adjust = .5,</span></span>
<span id="cb132-3494"><a href="#cb132-3494" aria-hidden="true" tabindex="-1"></a><span class="in">    # adjust height</span></span>
<span id="cb132-3495"><a href="#cb132-3495" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .6,</span></span>
<span id="cb132-3496"><a href="#cb132-3496" aria-hidden="true" tabindex="-1"></a><span class="in">    .width = 0,</span></span>
<span id="cb132-3497"><a href="#cb132-3497" aria-hidden="true" tabindex="-1"></a><span class="in">    # move geom to the cright</span></span>
<span id="cb132-3498"><a href="#cb132-3498" aria-hidden="true" tabindex="-1"></a><span class="in">    justification = -.2,</span></span>
<span id="cb132-3499"><a href="#cb132-3499" aria-hidden="true" tabindex="-1"></a><span class="in">    point_colour = NA</span></span>
<span id="cb132-3500"><a href="#cb132-3500" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb132-3501"><a href="#cb132-3501" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(# fill = fill_color,</span></span>
<span id="cb132-3502"><a href="#cb132-3502" aria-hidden="true" tabindex="-1"></a><span class="in">    width = .15,</span></span>
<span id="cb132-3503"><a href="#cb132-3503" aria-hidden="true" tabindex="-1"></a><span class="in">    # remove outliers</span></span>
<span id="cb132-3504"><a href="#cb132-3504" aria-hidden="true" tabindex="-1"></a><span class="in">    outlier.shape = NA) +</span></span>
<span id="cb132-3505"><a href="#cb132-3505" aria-hidden="true" tabindex="-1"></a><span class="in">    # add justified jitter from the {gghalves} package</span></span>
<span id="cb132-3506"><a href="#cb132-3506" aria-hidden="true" tabindex="-1"></a><span class="in">    gghalves::geom_half_point(</span></span>
<span id="cb132-3507"><a href="#cb132-3507" aria-hidden="true" tabindex="-1"></a><span class="in">      # color = fill_color,</span></span>
<span id="cb132-3508"><a href="#cb132-3508" aria-hidden="true" tabindex="-1"></a><span class="in">      # draw jitter on the left</span></span>
<span id="cb132-3509"><a href="#cb132-3509" aria-hidden="true" tabindex="-1"></a><span class="in">      side = "l",</span></span>
<span id="cb132-3510"><a href="#cb132-3510" aria-hidden="true" tabindex="-1"></a><span class="in">      # control range of jitter</span></span>
<span id="cb132-3511"><a href="#cb132-3511" aria-hidden="true" tabindex="-1"></a><span class="in">      range_scale = .4,</span></span>
<span id="cb132-3512"><a href="#cb132-3512" aria-hidden="true" tabindex="-1"></a><span class="in">      # add some transparency</span></span>
<span id="cb132-3513"><a href="#cb132-3513" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = .5,</span></span>
<span id="cb132-3514"><a href="#cb132-3514" aria-hidden="true" tabindex="-1"></a><span class="in">      transformation = ggplot2::position_jitter(height = 0)</span></span>
<span id="cb132-3515"><a href="#cb132-3515" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb132-3516"><a href="#cb132-3516" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_color_viridis_d(option = "G", end = 0.8) +</span></span>
<span id="cb132-3517"><a href="#cb132-3517" aria-hidden="true" tabindex="-1"></a><span class="in">      scale_fill_viridis_d(option = "G",</span></span>
<span id="cb132-3518"><a href="#cb132-3518" aria-hidden="true" tabindex="-1"></a><span class="in">                           end = 0.8,</span></span>
<span id="cb132-3519"><a href="#cb132-3519" aria-hidden="true" tabindex="-1"></a><span class="in">                           alpha = 0.6) +</span></span>
<span id="cb132-3520"><a href="#cb132-3520" aria-hidden="true" tabindex="-1"></a><span class="in">      ylim(c(-0.1, 40)) +</span></span>
<span id="cb132-3521"><a href="#cb132-3521" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(legend.position = "none") +</span></span>
<span id="cb132-3522"><a href="#cb132-3522" aria-hidden="true" tabindex="-1"></a><span class="in">      labs(x = "Type", y = "Gap duration (s)") +</span></span>
<span id="cb132-3523"><a href="#cb132-3523" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_discrete(labels = c(</span></span>
<span id="cb132-3524"><a href="#cb132-3524" aria-hidden="true" tabindex="-1"></a><span class="in">        "solo" = "Solo",</span></span>
<span id="cb132-3525"><a href="#cb132-3525" aria-hidden="true" tabindex="-1"></a><span class="in">        "real.group" = "Natural group",</span></span>
<span id="cb132-3526"><a href="#cb132-3526" aria-hidden="true" tabindex="-1"></a><span class="in">        "artificial.group" = "Artificial group"</span></span>
<span id="cb132-3527"><a href="#cb132-3527" aria-hidden="true" tabindex="-1"></a><span class="in">      ))  +  facet_wrap(</span></span>
<span id="cb132-3528"><a href="#cb132-3528" aria-hidden="true" tabindex="-1"></a><span class="in">        ~ group.size,</span></span>
<span id="cb132-3529"><a href="#cb132-3529" aria-hidden="true" tabindex="-1"></a><span class="in">        ncol = 2,</span></span>
<span id="cb132-3530"><a href="#cb132-3530" aria-hidden="true" tabindex="-1"></a><span class="in">        labeller = labeller(group.size = custom_labels)</span></span>
<span id="cb132-3531"><a href="#cb132-3531" aria-hidden="true" tabindex="-1"></a><span class="in">      ) </span></span>
<span id="cb132-3532"><a href="#cb132-3532" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb132-3533"><a href="#cb132-3533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3534"><a href="#cb132-3534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3535"><a href="#cb132-3535" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Regression model</span></span>
<span id="cb132-3536"><a href="#cb132-3536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3537"><a href="#cb132-3537" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-3538"><a href="#cb132-3538" aria-hidden="true" tabindex="-1"></a>\text{log(gaps + 1)} \sim \text{type} + \text{monotonic(group size)} + (1 \mid \text{group}) + (1 \mid \text{individual})</span>
<span id="cb132-3539"><a href="#cb132-3539" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-3540"><a href="#cb132-3540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3541"><a href="#cb132-3541" aria-hidden="true" tabindex="-1"></a>Response modeled with an exponential distribution.</span>
<span id="cb132-3542"><a href="#cb132-3542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3543"><a href="#cb132-3543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gaps per group solo vs group stats, eval = FALSE}</span></span>
<span id="cb132-3544"><a href="#cb132-3544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3545"><a href="#cb132-3545" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- brm(</span></span>
<span id="cb132-3546"><a href="#cb132-3546" aria-hidden="true" tabindex="-1"></a><span class="in">          formula = log(gaps + 1) ~ type + mo(group.size.f) + (1 | indiv) + (1 | group),</span></span>
<span id="cb132-3547"><a href="#cb132-3547" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-3548"><a href="#cb132-3548" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-3549"><a href="#cb132-3549" aria-hidden="true" tabindex="-1"></a><span class="in">          data = sub_gaps_indiv,</span></span>
<span id="cb132-3550"><a href="#cb132-3550" aria-hidden="true" tabindex="-1"></a><span class="in">          family = gaussian(),</span></span>
<span id="cb132-3551"><a href="#cb132-3551" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-3552"><a href="#cb132-3552" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-3553"><a href="#cb132-3553" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-3554"><a href="#cb132-3554" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99,</span></span>
<span id="cb132-3555"><a href="#cb132-3555" aria-hidden="true" tabindex="-1"></a><span class="in">                 max_treedepth = 15),</span></span>
<span id="cb132-3556"><a href="#cb132-3556" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always",</span></span>
<span id="cb132-3557"><a href="#cb132-3557" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/group_gaps_solo_vs_group_group_size_monot"</span></span>
<span id="cb132-3558"><a href="#cb132-3558" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb132-3559"><a href="#cb132-3559" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb132-3560"><a href="#cb132-3560" aria-hidden="true" tabindex="-1"></a><span class="in">custom_ppc(mod, group = "type")</span></span>
<span id="cb132-3561"><a href="#cb132-3561" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-3562"><a href="#cb132-3562" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- add_criterion(mod, criterion = "loo")  </span></span>
<span id="cb132-3563"><a href="#cb132-3563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3564"><a href="#cb132-3564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3565"><a href="#cb132-3565" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- brm(</span></span>
<span id="cb132-3566"><a href="#cb132-3566" aria-hidden="true" tabindex="-1"></a><span class="in">          formula =  log(gaps + 1) ~ 1 + (1 | indiv) + (1 | group),</span></span>
<span id="cb132-3567"><a href="#cb132-3567" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-3568"><a href="#cb132-3568" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-3569"><a href="#cb132-3569" aria-hidden="true" tabindex="-1"></a><span class="in">          data = sub_gaps_indiv,</span></span>
<span id="cb132-3570"><a href="#cb132-3570" aria-hidden="true" tabindex="-1"></a><span class="in">          family = gaussian(),</span></span>
<span id="cb132-3571"><a href="#cb132-3571" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-3572"><a href="#cb132-3572" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-3573"><a href="#cb132-3573" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-3574"><a href="#cb132-3574" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99,</span></span>
<span id="cb132-3575"><a href="#cb132-3575" aria-hidden="true" tabindex="-1"></a><span class="in">                 max_treedepth = 15),</span></span>
<span id="cb132-3576"><a href="#cb132-3576" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always",</span></span>
<span id="cb132-3577"><a href="#cb132-3577" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/null_group_gaps_solo_vs_group_group_size_monot"</span></span>
<span id="cb132-3578"><a href="#cb132-3578" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb132-3579"><a href="#cb132-3579" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb132-3580"><a href="#cb132-3580" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- add_criterion(null_mod, criterion = "loo")  </span></span>
<span id="cb132-3581"><a href="#cb132-3581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3582"><a href="#cb132-3582" aria-hidden="true" tabindex="-1"></a><span class="in">beepr::beep(2)</span></span>
<span id="cb132-3583"><a href="#cb132-3583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3584"><a href="#cb132-3584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3585"><a href="#cb132-3585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3586"><a href="#cb132-3586" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Results</span></span>
<span id="cb132-3587"><a href="#cb132-3587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3588"><a href="#cb132-3588" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model performance vs null model </span></span>
<span id="cb132-3589"><a href="#cb132-3589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r compare gap models, eval = TRUE}</span></span>
<span id="cb132-3590"><a href="#cb132-3590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3591"><a href="#cb132-3591" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- readRDS("./data/processed/group_gaps_solo_vs_group_group_size_monot.rds")</span></span>
<span id="cb132-3592"><a href="#cb132-3592" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- readRDS("./data/processed/null_group_gaps_solo_vs_group_group_size_monot.rds")</span></span>
<span id="cb132-3593"><a href="#cb132-3593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3594"><a href="#cb132-3594" aria-hidden="true" tabindex="-1"></a><span class="in">comp &lt;- loo_compare(mod, null_mod)</span></span>
<span id="cb132-3595"><a href="#cb132-3595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3596"><a href="#cb132-3596" aria-hidden="true" tabindex="-1"></a><span class="in">print(comp)</span></span>
<span id="cb132-3597"><a href="#cb132-3597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3598"><a href="#cb132-3598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3599"><a href="#cb132-3599" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model fit</span></span>
<span id="cb132-3600"><a href="#cb132-3600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gaps per group solo vs group results, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-3601"><a href="#cb132-3601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3602"><a href="#cb132-3602" aria-hidden="true" tabindex="-1"></a><span class="in">extended_summary(</span></span>
<span id="cb132-3603"><a href="#cb132-3603" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-3604"><a href="#cb132-3604" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.pattern = "type",</span></span>
<span id="cb132-3605"><a href="#cb132-3605" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.replacement = "solo_vs_",</span></span>
<span id="cb132-3606"><a href="#cb132-3606" aria-hidden="true" tabindex="-1"></a><span class="in">  remove.intercepts = TRUE,</span></span>
<span id="cb132-3607"><a href="#cb132-3607" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-3608"><a href="#cb132-3608" aria-hidden="true" tabindex="-1"></a><span class="in">  print.name = FALSE,</span></span>
<span id="cb132-3609"><a href="#cb132-3609" aria-hidden="true" tabindex="-1"></a><span class="in">  trace.palette = viridis::mako, </span></span>
<span id="cb132-3610"><a href="#cb132-3610" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = fill_color, </span></span>
<span id="cb132-3611"><a href="#cb132-3611" aria-hidden="true" tabindex="-1"></a><span class="in">  beta.prefix = "^b_|^bsp_"</span></span>
<span id="cb132-3612"><a href="#cb132-3612" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-3613"><a href="#cb132-3613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3614"><a href="#cb132-3614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3615"><a href="#cb132-3615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3616"><a href="#cb132-3616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3617"><a href="#cb132-3617" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Contrasts</span></span>
<span id="cb132-3618"><a href="#cb132-3618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gaps per group solo vs group results contrasts, eval = TRUE, results='asis'}</span></span>
<span id="cb132-3619"><a href="#cb132-3619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3620"><a href="#cb132-3620" aria-hidden="true" tabindex="-1"></a><span class="in"># contrasts</span></span>
<span id="cb132-3621"><a href="#cb132-3621" aria-hidden="true" tabindex="-1"></a><span class="in">contrasts(</span></span>
<span id="cb132-3622"><a href="#cb132-3622" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-3623"><a href="#cb132-3623" aria-hidden="true" tabindex="-1"></a><span class="in">  predictor = "type",</span></span>
<span id="cb132-3624"><a href="#cb132-3624" aria-hidden="true" tabindex="-1"></a><span class="in">  n.posterior = 2000,</span></span>
<span id="cb132-3625"><a href="#cb132-3625" aria-hidden="true" tabindex="-1"></a><span class="in">  level.sep = " VS ",</span></span>
<span id="cb132-3626"><a href="#cb132-3626" aria-hidden="true" tabindex="-1"></a><span class="in">  html.table = TRUE,</span></span>
<span id="cb132-3627"><a href="#cb132-3627" aria-hidden="true" tabindex="-1"></a><span class="in">  plot = TRUE,</span></span>
<span id="cb132-3628"><a href="#cb132-3628" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-3629"><a href="#cb132-3629" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = fill_color</span></span>
<span id="cb132-3630"><a href="#cb132-3630" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-3631"><a href="#cb132-3631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3632"><a href="#cb132-3632" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3633"><a href="#cb132-3633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3634"><a href="#cb132-3634" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Posterior predictive checks</span></span>
<span id="cb132-3637"><a href="#cb132-3637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-3638"><a href="#cb132-3638" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb132-3639"><a href="#cb132-3639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3640"><a href="#cb132-3640" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3641"><a href="#cb132-3641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3642"><a href="#cb132-3642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3643"><a href="#cb132-3643" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-3644"><a href="#cb132-3644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3645"><a href="#cb132-3645" aria-hidden="true" tabindex="-1"></a><span class="fu">### Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb132-3646"><a href="#cb132-3646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3647"><a href="#cb132-3647" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Individual gaps are longer in both natural and artificial groups than in solo flights</span>
<span id="cb132-3648"><a href="#cb132-3648" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No difference in gap duration between natural and artificial groups</span>
<span id="cb132-3649"><a href="#cb132-3649" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Group size does not affects gap duration</span>
<span id="cb132-3650"><a href="#cb132-3650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3651"><a href="#cb132-3651" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-3652"><a href="#cb132-3652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3653"><a href="#cb132-3653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3654"><a href="#cb132-3654" aria-hidden="true" tabindex="-1"></a><span class="fu">## Group calling sequence predictability</span></span>
<span id="cb132-3655"><a href="#cb132-3655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3656"><a href="#cb132-3656" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Measure as the entropy of transition probabilities of the individual ID in a first order markov chain model</span>
<span id="cb132-3657"><a href="#cb132-3657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3660"><a href="#cb132-3660" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-3661"><a href="#cb132-3661" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/processed/group_call_individual_id_sequence.csv"</span>)</span>
<span id="cb132-3662"><a href="#cb132-3662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3663"><a href="#cb132-3663" aria-hidden="true" tabindex="-1"></a>call_id_seq <span class="ot">&lt;-</span> call_id_seq[<span class="fu">order</span>(call_id_seq<span class="sc">$</span>event, call_id_seq<span class="sc">$</span>start), ]</span>
<span id="cb132-3664"><a href="#cb132-3664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3665"><a href="#cb132-3665" aria-hidden="true" tabindex="-1"></a>call_id_seq_list <span class="ot">&lt;-</span> <span class="fu">split</span>(call_id_seq, call_id_seq<span class="sc">$</span>event)</span>
<span id="cb132-3666"><a href="#cb132-3666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3667"><a href="#cb132-3667" aria-hidden="true" tabindex="-1"></a><span class="co"># get diversity and entropy</span></span>
<span id="cb132-3668"><a href="#cb132-3668" aria-hidden="true" tabindex="-1"></a>entropy_data_list <span class="ot">&lt;-</span> <span class="fu">pblapply</span>(call_id_seq_list, <span class="cf">function</span>(x){</span>
<span id="cb132-3669"><a href="#cb132-3669" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[<span class="fu">order</span>(x<span class="sc">$</span>start), ]</span>
<span id="cb132-3670"><a href="#cb132-3670" aria-hidden="true" tabindex="-1"></a>  id_seq <span class="ot">&lt;-</span> x<span class="sc">$</span>indiv</span>
<span id="cb132-3671"><a href="#cb132-3671" aria-hidden="true" tabindex="-1"></a>  id_seq <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(id_seq)))</span>
<span id="cb132-3672"><a href="#cb132-3672" aria-hidden="true" tabindex="-1"></a>  unique.callers <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(id_seq))</span>
<span id="cb132-3673"><a href="#cb132-3673" aria-hidden="true" tabindex="-1"></a>  id_seq <span class="ot">&lt;-</span> <span class="fu">paste</span>(id_seq, <span class="at">collapse =</span> <span class="st">""</span>)</span>
<span id="cb132-3674"><a href="#cb132-3674" aria-hidden="true" tabindex="-1"></a>  entrp <span class="ot">&lt;-</span> <span class="fu">entropy</span>(id_seq)</span>
<span id="cb132-3675"><a href="#cb132-3675" aria-hidden="true" tabindex="-1"></a>  norm.entrp <span class="ot">&lt;-</span> <span class="fu">normalized_entropy</span>(id_seq)</span>
<span id="cb132-3676"><a href="#cb132-3676" aria-hidden="true" tabindex="-1"></a>  markov.entropy <span class="ot">&lt;-</span> <span class="fu">markov_entropy</span>(id_seq, <span class="at">normalize =</span> <span class="cn">FALSE</span>)</span>
<span id="cb132-3677"><a href="#cb132-3677" aria-hidden="true" tabindex="-1"></a>  norm.markov.entropy <span class="ot">&lt;-</span> <span class="fu">markov_entropy</span>(id_seq, <span class="at">normalize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-3678"><a href="#cb132-3678" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-3679"><a href="#cb132-3679" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb132-3680"><a href="#cb132-3680" aria-hidden="true" tabindex="-1"></a>    <span class="at">event =</span> x<span class="sc">$</span>event[<span class="dv">1</span>],</span>
<span id="cb132-3681"><a href="#cb132-3681" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> x<span class="sc">$</span>group[<span class="dv">1</span>],</span>
<span id="cb132-3682"><a href="#cb132-3682" aria-hidden="true" tabindex="-1"></a>    <span class="at">group.size =</span> x<span class="sc">$</span>group.size[<span class="dv">1</span>],</span>
<span id="cb132-3683"><a href="#cb132-3683" aria-hidden="true" tabindex="-1"></a>    <span class="at">experiment =</span> x<span class="sc">$</span>experiment[<span class="dv">1</span>],</span>
<span id="cb132-3684"><a href="#cb132-3684" aria-hidden="true" tabindex="-1"></a>    <span class="at">sequence =</span> id_seq,</span>
<span id="cb132-3685"><a href="#cb132-3685" aria-hidden="true" tabindex="-1"></a>    <span class="at">entropy =</span> entrp,</span>
<span id="cb132-3686"><a href="#cb132-3686" aria-hidden="true" tabindex="-1"></a>    <span class="at">normalized.entropy =</span> norm.entrp,</span>
<span id="cb132-3687"><a href="#cb132-3687" aria-hidden="true" tabindex="-1"></a>    <span class="at">unique.callers =</span> unique.callers,</span>
<span id="cb132-3688"><a href="#cb132-3688" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop.callers =</span> unique.callers<span class="sc">/</span> x<span class="sc">$</span>group.size[<span class="dv">1</span>],</span>
<span id="cb132-3689"><a href="#cb132-3689" aria-hidden="true" tabindex="-1"></a>    <span class="at">markov.entropy =</span> markov.entropy,</span>
<span id="cb132-3690"><a href="#cb132-3690" aria-hidden="true" tabindex="-1"></a>    <span class="at">norm.markov.entropy =</span> norm.markov.entropy</span>
<span id="cb132-3691"><a href="#cb132-3691" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb132-3692"><a href="#cb132-3692" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb132-3693"><a href="#cb132-3693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb132-3694"><a href="#cb132-3694" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb132-3695"><a href="#cb132-3695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3696"><a href="#cb132-3696" aria-hidden="true" tabindex="-1"></a>seq_entropy_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, entropy_data_list)</span>
<span id="cb132-3697"><a href="#cb132-3697" aria-hidden="true" tabindex="-1"></a>seq_entropy_data<span class="sc">$</span>prop.callers[seq_entropy_data<span class="sc">$</span>prop.callers <span class="sc">&gt;=</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.99999</span></span>
<span id="cb132-3698"><a href="#cb132-3698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3699"><a href="#cb132-3699" aria-hidden="true" tabindex="-1"></a><span class="co"># remove those in which only 1 individual called</span></span>
<span id="cb132-3700"><a href="#cb132-3700" aria-hidden="true" tabindex="-1"></a>seq_entropy_data <span class="ot">&lt;-</span> seq_entropy_data[seq_entropy_data<span class="sc">$</span>unique.callers <span class="sc">&gt;</span> <span class="dv">1</span>, ]</span>
<span id="cb132-3701"><a href="#cb132-3701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3702"><a href="#cb132-3702" aria-hidden="true" tabindex="-1"></a><span class="co"># cor(seq_entropy_data[, c("entropy", "normalized.entropy", "unique.callers", "markov.entropy", "norm.markov.entropy")], use = "pairwise.complete.obs")</span></span>
<span id="cb132-3703"><a href="#cb132-3703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3704"><a href="#cb132-3704" aria-hidden="true" tabindex="-1"></a>seq_entropy_data<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(seq_entropy_data<span class="sc">$</span>experiment <span class="sc">==</span> <span class="st">"Regular"</span>, <span class="st">"Natural"</span>, <span class="st">"Artificial"</span>)</span>
<span id="cb132-3705"><a href="#cb132-3705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3706"><a href="#cb132-3706" aria-hidden="true" tabindex="-1"></a>seq_entropy_data<span class="sc">$</span>group.size.f <span class="ot">&lt;-</span> <span class="fu">factor</span>(seq_entropy_data<span class="sc">$</span>group.size, <span class="at">levels =</span> <span class="fu">unique</span>(seq_entropy_data<span class="sc">$</span>group.size), <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-3707"><a href="#cb132-3707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3708"><a href="#cb132-3708" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3709"><a href="#cb132-3709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3710"><a href="#cb132-3710" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot raw data</span></span>
<span id="cb132-3711"><a href="#cb132-3711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3712"><a href="#cb132-3712" aria-hidden="true" tabindex="-1"></a>All groups combined:</span>
<span id="cb132-3715"><a href="#cb132-3715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-3716"><a href="#cb132-3716" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb132-3717"><a href="#cb132-3717" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seq_entropy_data,</span>
<span id="cb132-3718"><a href="#cb132-3718" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb132-3719"><a href="#cb132-3719" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> norm.markov.entropy,</span>
<span id="cb132-3720"><a href="#cb132-3720" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb132-3721"><a href="#cb132-3721" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb132-3722"><a href="#cb132-3722" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb132-3723"><a href="#cb132-3723" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb132-3724"><a href="#cb132-3724" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb132-3725"><a href="#cb132-3725" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb132-3726"><a href="#cb132-3726" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb132-3727"><a href="#cb132-3727" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb132-3728"><a href="#cb132-3728" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb132-3729"><a href="#cb132-3729" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb132-3730"><a href="#cb132-3730" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb132-3731"><a href="#cb132-3731" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb132-3732"><a href="#cb132-3732" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb132-3733"><a href="#cb132-3733" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb132-3734"><a href="#cb132-3734" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb132-3735"><a href="#cb132-3735" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb132-3736"><a href="#cb132-3736" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb132-3737"><a href="#cb132-3737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb132-3738"><a href="#cb132-3738" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb132-3739"><a href="#cb132-3739" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb132-3740"><a href="#cb132-3740" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb132-3741"><a href="#cb132-3741" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb132-3742"><a href="#cb132-3742" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb132-3743"><a href="#cb132-3743" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb132-3744"><a href="#cb132-3744" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb132-3745"><a href="#cb132-3745" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb132-3746"><a href="#cb132-3746" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb132-3747"><a href="#cb132-3747" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb132-3748"><a href="#cb132-3748" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb132-3749"><a href="#cb132-3749" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb132-3750"><a href="#cb132-3750" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb132-3751"><a href="#cb132-3751" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb132-3752"><a href="#cb132-3752" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb132-3753"><a href="#cb132-3753" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb132-3754"><a href="#cb132-3754" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb132-3755"><a href="#cb132-3755" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb132-3756"><a href="#cb132-3756" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb132-3757"><a href="#cb132-3757" aria-hidden="true" tabindex="-1"></a>      <span class="co">#      scale_x_discrete(labels = c(</span></span>
<span id="cb132-3758"><a href="#cb132-3758" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "natural" = "Natural",</span></span>
<span id="cb132-3759"><a href="#cb132-3759" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "artificial" = "Artificial",</span></span>
<span id="cb132-3760"><a href="#cb132-3760" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "simulated" = "Simulated"</span></span>
<span id="cb132-3761"><a href="#cb132-3761" aria-hidden="true" tabindex="-1"></a>      <span class="co"># )) +</span></span>
<span id="cb132-3762"><a href="#cb132-3762" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb132-3763"><a href="#cb132-3763" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Normalized markov</span><span class="sc">\n</span><span class="st">transitions entropy"</span>)</span>
<span id="cb132-3764"><a href="#cb132-3764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3765"><a href="#cb132-3765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3766"><a href="#cb132-3766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3767"><a href="#cb132-3767" aria-hidden="true" tabindex="-1"></a>By group size:</span>
<span id="cb132-3770"><a href="#cb132-3770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-3771"><a href="#cb132-3771" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb132-3772"><a href="#cb132-3772" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seq_entropy_data[seq_entropy_data<span class="sc">$</span>group.size <span class="sc">&lt;</span> <span class="dv">6</span>, ],</span>
<span id="cb132-3773"><a href="#cb132-3773" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb132-3774"><a href="#cb132-3774" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> norm.markov.entropy,</span>
<span id="cb132-3775"><a href="#cb132-3775" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb132-3776"><a href="#cb132-3776" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb132-3777"><a href="#cb132-3777" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb132-3778"><a href="#cb132-3778" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb132-3779"><a href="#cb132-3779" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb132-3780"><a href="#cb132-3780" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb132-3781"><a href="#cb132-3781" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb132-3782"><a href="#cb132-3782" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb132-3783"><a href="#cb132-3783" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb132-3784"><a href="#cb132-3784" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb132-3785"><a href="#cb132-3785" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb132-3786"><a href="#cb132-3786" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb132-3787"><a href="#cb132-3787" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb132-3788"><a href="#cb132-3788" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb132-3789"><a href="#cb132-3789" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb132-3790"><a href="#cb132-3790" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb132-3791"><a href="#cb132-3791" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb132-3792"><a href="#cb132-3792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb132-3793"><a href="#cb132-3793" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb132-3794"><a href="#cb132-3794" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb132-3795"><a href="#cb132-3795" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb132-3796"><a href="#cb132-3796" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb132-3797"><a href="#cb132-3797" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb132-3798"><a href="#cb132-3798" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb132-3799"><a href="#cb132-3799" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb132-3800"><a href="#cb132-3800" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb132-3801"><a href="#cb132-3801" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb132-3802"><a href="#cb132-3802" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb132-3803"><a href="#cb132-3803" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb132-3804"><a href="#cb132-3804" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb132-3805"><a href="#cb132-3805" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb132-3806"><a href="#cb132-3806" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb132-3807"><a href="#cb132-3807" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb132-3808"><a href="#cb132-3808" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb132-3809"><a href="#cb132-3809" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb132-3810"><a href="#cb132-3810" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb132-3811"><a href="#cb132-3811" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb132-3812"><a href="#cb132-3812" aria-hidden="true" tabindex="-1"></a>      <span class="co">#      scale_x_discrete(labels = c(</span></span>
<span id="cb132-3813"><a href="#cb132-3813" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "natural" = "Natural",</span></span>
<span id="cb132-3814"><a href="#cb132-3814" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "artificial" = "Artificial",</span></span>
<span id="cb132-3815"><a href="#cb132-3815" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "simulated" = "Simulated"</span></span>
<span id="cb132-3816"><a href="#cb132-3816" aria-hidden="true" tabindex="-1"></a>      <span class="co"># )) +</span></span>
<span id="cb132-3817"><a href="#cb132-3817" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb132-3818"><a href="#cb132-3818" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(</span>
<span id="cb132-3819"><a href="#cb132-3819" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> group.size,</span>
<span id="cb132-3820"><a href="#cb132-3820" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb132-3821"><a href="#cb132-3821" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb132-3822"><a href="#cb132-3822" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Normalized markov</span><span class="sc">\n</span><span class="st">transitions entropy"</span>)</span>
<span id="cb132-3823"><a href="#cb132-3823" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3824"><a href="#cb132-3824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3825"><a href="#cb132-3825" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression model</span></span>
<span id="cb132-3826"><a href="#cb132-3826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3827"><a href="#cb132-3827" aria-hidden="true" tabindex="-1"></a>Model:</span>
<span id="cb132-3828"><a href="#cb132-3828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3829"><a href="#cb132-3829" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-3830"><a href="#cb132-3830" aria-hidden="true" tabindex="-1"></a>\text{normalize markov transition entropy} \sim \text{type}</span>
<span id="cb132-3831"><a href="#cb132-3831" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb132-3832"><a href="#cb132-3832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3833"><a href="#cb132-3833" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb132-3834"><a href="#cb132-3834" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- brm(</span></span>
<span id="cb132-3835"><a href="#cb132-3835" aria-hidden="true" tabindex="-1"></a><span class="in">          formula = norm.markov.entropy ~ type,</span></span>
<span id="cb132-3836"><a href="#cb132-3836" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-3837"><a href="#cb132-3837" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-3838"><a href="#cb132-3838" aria-hidden="true" tabindex="-1"></a><span class="in">          data = seq_entropy_data,</span></span>
<span id="cb132-3839"><a href="#cb132-3839" aria-hidden="true" tabindex="-1"></a><span class="in">          family = zero_one_inflated_beta(),</span></span>
<span id="cb132-3840"><a href="#cb132-3840" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-3841"><a href="#cb132-3841" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-3842"><a href="#cb132-3842" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-3843"><a href="#cb132-3843" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99,</span></span>
<span id="cb132-3844"><a href="#cb132-3844" aria-hidden="true" tabindex="-1"></a><span class="in">                 max_treedepth = 15),</span></span>
<span id="cb132-3845"><a href="#cb132-3845" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always",</span></span>
<span id="cb132-3846"><a href="#cb132-3846" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/entropy_by_experiment_type_group_size_monot"</span></span>
<span id="cb132-3847"><a href="#cb132-3847" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb132-3848"><a href="#cb132-3848" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb132-3849"><a href="#cb132-3849" aria-hidden="true" tabindex="-1"></a><span class="in">custom_ppc(mod, group = "type")</span></span>
<span id="cb132-3850"><a href="#cb132-3850" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-3851"><a href="#cb132-3851" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- add_criterion(mod, criterion = "loo")  </span></span>
<span id="cb132-3852"><a href="#cb132-3852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3853"><a href="#cb132-3853" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- brm(</span></span>
<span id="cb132-3854"><a href="#cb132-3854" aria-hidden="true" tabindex="-1"></a><span class="in">          formula = norm.markov.entropy ~ 1,</span></span>
<span id="cb132-3855"><a href="#cb132-3855" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-3856"><a href="#cb132-3856" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-3857"><a href="#cb132-3857" aria-hidden="true" tabindex="-1"></a><span class="in">          data = seq_entropy_data,</span></span>
<span id="cb132-3858"><a href="#cb132-3858" aria-hidden="true" tabindex="-1"></a><span class="in">          family = zero_one_inflated_beta(),</span></span>
<span id="cb132-3859"><a href="#cb132-3859" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-3860"><a href="#cb132-3860" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-3861"><a href="#cb132-3861" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-3862"><a href="#cb132-3862" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99,</span></span>
<span id="cb132-3863"><a href="#cb132-3863" aria-hidden="true" tabindex="-1"></a><span class="in">                 max_treedepth = 15),</span></span>
<span id="cb132-3864"><a href="#cb132-3864" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always",</span></span>
<span id="cb132-3865"><a href="#cb132-3865" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/null_model_entropy_by_experiment_type_group_size_monot"</span></span>
<span id="cb132-3866"><a href="#cb132-3866" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb132-3867"><a href="#cb132-3867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3868"><a href="#cb132-3868" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- add_criterion(null_mod, criterion = "loo")  </span></span>
<span id="cb132-3869"><a href="#cb132-3869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3870"><a href="#cb132-3870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3871"><a href="#cb132-3871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3872"><a href="#cb132-3872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3873"><a href="#cb132-3873" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results</span></span>
<span id="cb132-3874"><a href="#cb132-3874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3875"><a href="#cb132-3875" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model performance vs null model </span></span>
<span id="cb132-3876"><a href="#cb132-3876" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb132-3877"><a href="#cb132-3877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3878"><a href="#cb132-3878" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- readRDS("./data/processed/entropy_by_experiment_type_group_size_monot.rds")</span></span>
<span id="cb132-3879"><a href="#cb132-3879" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- readRDS("./data/processed/null_model_entropy_by_experiment_type_group_size_monot.rds")</span></span>
<span id="cb132-3880"><a href="#cb132-3880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3881"><a href="#cb132-3881" aria-hidden="true" tabindex="-1"></a><span class="in">comp &lt;- loo_compare(mod, null_mod)</span></span>
<span id="cb132-3882"><a href="#cb132-3882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3883"><a href="#cb132-3883" aria-hidden="true" tabindex="-1"></a><span class="in">print(comp)</span></span>
<span id="cb132-3884"><a href="#cb132-3884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3885"><a href="#cb132-3885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3886"><a href="#cb132-3886" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model fit</span></span>
<span id="cb132-3887"><a href="#cb132-3887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-3888"><a href="#cb132-3888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3889"><a href="#cb132-3889" aria-hidden="true" tabindex="-1"></a><span class="in">extended_summary(</span></span>
<span id="cb132-3890"><a href="#cb132-3890" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-3891"><a href="#cb132-3891" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.pattern = "b_type",</span></span>
<span id="cb132-3892"><a href="#cb132-3892" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.replacement = "Aritificial_vs_",</span></span>
<span id="cb132-3893"><a href="#cb132-3893" aria-hidden="true" tabindex="-1"></a><span class="in">  remove.intercepts = TRUE,</span></span>
<span id="cb132-3894"><a href="#cb132-3894" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-3895"><a href="#cb132-3895" aria-hidden="true" tabindex="-1"></a><span class="in">  print.name = FALSE,</span></span>
<span id="cb132-3896"><a href="#cb132-3896" aria-hidden="true" tabindex="-1"></a><span class="in">  trace.palette = viridis::mako, </span></span>
<span id="cb132-3897"><a href="#cb132-3897" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = fill_color, </span></span>
<span id="cb132-3898"><a href="#cb132-3898" aria-hidden="true" tabindex="-1"></a><span class="in">  beta.prefix = "^b_|^bsp_"</span></span>
<span id="cb132-3899"><a href="#cb132-3899" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-3900"><a href="#cb132-3900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3901"><a href="#cb132-3901" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3902"><a href="#cb132-3902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3903"><a href="#cb132-3903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3904"><a href="#cb132-3904" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Posterior predictive checks</span></span>
<span id="cb132-3907"><a href="#cb132-3907" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-3908"><a href="#cb132-3908" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb132-3909"><a href="#cb132-3909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3910"><a href="#cb132-3910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3911"><a href="#cb132-3911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3912"><a href="#cb132-3912" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-3913"><a href="#cb132-3913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3914"><a href="#cb132-3914" aria-hidden="true" tabindex="-1"></a><span class="fu">### Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb132-3915"><a href="#cb132-3915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3916"><a href="#cb132-3916" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No difference in predictability between natural and artificial groups</span>
<span id="cb132-3917"><a href="#cb132-3917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3918"><a href="#cb132-3918" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-3919"><a href="#cb132-3919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3920"><a href="#cb132-3920" aria-hidden="true" tabindex="-1"></a><span class="fu">## Number of calling individuals per experiment</span></span>
<span id="cb132-3921"><a href="#cb132-3921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3922"><a href="#cb132-3922" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot raw data</span></span>
<span id="cb132-3923"><a href="#cb132-3923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3924"><a href="#cb132-3924" aria-hidden="true" tabindex="-1"></a>All groups combined:</span>
<span id="cb132-3927"><a href="#cb132-3927" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-3928"><a href="#cb132-3928" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb132-3929"><a href="#cb132-3929" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seq_entropy_data,</span>
<span id="cb132-3930"><a href="#cb132-3930" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb132-3931"><a href="#cb132-3931" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> prop.callers,</span>
<span id="cb132-3932"><a href="#cb132-3932" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb132-3933"><a href="#cb132-3933" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb132-3934"><a href="#cb132-3934" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb132-3935"><a href="#cb132-3935" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb132-3936"><a href="#cb132-3936" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb132-3937"><a href="#cb132-3937" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb132-3938"><a href="#cb132-3938" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb132-3939"><a href="#cb132-3939" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb132-3940"><a href="#cb132-3940" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb132-3941"><a href="#cb132-3941" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb132-3942"><a href="#cb132-3942" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb132-3943"><a href="#cb132-3943" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb132-3944"><a href="#cb132-3944" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb132-3945"><a href="#cb132-3945" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb132-3946"><a href="#cb132-3946" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb132-3947"><a href="#cb132-3947" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb132-3948"><a href="#cb132-3948" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb132-3949"><a href="#cb132-3949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb132-3950"><a href="#cb132-3950" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb132-3951"><a href="#cb132-3951" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb132-3952"><a href="#cb132-3952" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb132-3953"><a href="#cb132-3953" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb132-3954"><a href="#cb132-3954" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb132-3955"><a href="#cb132-3955" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb132-3956"><a href="#cb132-3956" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb132-3957"><a href="#cb132-3957" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb132-3958"><a href="#cb132-3958" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb132-3959"><a href="#cb132-3959" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb132-3960"><a href="#cb132-3960" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb132-3961"><a href="#cb132-3961" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb132-3962"><a href="#cb132-3962" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb132-3963"><a href="#cb132-3963" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb132-3964"><a href="#cb132-3964" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb132-3965"><a href="#cb132-3965" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb132-3966"><a href="#cb132-3966" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb132-3967"><a href="#cb132-3967" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb132-3968"><a href="#cb132-3968" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb132-3969"><a href="#cb132-3969" aria-hidden="true" tabindex="-1"></a>      <span class="co">#      scale_x_discrete(labels = c(</span></span>
<span id="cb132-3970"><a href="#cb132-3970" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "natural" = "Natural",</span></span>
<span id="cb132-3971"><a href="#cb132-3971" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "artificial" = "Artificial",</span></span>
<span id="cb132-3972"><a href="#cb132-3972" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "simulated" = "Simulated"</span></span>
<span id="cb132-3973"><a href="#cb132-3973" aria-hidden="true" tabindex="-1"></a>      <span class="co"># )) +</span></span>
<span id="cb132-3974"><a href="#cb132-3974" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb132-3975"><a href="#cb132-3975" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Proportion of unique callers"</span>)</span>
<span id="cb132-3976"><a href="#cb132-3976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3977"><a href="#cb132-3977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-3978"><a href="#cb132-3978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3979"><a href="#cb132-3979" aria-hidden="true" tabindex="-1"></a>By group size:</span>
<span id="cb132-3982"><a href="#cb132-3982" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-3983"><a href="#cb132-3983" aria-hidden="true" tabindex="-1"></a><span class="co"># raincloud plot:</span></span>
<span id="cb132-3984"><a href="#cb132-3984" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(seq_entropy_data[seq_entropy_data<span class="sc">$</span>group.size <span class="sc">&lt;</span> <span class="dv">6</span>, ],</span>
<span id="cb132-3985"><a href="#cb132-3985" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(</span>
<span id="cb132-3986"><a href="#cb132-3986" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> prop.callers,</span>
<span id="cb132-3987"><a href="#cb132-3987" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> type,</span>
<span id="cb132-3988"><a href="#cb132-3988" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> type,</span>
<span id="cb132-3989"><a href="#cb132-3989" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> type</span>
<span id="cb132-3990"><a href="#cb132-3990" aria-hidden="true" tabindex="-1"></a>       )) <span class="sc">+</span></span>
<span id="cb132-3991"><a href="#cb132-3991" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add half-violin from {ggdist} package</span></span>
<span id="cb132-3992"><a href="#cb132-3992" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb132-3993"><a href="#cb132-3993" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fill = fill_color,</span></span>
<span id="cb132-3994"><a href="#cb132-3994" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb132-3995"><a href="#cb132-3995" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom bandwidth</span></span>
<span id="cb132-3996"><a href="#cb132-3996" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">5</span>,</span>
<span id="cb132-3997"><a href="#cb132-3997" aria-hidden="true" tabindex="-1"></a>    <span class="co"># adjust height</span></span>
<span id="cb132-3998"><a href="#cb132-3998" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>,</span>
<span id="cb132-3999"><a href="#cb132-3999" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb132-4000"><a href="#cb132-4000" aria-hidden="true" tabindex="-1"></a>    <span class="co"># move geom to the cright</span></span>
<span id="cb132-4001"><a href="#cb132-4001" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">2</span>,</span>
<span id="cb132-4002"><a href="#cb132-4002" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb132-4003"><a href="#cb132-4003" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb132-4004"><a href="#cb132-4004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="co"># fill = fill_color,</span></span>
<span id="cb132-4005"><a href="#cb132-4005" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb132-4006"><a href="#cb132-4006" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove outliers</span></span>
<span id="cb132-4007"><a href="#cb132-4007" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb132-4008"><a href="#cb132-4008" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add justified jitter from the {gghalves} package</span></span>
<span id="cb132-4009"><a href="#cb132-4009" aria-hidden="true" tabindex="-1"></a>    gghalves<span class="sc">::</span><span class="fu">geom_half_point</span>(</span>
<span id="cb132-4010"><a href="#cb132-4010" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color = fill_color,</span></span>
<span id="cb132-4011"><a href="#cb132-4011" aria-hidden="true" tabindex="-1"></a>      <span class="co"># draw jitter on the left</span></span>
<span id="cb132-4012"><a href="#cb132-4012" aria-hidden="true" tabindex="-1"></a>      <span class="at">side =</span> <span class="st">"l"</span>,</span>
<span id="cb132-4013"><a href="#cb132-4013" aria-hidden="true" tabindex="-1"></a>      <span class="co"># control range of jitter</span></span>
<span id="cb132-4014"><a href="#cb132-4014" aria-hidden="true" tabindex="-1"></a>      <span class="at">range_scale =</span> .<span class="dv">4</span>,</span>
<span id="cb132-4015"><a href="#cb132-4015" aria-hidden="true" tabindex="-1"></a>      <span class="co"># add some transparency</span></span>
<span id="cb132-4016"><a href="#cb132-4016" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb132-4017"><a href="#cb132-4017" aria-hidden="true" tabindex="-1"></a>      <span class="at">transformation =</span> ggplot2<span class="sc">::</span><span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>)</span>
<span id="cb132-4018"><a href="#cb132-4018" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb132-4019"><a href="#cb132-4019" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb132-4020"><a href="#cb132-4020" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">"G"</span>,</span>
<span id="cb132-4021"><a href="#cb132-4021" aria-hidden="true" tabindex="-1"></a>                           <span class="at">end =</span> <span class="fl">0.8</span>,</span>
<span id="cb132-4022"><a href="#cb132-4022" aria-hidden="true" tabindex="-1"></a>                           <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb132-4023"><a href="#cb132-4023" aria-hidden="true" tabindex="-1"></a>      <span class="co"># ylim(c(-0.1, 4.8)) +</span></span>
<span id="cb132-4024"><a href="#cb132-4024" aria-hidden="true" tabindex="-1"></a>      <span class="co">#      scale_x_discrete(labels = c(</span></span>
<span id="cb132-4025"><a href="#cb132-4025" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "natural" = "Natural",</span></span>
<span id="cb132-4026"><a href="#cb132-4026" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "artificial" = "Artificial",</span></span>
<span id="cb132-4027"><a href="#cb132-4027" aria-hidden="true" tabindex="-1"></a>      <span class="co">#   "simulated" = "Simulated"</span></span>
<span id="cb132-4028"><a href="#cb132-4028" aria-hidden="true" tabindex="-1"></a>      <span class="co"># )) +</span></span>
<span id="cb132-4029"><a href="#cb132-4029" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb132-4030"><a href="#cb132-4030" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(</span>
<span id="cb132-4031"><a href="#cb132-4031" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> group.size,</span>
<span id="cb132-4032"><a href="#cb132-4032" aria-hidden="true" tabindex="-1"></a>        <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb132-4033"><a href="#cb132-4033" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb132-4034"><a href="#cb132-4034" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Flight type"</span>, <span class="at">y =</span> <span class="st">"Proporiton of unique callers"</span>)</span>
<span id="cb132-4035"><a href="#cb132-4035" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-4036"><a href="#cb132-4036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4037"><a href="#cb132-4037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4038"><a href="#cb132-4038" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression model</span></span>
<span id="cb132-4039"><a href="#cb132-4039" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb132-4040"><a href="#cb132-4040" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- brm(</span></span>
<span id="cb132-4041"><a href="#cb132-4041" aria-hidden="true" tabindex="-1"></a><span class="in">          formula = prop.callers ~ type + (1 | group.size.f),</span></span>
<span id="cb132-4042"><a href="#cb132-4042" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-4043"><a href="#cb132-4043" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-4044"><a href="#cb132-4044" aria-hidden="true" tabindex="-1"></a><span class="in">          data = seq_entropy_data,</span></span>
<span id="cb132-4045"><a href="#cb132-4045" aria-hidden="true" tabindex="-1"></a><span class="in">          family = zero_one_inflated_beta(),</span></span>
<span id="cb132-4046"><a href="#cb132-4046" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-4047"><a href="#cb132-4047" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-4048"><a href="#cb132-4048" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-4049"><a href="#cb132-4049" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99,</span></span>
<span id="cb132-4050"><a href="#cb132-4050" aria-hidden="true" tabindex="-1"></a><span class="in">                 max_treedepth = 15),</span></span>
<span id="cb132-4051"><a href="#cb132-4051" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always",</span></span>
<span id="cb132-4052"><a href="#cb132-4052" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/unique.callers_by_experiment_type_group_size_monot"</span></span>
<span id="cb132-4053"><a href="#cb132-4053" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb132-4054"><a href="#cb132-4054" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb132-4055"><a href="#cb132-4055" aria-hidden="true" tabindex="-1"></a><span class="in">custom_ppc(mod, group = "type")</span></span>
<span id="cb132-4056"><a href="#cb132-4056" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb132-4057"><a href="#cb132-4057" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- add_criterion(mod, criterion = "loo")  </span></span>
<span id="cb132-4058"><a href="#cb132-4058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4059"><a href="#cb132-4059" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- brm(</span></span>
<span id="cb132-4060"><a href="#cb132-4060" aria-hidden="true" tabindex="-1"></a><span class="in">          formula = prop.callers ~ 1 + (1 | group.size.f),</span></span>
<span id="cb132-4061"><a href="#cb132-4061" aria-hidden="true" tabindex="-1"></a><span class="in">          iter = iter,</span></span>
<span id="cb132-4062"><a href="#cb132-4062" aria-hidden="true" tabindex="-1"></a><span class="in">          thin = 1,</span></span>
<span id="cb132-4063"><a href="#cb132-4063" aria-hidden="true" tabindex="-1"></a><span class="in">          data = seq_entropy_data,</span></span>
<span id="cb132-4064"><a href="#cb132-4064" aria-hidden="true" tabindex="-1"></a><span class="in">          family = zero_one_inflated_beta(),</span></span>
<span id="cb132-4065"><a href="#cb132-4065" aria-hidden="true" tabindex="-1"></a><span class="in">          silent = 2,</span></span>
<span id="cb132-4066"><a href="#cb132-4066" aria-hidden="true" tabindex="-1"></a><span class="in">          chains = chains,</span></span>
<span id="cb132-4067"><a href="#cb132-4067" aria-hidden="true" tabindex="-1"></a><span class="in">          cores = chains, </span></span>
<span id="cb132-4068"><a href="#cb132-4068" aria-hidden="true" tabindex="-1"></a><span class="in">          control = list(adapt_delta = 0.99,</span></span>
<span id="cb132-4069"><a href="#cb132-4069" aria-hidden="true" tabindex="-1"></a><span class="in">                 max_treedepth = 15),</span></span>
<span id="cb132-4070"><a href="#cb132-4070" aria-hidden="true" tabindex="-1"></a><span class="in">          file_refit = "always",</span></span>
<span id="cb132-4071"><a href="#cb132-4071" aria-hidden="true" tabindex="-1"></a><span class="in">          file = "./data/processed/null_model_unique.callers_by_experiment_type_group_size_monot"</span></span>
<span id="cb132-4072"><a href="#cb132-4072" aria-hidden="true" tabindex="-1"></a><span class="in"> )</span></span>
<span id="cb132-4073"><a href="#cb132-4073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4074"><a href="#cb132-4074" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- add_criterion(null_mod, criterion = "loo")  </span></span>
<span id="cb132-4075"><a href="#cb132-4075" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-4076"><a href="#cb132-4076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4077"><a href="#cb132-4077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4078"><a href="#cb132-4078" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Results</span></span>
<span id="cb132-4079"><a href="#cb132-4079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4080"><a href="#cb132-4080" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model performance vs null model </span></span>
<span id="cb132-4081"><a href="#cb132-4081" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE}</span></span>
<span id="cb132-4082"><a href="#cb132-4082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4083"><a href="#cb132-4083" aria-hidden="true" tabindex="-1"></a><span class="in">mod &lt;- readRDS("./data/processed/unique.callers_by_experiment_type_group_size_monot.rds")</span></span>
<span id="cb132-4084"><a href="#cb132-4084" aria-hidden="true" tabindex="-1"></a><span class="in">null_mod &lt;- readRDS("./data/processed/null_model_unique.callers_by_experiment_type_group_size_monot.rds")</span></span>
<span id="cb132-4085"><a href="#cb132-4085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4086"><a href="#cb132-4086" aria-hidden="true" tabindex="-1"></a><span class="in">comp &lt;- loo_compare(mod, null_mod)</span></span>
<span id="cb132-4087"><a href="#cb132-4087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4088"><a href="#cb132-4088" aria-hidden="true" tabindex="-1"></a><span class="in">print(comp)</span></span>
<span id="cb132-4089"><a href="#cb132-4089" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-4090"><a href="#cb132-4090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4091"><a href="#cb132-4091" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Model fit</span></span>
<span id="cb132-4092"><a href="#cb132-4092" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, results = "asis"}</span></span>
<span id="cb132-4093"><a href="#cb132-4093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4094"><a href="#cb132-4094" aria-hidden="true" tabindex="-1"></a><span class="in">extended_summary(</span></span>
<span id="cb132-4095"><a href="#cb132-4095" aria-hidden="true" tabindex="-1"></a><span class="in">  fit = mod,</span></span>
<span id="cb132-4096"><a href="#cb132-4096" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.pattern = "b_type",</span></span>
<span id="cb132-4097"><a href="#cb132-4097" aria-hidden="true" tabindex="-1"></a><span class="in">  gsub.replacement = "Aritificial_vs_",</span></span>
<span id="cb132-4098"><a href="#cb132-4098" aria-hidden="true" tabindex="-1"></a><span class="in">  remove.intercepts = TRUE,</span></span>
<span id="cb132-4099"><a href="#cb132-4099" aria-hidden="true" tabindex="-1"></a><span class="in">  highlight = TRUE,</span></span>
<span id="cb132-4100"><a href="#cb132-4100" aria-hidden="true" tabindex="-1"></a><span class="in">  print.name = FALSE,</span></span>
<span id="cb132-4101"><a href="#cb132-4101" aria-hidden="true" tabindex="-1"></a><span class="in">  trace.palette = viridis::mako, </span></span>
<span id="cb132-4102"><a href="#cb132-4102" aria-hidden="true" tabindex="-1"></a><span class="in">  fill = fill_color, </span></span>
<span id="cb132-4103"><a href="#cb132-4103" aria-hidden="true" tabindex="-1"></a><span class="in">  beta.prefix = "^b_|^bsp_"</span></span>
<span id="cb132-4104"><a href="#cb132-4104" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb132-4105"><a href="#cb132-4105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4106"><a href="#cb132-4106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-4107"><a href="#cb132-4107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4108"><a href="#cb132-4108" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Posterior predictive checks</span></span>
<span id="cb132-4111"><a href="#cb132-4111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb132-4112"><a href="#cb132-4112" aria-hidden="true" tabindex="-1"></a><span class="fu">custom_ppc</span>(<span class="at">fit =</span> mod, <span class="at">group =</span> <span class="st">"type"</span>)</span>
<span id="cb132-4113"><a href="#cb132-4113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4114"><a href="#cb132-4114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb132-4115"><a href="#cb132-4115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4116"><a href="#cb132-4116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4117"><a href="#cb132-4117" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb132-4118"><a href="#cb132-4118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4119"><a href="#cb132-4119" aria-hidden="true" tabindex="-1"></a><span class="fu">### Takeaways {.unnumbered .unlisted}</span></span>
<span id="cb132-4120"><a href="#cb132-4120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4121"><a href="#cb132-4121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Similar proportion of calling individuals in natural and artificial groups</span>
<span id="cb132-4122"><a href="#cb132-4122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4123"><a href="#cb132-4123" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb132-4124"><a href="#cb132-4124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4125"><a href="#cb132-4125" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb132-4126"><a href="#cb132-4126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4127"><a href="#cb132-4127" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session information {.unnumbered .unlisted}</span></span>
<span id="cb132-4128"><a href="#cb132-4128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4129"><a href="#cb132-4129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session info, echo=F}</span></span>
<span id="cb132-4130"><a href="#cb132-4130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4131"><a href="#cb132-4131" aria-hidden="true" tabindex="-1"></a><span class="in">sessionInfo()</span></span>
<span id="cb132-4132"><a href="#cb132-4132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4133"><a href="#cb132-4133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>